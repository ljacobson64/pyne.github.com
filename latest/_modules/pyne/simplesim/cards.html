


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyne.simplesim.cards &mdash; PyNE 0.4-dev</title>
    
    <link rel="stylesheet" href="../../../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/breathe.css" type="text/css" />
    <link rel="stylesheet" href="../../../" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.4-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/bibtex_js.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../../_static/toggle_sections.js"></script>
    <script type="text/javascript" src="../../../_static/toggle_sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/pyne_icon.ico"/>
    <link rel="top" title="PyNE 0.4-dev" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> <script type="text/javascript">
var ga_enabled = !$.cookie('disable-ga');
if(ga_enabled){
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37452818-1']);
  _gaq.push(['_setCookiePath', '/']);
  _gaq.push(['_setDetectFlash', false]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
}
</script>
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../../gallery/index.html">Gallery</a> | </li>
    <li><a href="../../../index.html">PyNE</a> &raquo;</li>

          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyne.simplesim.cards</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;The :py:mod:`cards` module can be imported as such::</span>

<span class="sd">    from .simplesim import cards</span>

<span class="sd">The user creates cards, typically only working with the constructors, and then</span>
<span class="sd">adds the cards to a :py:class:`pyne.simplesim.definition.IDefinition`. The user</span>
<span class="sd">can modify cards later on by modifying attributes after the card has been</span>
<span class="sd">created.</span>

<span class="sd">The first section on this page, Index, list all the cards with their category.</span>
<span class="sd">The second section is Reference, which contains the reference for all the</span>
<span class="sd">classes. In the Reference, the classes are listed in alphabeticla order.</span>

<span class="sd">.. moduleauthor:: Chris Dembia &lt;cld72@cornell.edu&gt;</span>


<span class="sd">*****</span>
<span class="sd">Index</span>
<span class="sd">*****</span>

<span class="sd">This section presents a listing of the cell cards, with links to their</span>
<span class="sd">reference, based on the category to which the cell cards belong. The categories</span>
<span class="sd">are important because cards must have a unique name within their category.</span>

<span class="sd">An inheritance diagram of all the classes in this module can be found at</span>
<span class="sd">:ref:`pyne_simplesim_inheritance`. All cards are subclassed from</span>
<span class="sd">:py:class:`ICard`, which is not part of any of the categories below. The only</span>
<span class="sd">exception is the :py:class:`Particle` class, which is a helper class used</span>
<span class="sd">whenever a particle must be specified as part of a card.</span>

<span class="sd">------------</span>
<span class="sd">System cards</span>
<span class="sd">------------</span>
<span class="sd">These are the cards that are provided in a</span>
<span class="sd">:py:class:`pyne.simplesim.definition.SystemDefinition`. See further down for</span>
<span class="sd">more subcategories. Cell cards are added to a simulation using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SystemDefinition.add_cell`, and cell card</span>
<span class="sd">names must be unique among cell cards.</span>
<span class="sd">Material cards are added using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SystemDefinition.add_material`, and</span>
<span class="sd">material card names must be unique among material cards.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    Cell</span>
<span class="sd">    CellMCNP</span>
<span class="sd">    Material</span>


<span class="sd">Surface cards</span>
<span class="sd">^^^^^^^^^^^^^</span>
<span class="sd">Surface cards are added to a system using </span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SystemDefinition.add_surface`.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    ISurface</span>
<span class="sd">    IAxisSurface</span>
<span class="sd">    AxisCylinder</span>
<span class="sd">    AxisPlane</span>


<span class="sd">Macrobodies</span>
<span class="sd">^^^^^^^^^^^</span>
<span class="sd">These are surfaces built from simpler surfaces, and accordingly have (will</span>
<span class="sd">have) facet functionality. These cards are still added via</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SystemDefinition.add_surface`, and so their</span>
<span class="sd">names must be unique among the surfaces.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    IMacrobody</span>
<span class="sd">    Facet</span>
<span class="sd">    Parallelepiped</span>
<span class="sd">    Cuboid</span>


<span class="sd">Region</span>
<span class="sd">^^^^^^</span>
<span class="sd">Cells require a region, and regions are constructed using surfaces. These</span>
<span class="sd">classes are used to form a binary tree. The &amp; and | operators are overloaded to</span>
<span class="sd">facilitate the construction of solid regions from surfaces. These cards can be</span>
<span class="sd">named if so desired, but otherwise are not really part of a system like cell,</span>
<span class="sd">surface, and material cards are.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    IRegion</span>
<span class="sd">    IRegionBool</span>
<span class="sd">    RegionAnd</span>
<span class="sd">    RegionOr</span>
<span class="sd">    RegionLeaf</span>


<span class="sd">----------------</span>
<span class="sd">Simulation cards</span>
<span class="sd">----------------</span>
<span class="sd">These are the cards that are provided in a</span>
<span class="sd">:py:class:`pyne.simplesim.definition.SimulationDefinition`. Some of the cards</span>
<span class="sd">can only be used in subclasses of :py:class:`SimulationDefinition`, such as</span>
<span class="sd">:py:class:`Transformation`.</span>

<span class="sd">The following two cars form their own categories, and are the only card in</span>
<span class="sd">their respective category. Distributions are added to simulations using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SimulationDefinition.add_dist`, and</span>
<span class="sd">transformations are added using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.MCNPSimulation.add_transformation` (they</span>
<span class="sd">are only available for MCNP simulations). Card names must be unique within</span>
<span class="sd">their own category.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    Distribution</span>
<span class="sd">    Transformation</span>


<span class="sd">Source</span>
<span class="sd">^^^^^^</span>
<span class="sd">These cards are used to define particle sources.</span>
<span class="sd">Add these cards to a simulation using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SimulationDefinition.add_source`. Card</span>
<span class="sd">names must be unique among source cards.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    ISource</span>
<span class="sd">    GeneralSource</span>
<span class="sd">    Criticality</span>
<span class="sd">    CriticalityPoints</span>


<span class="sd">Tally</span>
<span class="sd">^^^^^</span>
<span class="sd">Particle tallies/detectors.</span>
<span class="sd">Add these cards to a simulation using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SimulationDefinition.add_tally`. Card names</span>
<span class="sd">must be unique among tally cards.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    ITally</span>
<span class="sd">    ICellSurfTally</span>
<span class="sd">    SurfaceCurrent</span>
<span class="sd">    CellFlux</span>
<span class="sd">    CellEnergyDeposition</span>
<span class="sd">    CellFissionEnergyDeposition</span>
<span class="sd">    CellPulseHeight</span>
<span class="sd">    CellChargeDeposition</span>
<span class="sd">    IDetector</span>
<span class="sd">    PointDetector</span>
<span class="sd">    RingDetector</span>


<span class="sd">Miscellaneous</span>
<span class="sd">^^^^^^^^^^^^^</span>
<span class="sd">These cars do not have card numbers and do not fit into any other category.</span>
<span class="sd">Add these cards to a simulation using</span>
<span class="sd">:py:meth:`pyne.simplesim.definition.SimulationDefinition.add_misc`. Card names</span>
<span class="sd">must be unique among misc scards.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    IMisc</span>
<span class="sd">    ScatteringLaw</span>
<span class="sd">    EnergyGrid</span>
<span class="sd">    ICellMod</span>
<span class="sd">    Universes</span>
<span class="sd">    Fill</span>
<span class="sd">    Lattice</span>
<span class="sd">    Volume</span>
<span class="sd">    Area</span>
<span class="sd">    FissionTurnoff</span>
<span class="sd">    PhotonWeight</span>
<span class="sd">    DetectorContribution</span>
<span class="sd">    IUniqueParticle</span>
<span class="sd">    Temperature</span>
<span class="sd">    TemperatureTimes</span>
<span class="sd">    ICellModParticle</span>
<span class="sd">    Importance</span>
<span class="sd">    ExponentialTransform</span>
<span class="sd">    ForcedCollision</span>
<span class="sd">    WeightWindowBound</span>
<span class="sd">    WeightWindowEnergies</span>
<span class="sd">    WeightWindowTimes</span>
<span class="sd">    DXTRANContribution</span>
<span class="sd">    DXTRANSpheres</span>
<span class="sd">    Vector</span>


<span class="sd">------------</span>
<span class="sd">Custom cards</span>
<span class="sd">------------</span>
<span class="sd">A custom card is used when other cards, within a given category, do not satisfy</span>
<span class="sd">the needs of the user. They are added to the system or simulation using the</span>
<span class="sd">``add_*`` method for their category, and the names must be unique within their category.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    Custom</span>
<span class="sd">    CellCustom</span>
<span class="sd">    SurfaceCustom</span>
<span class="sd">    MaterialCustom</span>
<span class="sd">    SourceCustom</span>
<span class="sd">    DistributionCustom</span>
<span class="sd">    TallyCustom</span>
<span class="sd">    MiscCustom</span>
<span class="sd">    TransformationCustom</span>


<span class="sd">-------------</span>
<span class="sd">Unimplemented</span>
<span class="sd">-------------</span>
<span class="sd">The following cards are defined but are unimplemented.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    MaterialMCNP</span>
<span class="sd">    Comment</span>
<span class="sd">    Mode</span>
<span class="sd">    NeutronPhysics</span>
<span class="sd">    PhotonPhysics</span>
<span class="sd">    ElectronPhysics</span>
<span class="sd">    ProtonPhysics</span>
<span class="sd">    Burnup</span>


<span class="sd">Nested Geometry</span>
<span class="sd">^^^^^^^^^^^^^^^</span>
<span class="sd">These cards would allow the preferred way of constructing universes and</span>
<span class="sd">lattices. Currently, universe and lattice functionality `is` implemented, but</span>
<span class="sd">not through these cards.</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :nosignatures:</span>

<span class="sd">    IUniverse</span>
<span class="sd">    UniverseByRegion</span>
<span class="sd">    UniverseByLattice</span>
<span class="sd">    Lattice</span>
<span class="sd">    LatticeByArray</span>


<span class="sd">*********</span>
<span class="sd">Reference</span>
<span class="sd">*********</span>

<span class="sd">All classes are listed in alphabetical order. Cards that are available in MCNP</span>
<span class="sd">have their MCNP card name in the reference; feel free to search for it to find</span>
<span class="sd">the related simplesim card.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># TODO if i make a material card, make sure to revert back to the Material</span>
<span class="c"># object that Anthony has once they implement a comment.</span>
<span class="c"># TODO allow card suppression (don&#39;t delete but don&#39;t print it).</span>
<span class="c"># TODO allow readfile commands.</span>
<span class="c"># TODO emphasize how easy it is to modify the cards, just subclass it</span>
<span class="c"># individually and use your own.</span>
<span class="c"># Disadvantage of actually providing the cell card is now if you want to modify</span>
<span class="c"># something later, you have to go grab the appropriate cell card, since you</span>
<span class="c"># don&#39;t have the object anymore.</span>
<span class="c"># TODO check WWGT default arg effect in WWN.</span>
<span class="c"># TODO improve inheritance around ICellMod; lots of copied code from</span>
<span class="c"># ICellModParticle.</span>
<span class="c"># TODO big opportunity to pretty-up what the mcnp() output looks like.</span>
<span class="c"># TODO consistent plural card names when appropriate.</span>
<span class="c"># Refactor CellMCNP so all relevant classes have a method _mcnp_cell_comment</span>
<span class="c"># and _mcnp_cell_card</span>
<span class="c"># TODO in Cell, require that the material is not pyne.card.Material, but is a</span>
<span class="c"># card here (error check).</span>
<span class="c"># TODO names can be unique to tally type even.</span>
<span class="c"># TODO for read/writing, using repr makes recreating really easy; otherwise</span>
<span class="c"># decoding would take some effort. repr also means that i probably should use</span>
<span class="c"># name referencing everywhere, not object passing. however using json() would</span>
<span class="c"># create something more human-readable.</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">nucname</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">material</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">nestedgeom</span> <span class="k">as</span> <span class="n">ng</span>

<span class="k">def</span> <span class="nf">_validate_name</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">isunique</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``name`` cannot contain spaces. &quot;</span>
                         <span class="s">&quot;User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">isunique</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;This is a unique card, meaning only one card&quot;</span>
                            <span class="s">&quot; of this type can be found in a ``definition``. &quot;</span>
                            <span class="s">&quot;Accordingly, the name is read-only.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The ``name`` property of the cannot be empty.&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="ICard"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICard">[docs]</a><span class="k">class</span> <span class="nc">ICard</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for all cards.</span>
<span class="sd">    All cards have a name property and a comment() method.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># This line makes this class an abstract base class (ABC).</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>
    <span class="c"># Useful for cell cards and the TMP card in MCNP.</span>
    <span class="c"># k is Boltzmann&#39;s constant in eV/K, and T is temperature in K</span>
    <span class="n">kelvin2kT</span> <span class="o">=</span> <span class="mf">8.6173423e-11</span>
    <span class="n">secs2shakes</span> <span class="o">=</span> <span class="mf">1e+8</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of this instance of this card, used for referencing this card</span>
<span class="sd">            from others and modifying this card after it has been added to a</span>
<span class="sd">            definition (see :py:mod:`pyne.simplesim.definition`). The only</span>
<span class="sd">            known restriction on the format of the name is that it cannot</span>
<span class="sd">            contain spaces. </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Somebody on the internet said to use super() even when only</span>
        <span class="c"># subclassing from object. I&#39;m commenting this out because it prevents</span>
        <span class="c"># MaterialCustom from working.</span>
        <span class="c">#super(ICard, self).__init__()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unique</span> <span class="o">=</span> <span class="n">unique</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c"># TODO Do we actually want to do this? Perhaps not; it may lead to</span>
        <span class="c"># recursion.</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span>

    <span class="c"># All subclasses must define a comment() method.</span>
    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="ICard.comment"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICard.comment">[docs]</a>    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;All cards define a comment describing the content of the card.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c"># sim is an instance of</span>
        <span class="c"># :py:class:`pyne.simplesim.definition.SimulationDefinition`.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;Card {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<div class="viewcode-block" id="ICard.json"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICard.json">[docs]</a>    <span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns something that can be used to encode this class in a JSON</span>
<span class="sd">        file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># return self.__repr__()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@name.setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">_validate_name</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Cell"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Cell">[docs]</a><span class="k">class</span> <span class="nc">Cell</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A cell is a region of space filled with a material. If requesting a void</span>
<span class="sd">    cell, the ``material``, ``density``, and ``density_units`` attributes are</span>
<span class="sd">    all set to None (as by default).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">density_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">universe</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        region : :py:class:`Region` subclass</span>
<span class="sd">            Defines the region of space that this cell occupies (see</span>
<span class="sd">            :py:class:`Region`).</span>
<span class="sd">        material : :py:class:`pyne.simplesim.cards.Material`, None for void</span>
<span class="sd">            A material definition using the :py:mod:`pyne.material` module.</span>
<span class="sd">            For use here, the material&#39;s :py:attr:`name` property must be set</span>
<span class="sd">            to something other than &#39;&#39; and must be unique within the materials.</span>
<span class="sd">            See :py:class:`pyne.material.Material`.</span>
<span class="sd">        density : float, None for void</span>
<span class="sd">            Density for the material, in units of density_units.</span>
<span class="sd">        density_units : str, None for void</span>
<span class="sd">            Either &#39;g/cm^3&#39;, or &#39;atoms/b/cm&#39;.</span>
<span class="sd">        universe : 2-element tuple, optional</span>
<span class="sd">            To make this cell part of a universe, provide the name of that</span>
<span class="sd">            universe. Universes are often composed of more than one cell, and</span>
<span class="sd">            so this name is likely to appear on other cell cars as well. Tuple</span>
<span class="sd">            contains:</span>

<span class="sd">            1. (str) name of universe</span>
<span class="sd">            2. (bool) True for truncating, False otherwise.</span>

<span class="sd">            Refer to :py:class:`Universes` for more information.</span>
<span class="sd">        fill : str, or 4-element tuple, optional</span>
<span class="sd">            The name of a universe with which to fill this cell. Typically,</span>
<span class="sd">            cells that are filled with a universe are void themselves. If</span>
<span class="sd">            tuple (only makes sense for lattice cells), it contains:</span>

<span class="sd">            1. 2-element list of x-index bounds ([], or [0, 0] for 1 row/col)</span>
<span class="sd">            2. 2-element list of y-index bounds ([], or [0, 0] for 1 row/col)</span>
<span class="sd">            3. 2-element list of z-index bounds ([], or [0, 0] for 1 row/col)</span>
<span class="sd">            4. 1-D, 2-D, or 3-D list of universe names, or None to use the</span>
<span class="sd">               real world universe. See examples.</span>

<span class="sd">        lattice : str, optional</span>
<span class="sd">            Makes this cell is a repeating lattice. Can be either</span>
<span class="sd">            &#39;hexahedra&#39; for 6-sided elements or &#39;hexagonal&#39; for 8-sided</span>
<span class="sd">            elements.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Suppose we have surface cards ``surfA`` and ``surfB``, and material</span>
<span class="sd">        card ``matA``. The following creates a void cell on the</span>
<span class="sd">        negative side of ``surfA`` and the positive side of ``surfB`` (see</span>
<span class="sd">        :py:class:`Region` to learn how to create regions)::</span>

<span class="sd">            cellA = Cell(&#39;A&#39;, surfA.neg &amp; surfB.pos)</span>

<span class="sd">        The following cell is filled with ``matA``::</span>

<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, matA, 10.0, &#39;g/cm^3&#39;)</span>
<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, matA, 0.5, &#39;atoms/b/cm&#39;)</span>

<span class="sd">        Note that if a material is specified, a density and density units must</span>
<span class="sd">        also be provided The following is not allowed::</span>

<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, matA)</span>
<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, matA, density=1)</span>
<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, matA, </span>
<span class="sd">                    density_units=&#39;g/cm^3&#39;)</span>
<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, density=1)</span>
<span class="sd">            cellB = Cell(&#39;B&#39;, surfA.neg &amp; surfB.pos, </span>
<span class="sd">                    density_units=&#39;g/cm^3&#39;)</span>

<span class="sd">        The following creates a new universe, and places two cells in it::</span>

<span class="sd">            cellC = Cell(&#39;C&#39;, surfA.neg &amp; surfB.pos, matA, density=1,</span>
<span class="sd">                    density_units=&#39;g/cm^3&#39;,</span>
<span class="sd">                    universe=(&#39;unitcell&#39;, True))</span>
<span class="sd">            cellD = Cell(&#39;D&#39;, surfC.neg, matC, density=2,</span>
<span class="sd">                    density_units=&#39;g/cm^3&#39;,</span>
<span class="sd">                    universe=(&#39;unitcell&#39;, False))</span>

<span class="sd">        Note that the universe isn&#39;t actually `created` until this card is</span>
<span class="sd">        added to a system::</span>

<span class="sd">            sys = definition.SystemDefinition()</span>
<span class="sd">            sys.add_cell(cellD)</span>

<span class="sd">        Now, we can create a cell filled with the &#39;unitcell&#39; universe::</span>

<span class="sd">            cellE = Cell(&#39;E&#39;, fill=&#39;unitcell&#39;)</span>

<span class="sd">        If we had two universes &#39;A&#39; and &#39;B&#39;, we could fill a finite lattice</span>
<span class="sd">        cell as follows::</span>
<span class="sd">       </span>
<span class="sd">            #                 element (0, 0, 0)   element (4, 0, 0)</span>
<span class="sd">            #                /                   /</span>
<span class="sd">            univ_names = [[&#39;A&#39;, &#39;B&#39;, &#39;A&#39;, &#39;B&#39;, &#39;A&#39;],</span>
<span class="sd">                          [&#39;B&#39;, &#39;A&#39;, &#39;B&#39;, &#39;A&#39;, &#39;B&#39;]]</span>
<span class="sd">            #               ^                   ^</span>
<span class="sd">            #               element (0, 1, 0)   element (4, 1, 0)</span>
<span class="sd">            cellF = Cell(&#39;F&#39;, surfA.neg, lattice=&#39;hexahedra&#39;,</span>
<span class="sd">                    fill=([0, 4], [0, 1], [], univ_names))</span>

<span class="sd">        Here is an example for a 3-D finite lattice::</span>

<span class="sd">            #                 (0, 0, -1)  (2, 0, -1)</span>
<span class="sd">            #                /           /</span>
<span class="sd">            univ_names = [[[&#39;A&#39;,  &#39;B&#39;,  &#39;A&#39;], </span>
<span class="sd">                           [&#39;B&#39;,  &#39;A&#39;,  &#39;B&#39;]],</span>
<span class="sd">                          [[&#39;A&#39;,  None, &#39;A&#39;],</span>
<span class="sd">                           [&#39;B&#39;,  &#39;A&#39;,  &#39;B&#39;]]]</span>
<span class="sd">            #                ^           ^</span>
<span class="sd">            #                (0, 1, 0)  (2, 1, 0)</span>
<span class="sd">            #</span>
<span class="sd">            cellF = Cell(&#39;F&#39;, surfA.neg, lattice=&#39;hexahedra&#39;,</span>
<span class="sd">                    fill=([0, 2], [0, 1], [-1, 0], univ_names))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># TODO decide how I will do cross-referencing.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="o">=</span> <span class="n">material</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="n">density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">universe</span> <span class="o">=</span> <span class="n">universe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span> <span class="o">=</span> <span class="n">lattice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_units</span> <span class="o">=</span> <span class="n">density_units</span>
        <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_units</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density_units</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">))</span> <span class="ow">or</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density_units</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;If specifying a material, ``material``, &quot;</span>
                    <span class="s">&quot;``density``, and ``density_units`` must all be &quot;</span>
                    <span class="s">&quot;specified.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Cell {0!r}: region {1}, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">comment</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_units</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;material {0!r} density {1:g} {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_units</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;void&quot;</span>
        <span class="c"># Univ, fill, lattice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Universes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; univ{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="c"># if IS tuple, mcnp_long_tuple is called.</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">Fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; fill{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># Lattice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Lattice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; lattice{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; fill long format&quot;</span>
        <span class="k">if</span> <span class="n">period</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;.&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c"># Card number.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;Cell {0!r} not in simulation.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;{{: &lt;{0}d}}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">formatstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">material</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_units</span><span class="p">:</span>
            <span class="c"># Material number.</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">material_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="c"># Density, with units prefix.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_units</span> <span class="o">==</span> <span class="s">&#39;g/cm^3&#39;</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Void.</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; 0&quot;</span>
        <span class="c"># Print surfaces.</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span>
        <span class="c"># Univ, fill, lattice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Universes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">universe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; U={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span>
                <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="c"># if IS tuple, mcnp_long_tuple is called.</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">Fill</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; FILL={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span>
                    <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># Lattice</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Lattice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lattice</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; LAT={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span>
                <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CellMCNP</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_keywords</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_long_fill</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">_mcnp_long_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">x_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">z_idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">univ_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">{0}FILL={1[0]}:{1[1]} {2[0]}:{2[1]} {3[0]}:{3[1]}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="mi">5</span> <span class="o">*</span> <span class="s">&quot; &quot;</span><span class="p">,</span>
                <span class="n">x_idxs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">y_idxs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">z_idxs</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">n_dim</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z_idxs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">z_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">zdim</span> <span class="ow">in</span> <span class="n">univ_names</span><span class="p">:</span>
            <span class="c"># Allow easy looping if 1 dimension only.</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">zdim</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">zdim</span> <span class="o">=</span> <span class="p">[</span><span class="n">zdim</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="s">&quot; &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">{0}$ k = {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">counter</span><span class="p">)</span>
                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">ydim</span> <span class="ow">in</span> <span class="n">zdim</span><span class="p">:</span>
                <span class="c"># Allow easy looping if 2 dimensions only.</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ydim</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">ydim</span> <span class="o">=</span> <span class="p">[</span><span class="n">ydim</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">n_dim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="s">&quot; &quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">univ_name</span> <span class="ow">in</span> <span class="n">ydim</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">universe_num</span><span class="p">(</span><span class="n">univ_name</span><span class="p">)</span> <span class="k">if</span> <span class="n">univ_name</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">region</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_region</span>

    <span class="nd">@region.setter</span>
    <span class="k">def</span> <span class="nf">region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_region</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">material</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_material</span>

    <span class="nd">@material.setter</span>
    <span class="k">def</span> <span class="nf">material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="c"># This check is redundant.</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Material</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``material`` must be instance &quot;</span>
                    <span class="s">&quot;of ``pyne.simplesim.cards.Material``. &quot;</span>
                    <span class="s">&quot;User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">obj</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The ``name`` property of the material cannot &quot;</span>
                    <span class="s">&quot;be empty.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_material</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density</span>

    <span class="nd">@density.setter</span>
    <span class="k">def</span> <span class="nf">density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">density_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density_units</span>

    <span class="nd">@density_units.setter</span>
    <span class="k">def</span> <span class="nf">density_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s">&#39;g/cm^3&#39;</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s">&#39;atoms/b/cm&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``density_units`` must be either &quot;</span>
                    <span class="s">&quot;&#39;g/cm^3&#39; or &#39;atoms/b/cm&#39;. User provided &quot;</span>
                    <span class="s">&quot;{0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_density_units</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">universe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_universe</span>

    <span class="nd">@universe.setter</span>
    <span class="k">def</span> <span class="nf">universe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_universe</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span>

    <span class="nd">@fill.setter</span>
    <span class="k">def</span> <span class="nf">fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lattice</span>

    <span class="nd">@lattice.setter</span>
    <span class="k">def</span> <span class="nf">lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lattice</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="CellMCNP"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellMCNP">[docs]</a><span class="k">class</span> <span class="nc">CellMCNP</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A cell card with keyword options that are available in MCNP.</span>
<span class="sd">    Thus, it</span>
<span class="sd">    only makes sense to use this card if writing an input for MCNP. A number of</span>
<span class="sd">    the keyword arguments are for a particular particle. The particles</span>
<span class="sd">    available are given in :py:class:`Particle`. The user provides the full</span>
<span class="sd">    name of the particle, as given as keys in :py:attr:`Particle.mcnp_abbrev`.</span>
<span class="sd">    The card will then use the appropriate particle designator when writing the</span>
<span class="sd">    card.</span>
<span class="sd">    </span>
<span class="sd">    See :py:class:`Cell` for universes, fill, and lattices.</span>
<span class="sd">    </span>
<span class="sd">    Note this card was written with MCNPX version 2.7 in mind.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CellMCNP</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO Sphinx documentation should not list all keyword arguments.</span>
    <span class="c"># TODO Transformation: allow default arguments.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">density_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">temperature</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">importance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">exp_transform</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">forced_coll</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">weight_win_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">dxtran_contrib</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">photon_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">fission_turnoff</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">det_contrib</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">transformation</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">user_custom</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        region : :py:class:`Region`</span>
<span class="sd">            See :py:class:`Cell`.</span>
<span class="sd">        material : :py:class:`pyne.simplesim.cards.Material`, None for void</span>
<span class="sd">            See :py:class:`Cell`.</span>
<span class="sd">        density : float, None for void</span>
<span class="sd">            See :py:class:`Cell`.</span>
<span class="sd">        density_units : str, None for void</span>
<span class="sd">            See :py:class:`Cell`.</span>
<span class="sd">        temperature : float, otional [Kelvin]</span>
<span class="sd">            Temperature of the cell for thermal treatment,</span>
<span class="sd">            :py:class:`Temperature`, **TMP**.</span>
<span class="sd">        volume : float, optional [cm^3]</span>
<span class="sd">            Volume of the cell, :py:class:`Volume`, **VOL**.</span>
<span class="sd">        importance : 2-element tuple, or list of tuples, optional</span>
<span class="sd">            Particle importance, :py:class:`Importance`, **IMP**. The tuple</span>
<span class="sd">            contains:</span>
<span class="sd">            </span>
<span class="sd">            1. (str) particle name (see :py:class:`Particle`)</span>
<span class="sd">            2. (int) the importance</span>

<span class="sd">            Refer to :py:class:`Importance` for more information.</span>
<span class="sd">            To specify this input for more</span>
<span class="sd">            than one particle, provide a list of these tuples.</span>
<span class="sd">        exp_transform : 4-element tuple, or list of tuples, optional</span>
<span class="sd">            An exponential transform, :py:class:`ExponentialTransform`,</span>
<span class="sd">            **EXT**. The tuple contains:</span>

<span class="sd">            1. (str) particle name (see :py:class:`Particle`)</span>
<span class="sd">            2. (str/float) stretch</span>
<span class="sd">            3. (str) direction</span>
<span class="sd">            4. (str) sign (&#39;toward&#39;, &#39;away&#39;)</span>
<span class="sd">            </span>
<span class="sd">            Refer to :py:class:`ExponentialTransform` for the form of these</span>
<span class="sd">            inputs.</span>
<span class="sd">            To specify this input for more</span>
<span class="sd">            than one particle, provide a list of these tuples.</span>
<span class="sd">        forced_coll : 3-element tuple, or list of tuples, optional</span>
<span class="sd">            Forced collisions, :py:class:`ForcedCollision`, **FCL**. The tuple</span>
<span class="sd">            contains:</span>

<span class="sd">            1. (str) particle name (see :py:class:`Particle`)</span>
<span class="sd">            2. (float) probability</span>
<span class="sd">            3. (bool) only entering the cell triggers forced collision</span>

<span class="sd">            Refer to :py:class:`ForcedCollision` for the</span>
<span class="sd">            form of these inputs.</span>
<span class="sd">            To specify this input for more</span>
<span class="sd">            than one particle, provide a list of these tuples.</span>
<span class="sd">        weight_win_bound : 4-element tuple, or list of tuples, optional</span>
<span class="sd">            Weight window lower bound, :py:class:`WeightWindowBound`, **WWN**.</span>
<span class="sd">            The tuple contains:</span>

<span class="sd">            1. (str) particle name (see :py:class:`Particle`)</span>
<span class="sd">            2. (int) energy index</span>
<span class="sd">            3. (int) time index</span>
<span class="sd">            4. (float/str) lower bound, or &#39;killall&#39;</span>

<span class="sd">            Refer to :py:class:`WeightWindowBound` for the form of these</span>
<span class="sd">            inputs.</span>
<span class="sd">            To specify this input for more than one particle, or energy/time</span>
<span class="sd">            index, provide a list of these tuples.</span>
<span class="sd">        dxtran_contrib : 3-element tuple, or list of tuples, optional</span>
<span class="sd">            Probability of contribution to a DXTRAN sphere,</span>
<span class="sd">            :py:class:`DXTRANContribution`, **DXC**.  The tuple contains:</span>
<span class="sd">            </span>
<span class="sd">            1. (str) particle name (see :py:class:`Particle`)</span>
<span class="sd">            2. (str/None) DXTRAN sphere name (None for all spheres)</span>
<span class="sd">            3. (float) probabilility of contribution</span>
<span class="sd">            </span>
<span class="sd">            Refer to :py:class:`DXTRANContribution` for the form of these</span>
<span class="sd">            inputs.</span>
<span class="sd">            To specify this input for more than one particle or DXTRAN sphere,</span>
<span class="sd">            provide a list of these tuples.</span>
<span class="sd">        photon_weight : 2-element tuple, or list of tuples, optional</span>
<span class="sd">            Threshold weight of photons that are produced at neutron</span>
<span class="sd">            collisions, :py:class:`PhotonWeight`, **PWT**. The tuple contains:</span>

<span class="sd">            1. (str/float) &#39;off&#39;, &#39;one&#39;, or weight threshold parameter</span>
<span class="sd">            2. (bool) ``pre_weight``; relevant is 1st element is float</span>
<span class="sd">               (optional)</span>

<span class="sd">            Refer to :py:meth:`PhotonWeight.set` for the form of these</span>
<span class="sd">            inputs.</span>
<span class="sd">        fission_turnoff : str, optional</span>
<span class="sd">            Fission turnoff, :py:class:`FissionTurnoff`, **NONU**. The allowed</span>
<span class="sd">            values are: &#39;capture-gamma&#39;, &#39;real-gamma&#39;, and &#39;capture-nogamma&#39;.</span>
<span class="sd">            Refer to :py:meth:`FissionTurnoff` for more information.</span>
<span class="sd">        det_contrib : tuple of str and float, optional</span>
<span class="sd">            Detector contribution, :py:class:`DetectorContribution`, **PD**.</span>
<span class="sd">            The tuple contains:</span>

<span class="sd">            1. (str) name of :py:class:`IDetector` tally obtaining contribution </span>
<span class="sd">               from this cell</span>
<span class="sd">            2. (float) probability of contribution</span>
<span class="sd">            </span>
<span class="sd">            Refer to :py:meth:`DetectorContribution` for the form of these</span>
<span class="sd">            inputs.</span>
<span class="sd">            To specify this input for more than one tally, provide a list of</span>
<span class="sd">            these tuples.</span>
<span class="sd">        transformation : str or 4-element tuple, optional</span>
<span class="sd">            Cell transformation, **TRCL**. If str, it is the name of a</span>
<span class="sd">            :py:class:`Transformation` card. If tuple, it contains:</span>
<span class="sd">            </span>
<span class="sd">            1. (list/:py:class:`np.array`) displacement vector</span>
<span class="sd">            2. (3 x 3 list/:py:class:`np.array`/:py:class:`np.matrix`) </span>
<span class="sd">               rotation matrix</span>
<span class="sd">            3. (bool) If True, &#39;aux-in-main&#39;, else &#39;main-in-aux&#39; (optional)</span>
<span class="sd">            4. (bool) Rotation in degrees if True, in cosines if False</span>
<span class="sd">               (optional)</span>

<span class="sd">             Refer to :py:class:`Transformation` for the form of these inputs</span>
<span class="sd">             and the default values for the optional arguments.</span>
<span class="sd">        user_custom : str, optional</span>
<span class="sd">            This string is appended to the end of the MCNP card. It is possible</span>
<span class="sd">            that the user will want to append a string to the end of the MCNP</span>
<span class="sd">            card, given the limited support of keyword arguments. This is</span>
<span class="sd">            perhaps most useful if the user wants to specify a keyword for a</span>
<span class="sd">            particle that is not supported by any of the keyword arguments</span>
<span class="sd">            above.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following sets the temperature of the cell to 600 K, its volume</span>
<span class="sd">        to 1.5 cm^3, and the neutron impotartance to 1.::</span>

<span class="sd">            cellA = CellMCNP(&#39;A&#39;, surfA.neg &amp; surfB.pos,</span>
<span class="sd">                    matA, 10.0, &#39;g/cm^3&#39;,</span>
<span class="sd">                    temperature=600, volume=1,</span>
<span class="sd">                    importance=(&#39;neutron&#39;, 1))</span>

<span class="sd">        The following sets the neutron importance to 1 and the photon</span>
<span class="sd">        importance to 0::</span>

<span class="sd">            cellA = CellMCNP(&#39;A&#39;, surfA.neg &amp; surfB.pos,</span>
<span class="sd">                    matA, 10.0, &#39;g/cm^3&#39;,</span>
<span class="sd">                    importance=[(&#39;neutron&#39;, 1), (&#39;photon&#39;, 0)])</span>

<span class="sd">        The following sets an exponential transform for neutrons with stretch</span>
<span class="sd">        &#39;capture-to-total&#39; toward the current direction of travel of the</span>
<span class="sd">        particle, and a differente transform for photons::</span>

<span class="sd">            cellA = CellMCNP(..., exp_transform=[</span>
<span class="sd">                    (&#39;neutron&#39;, &#39;capture-to-total&#39;, &#39;currdir&#39;, &#39;toward&#39;),</span>
<span class="sd">                    (&#39;photon&#39;, 0.5, &#39;x&#39;, &#39;away&#39;)])</span>

<span class="sd">        The direction can be the name of a vector (e.g. `vec1`) on the</span>
<span class="sd">        :py:class:`Vector` card, as long as the :py:class:`Vector` has been</span>
<span class="sd">        added to the simulation before an input is generated::</span>

<span class="sd">            cellA = CellMCNP(..., </span>
<span class="sd">                    exp_transform=(&#39;neutron&#39;, 0.5, &#39;vec1&#39;, &#39;away&#39;))</span>
<span class="sd">            vec = Vector()</span>
<span class="sd">            vec.set(&#39;vec1&#39;, [0, 0, 0])</span>

<span class="sd">        We can request forced collision for neutrons that enter the cell and</span>
<span class="sd">        as part of weight games::</span>

<span class="sd">            cellA = CellMCNP(..., forced_coll=(&#39;neutron&#39;, 0.5, False))</span>

<span class="sd">        The following specifies the lower bound for neutrons at energy index,</span>
<span class="sd">        3, time index 1 (assuming that the :py:class:`WeightWindowEnergies`</span>
<span class="sd">        card is in the simulation)::</span>

<span class="sd">            cellA = CellMCNP(..., </span>
<span class="sd">                    weight_win_bound=(&#39;neutron&#39;, 3, 1, &#39;killall&#39;))</span>

<span class="sd">        The following specifies the probability that neutrons from this cell</span>
<span class="sd">        will tally in DXTRAN sphere &#39;sph1&#39; (assuming a sphere with this name will be</span>
<span class="sd">        in the simulation, on the :py:class:`DXTRANSpheres` card)::</span>
<span class="sd">        </span>
<span class="sd">            cellA = CellMCNP(..., dxtran_contrib=(&#39;neutron&#39;, &#39;det1&#39;, 0.5))</span>
<span class="sd">            sim = definition.MCNPDefinition(...)</span>
<span class="sd">            det1 = PointDetector(&#39;det1&#39;, ...)</span>
<span class="sd">            sim.add_tally(det1)</span>

<span class="sd">        Here are two examples of specifying a photon weight threshold (the bool</span>
<span class="sd">        can be provided if the first element is a float, but defaults to False</span>
<span class="sd">        otherwise)::</span>

<span class="sd">            cellA = CellMCNP(..., photon_weight=(&#39;one&#39;,))</span>
<span class="sd">            cellA = CellMCNP(..., photon_weight=(0.5,))</span>
<span class="sd">            cellA = CellMCNP(..., photon_weight=(0.5, True))</span>

<span class="sd">        The following turns off fission in this cell, but still requests that</span>
<span class="sd">        gammas are generated by fission interactions::</span>
<span class="sd">        </span>
<span class="sd">            cellA = CellMCNP(..., fission_turnoff=&#39;capture-gamma&#39;)</span>

<span class="sd">        The following specifies the probability that this cell contributes to</span>
<span class="sd">        detector `det1`, which must be in the simulation::</span>

<span class="sd">            cellA = CellMCNP(..., det_contrib=(&#39;det1&#39;, 0.5))</span>

<span class="sd">        A transformation can be provided by referring to a</span>
<span class="sd">        :py:class:`Transformation` card::</span>

<span class="sd">            cellA = CellMCNP(..., transformation=&#39;transA&#39;)</span>
<span class="sd">            transA = Transformation(&#39;transA&#39;, ...)</span>
<span class="sd">            sim = definition.MCNPSimulation(...)</span>
<span class="sd">            sim.add_transformation(transA)</span>

<span class="sd">        Alternatively, a transformation can be specified right on the keyword.</span>
<span class="sd">        Here we have used the default values for the last two inputs::</span>

<span class="sd">            cellA = CellMCNP(..., transformation=([1, 0, 0], np.eye(3))</span>

<span class="sd">        Here, we want to change the 4th element from its default, value, so we</span>
<span class="sd">        must specify the 3rd element even though it has its default value::</span>

<span class="sd">            cellA = CellMCNP(..., transformation=([1, 0, 0], np.eye(3),</span>
<span class="sd">                    True, True))</span>

<span class="sd">        If the user wants to supply an exponential transform keyword, with a</span>
<span class="sd">        transform of &#39;0.7V2&#39;, on their own, they can do the following::</span>

<span class="sd">            cellA = CellMCNP(&#39;A&#39;, surfA.neg &amp; surfB.pos,</span>
<span class="sd">                    matA, 10.0, &#39;g/cm^3&#39;,</span>
<span class="sd">                    importance=[(&#39;neutron&#39;, 1), (&#39;photon&#39;, 0)],</span>
<span class="sd">                    user_custom=&#39;EXT:N 0.7V2&#39;)</span>

<span class="sd">        and the user_custom string will be printed at the end of the cell card.</span>

<span class="sd">        See :py:class:`Cell` for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># TODO check that the importance isn&#39;t set for the same particle</span>
        <span class="c"># multiple times.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CellMCNP</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span>
                                       <span class="n">density_units</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c"># Assign keyword arguments.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">temperature</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">importance</span> <span class="o">=</span> <span class="n">importance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_transform</span> <span class="o">=</span> <span class="n">exp_transform</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forced_coll</span> <span class="o">=</span> <span class="n">forced_coll</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight_win_bound</span> <span class="o">=</span> <span class="n">weight_win_bound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dxtran_contrib</span> <span class="o">=</span> <span class="n">dxtran_contrib</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photon_weight</span> <span class="o">=</span> <span class="n">photon_weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fission_turnoff</span> <span class="o">=</span> <span class="n">fission_turnoff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">det_contrib</span> <span class="o">=</span> <span class="n">det_contrib</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span> <span class="o">=</span> <span class="n">transformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span> <span class="o">=</span> <span class="n">user_custom</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellMCNP</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># temperature</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; TMP=&quot;</span> <span class="o">+</span> <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># volume</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Volume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; VOL=&quot;</span> <span class="o">+</span> <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># importance</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">importance</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">importance</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">Importance</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; IMP:{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span>
                        <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># exp_transform</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_transform</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_transform</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">ExponentialTransform</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; EXT:{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span>
                        <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># forced_coll</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forced_coll</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forced_coll</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">ForcedCollision</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; FCL:{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span>
                        <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># weight_win_bound</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_win_bound</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_win_bound</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">WeightWindowBound</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; WWN({0},{1}):{2}={3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span>
                        <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="c"># dxtran_contrib</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxtran_contrib</span><span class="p">:</span>
            <span class="n">dxtran_contrib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dxtran_contrib</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dxtran_contrib</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">DXTRANContribution</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; DXC{0!r}:{1}={2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> 
                        <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span>
                        <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># photon_weight</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">photon_weight</span><span class="p">:</span>
            <span class="c"># TODO this might cause issues.</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">PhotonWeight</span><span class="p">()</span>
            <span class="n">card</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">photon_weight</span><span class="p">))</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; PWT={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># fission_turnoff</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fission_turnoff</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">FissionTurnoff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fission_turnoff</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; NONU={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># det_contrib</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">det_contrib</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">det_contrib</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">DetectorContribution</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; PD for tally {0!r}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># transform</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">:</span>
            <span class="c"># For brevity.</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; TRCL &quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="s">&#39;temp&#39;</span><span class="p">,</span> <span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">card</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># user_custom</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; and user&#39;s custom input&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellMCNP</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="c"># temperature</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; TMP={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># volume</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">Volume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; VOL={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># importance</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">importance</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">importance</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">Importance</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; IMP:{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># exp_transform</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_transform</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_transform</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">ExponentialTransform</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; EXT:{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># forced_coll</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forced_coll</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forced_coll</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">ForcedCollision</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; FCL:{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># weight_win_bound</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_win_bound</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_win_bound</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">WeightWindowBound</span><span class="p">(</span>
                        <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="c"># Need the next line to obtain the linear index.</span>
                <span class="n">card</span><span class="o">.</span><span class="n">_find_n_energies</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; WWN{0}:{1}={2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">i_linear</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                        <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                            <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="c"># dxtran_contrib</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxtran_contrib</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dxtran_contrib</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">DXTRANContribution</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="n">entry</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; DXC{0}:{1}={2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">sph_index</span><span class="p">(</span><span class="n">sim</span><span class="p">),</span> <span class="n">Particle</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(),</span> 
                        <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># photon_weight</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">photon_weight</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">PhotonWeight</span><span class="p">()</span>
            <span class="n">card</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">photon_weight</span><span class="p">))</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; PWT={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fission_turnoff</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">FissionTurnoff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fission_turnoff</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; NONU={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># det_contrib</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">det_contrib</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">det_contrib</span><span class="p">):</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">DetectorContribution</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; PD{0}={1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">sim</span><span class="o">.</span><span class="n">tally_num</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span>
                    <span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="c"># transform</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">:</span>
            <span class="c"># For brevity.</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;TRCL={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">transformation_num</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">entry</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;*&quot;</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="s">&#39;temp&#39;</span><span class="p">,</span> <span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">entry</span><span class="p">))</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;TRCL ({0})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">))</span>
        <span class="c"># user_custom</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>
                
    <span class="k">def</span> <span class="nf">_make_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span> <span class="k">return</span> <span class="n">arg</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">arg</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span>

    <span class="nd">@temperature.setter</span>
    <span class="k">def</span> <span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_volume</span>

    <span class="nd">@volume.setter</span>
    <span class="k">def</span> <span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_volume</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">importance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_importance</span>

    <span class="nd">@importance.setter</span>
    <span class="k">def</span> <span class="nf">importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_importance</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exp_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp_transform</span>

    <span class="nd">@exp_transform.setter</span>
    <span class="k">def</span> <span class="nf">exp_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp_transform</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">forced_coll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forced_coll</span>

    <span class="nd">@forced_coll.setter</span>
    <span class="k">def</span> <span class="nf">forced_coll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forced_coll</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">weight_win_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weight_win_bound</span>

    <span class="nd">@weight_win_bound.setter</span>
    <span class="k">def</span> <span class="nf">weight_win_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weight_win_bound</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dxtran_contrib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dxtran_contrib</span>

    <span class="nd">@dxtran_contrib.setter</span>
    <span class="k">def</span> <span class="nf">dxtran_contrib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dxtran_contrib</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">photon_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_photon_weight</span>
    
    <span class="nd">@photon_weight.setter</span>
    <span class="k">def</span> <span class="nf">photon_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Photon weight keyword argument must be a tuple.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_photon_weight</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fission_turnoff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fission_turnoff</span>
    
    <span class="nd">@fission_turnoff.setter</span>
    <span class="k">def</span> <span class="nf">fission_turnoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fission_turnoff</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">det_contrib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_det_contrib</span>
    
    <span class="nd">@det_contrib.setter</span>
    <span class="k">def</span> <span class="nf">det_contrib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_det_contrib</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformation</span>
    
    <span class="nd">@transformation.setter</span>
    <span class="k">def</span> <span class="nf">transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformation</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_custom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_custom</span>
    
    <span class="nd">@user_custom.setter</span>
    <span class="k">def</span> <span class="nf">user_custom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_custom</span> <span class="o">=</span> <span class="n">value</span>
    
</div>
<div class="viewcode-block" id="IUniverse"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IUniverse">[docs]</a><span class="k">class</span> <span class="nc">IUniverse</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for all</span>
<span class="sd">    universe cards.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO</span>
    <span class="c"># Ideally universes would be their own objects.</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span>

</div>
<div class="viewcode-block" id="UniverseByRegion"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.UniverseByRegion">[docs]</a><span class="k">class</span> <span class="nc">UniverseByRegion</span><span class="p">(</span><span class="n">IUniverse</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented. Use cell card keywords.&quot;&quot;&quot;</span>
    <span class="c"># TODO</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
        <span class="k">pass</span>

</div>
<div class="viewcode-block" id="UniverseByLattice"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.UniverseByLattice">[docs]</a><span class="k">class</span> <span class="nc">UniverseByLattice</span><span class="p">(</span><span class="n">IUniverse</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented. Use cell card keywords.&quot;&quot;&quot;</span>
    <span class="c"># TODO</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lattice</span><span class="p">):</span>
        <span class="k">pass</span>

</div>
<span class="k">class</span> <span class="nc">Lattice</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented. Use cell card keywords.&quot;&quot;&quot;</span>
    <span class="c"># TODO</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">universe</span><span class="p">):</span>
        <span class="k">pass</span>


<div class="viewcode-block" id="LatticeByArray"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.LatticeByArray">[docs]</a><span class="k">class</span> <span class="nc">LatticeByArray</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented. Use cell card keywords.&quot;&quot;&quot;</span>
    <span class="c"># TODO</span>
    <span class="c"># TODO support of 3D arrays.</span>
    <span class="k">def</span> <span class="nf">__init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">geom</span><span class="p">,</span> <span class="n">xindices</span><span class="p">,</span> <span class="n">yindices</span><span class="p">,</span> <span class="n">zindices</span><span class="p">,</span>
               <span class="n">universe_array</span><span class="p">):</span>
        <span class="k">pass</span>
        
</div>
<div class="viewcode-block" id="Material"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Material">[docs]</a><span class="k">class</span> <span class="nc">Material</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;In MCNP, this is the **M** card.</span>
<span class="sd">    Adds the attributes</span>
<span class="sd">    :py:attr:`description`, :py:attr:`tables` and the methods</span>
<span class="sd">    :py:meth:`comment` and :py:meth:`mcnp` to</span>
<span class="sd">    :py:class:`pyne.material.Material`. The :py:attr:`name` must be provided</span>
<span class="sd">    before the card is added to a system. The user can specify a description</span>
<span class="sd">    that is printed in an appropriate location in the input file.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Material</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tables</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:class:`pyne.material.Material` for superclass parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mat : pyne.material.Material</span>
<span class="sd">            Material to base this card on.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Must either be present in mat.attrs or supplied here.</span>
<span class="sd">        description : str, optional</span>
<span class="sd">            A description of this material that perhaps explains where the</span>
<span class="sd">            material came from (whether it&#39;s recycled, any references, etc.).</span>
<span class="sd">            If not supplied here, may be present in mat.attrs.</span>
<span class="sd">        tables : dict of (nucname, str) pairs</span>
<span class="sd">            Sometimes it is necessary to specify a library/table identifier for</span>
<span class="sd">            a given nuclide. These can be provided in this dictionary. Leave</span>
<span class="sd">            out the period. If not supplied here, may be present in mat.attrs.  </span>
<span class="sd">            See examples.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The usage of this card is meant to ensure that only valid instances of</span>
<span class="sd">        :py:class:`pyne.material.Material` are used as cards.  Additionally, </span>
<span class="sd">        there are two new methods::</span>

<span class="sd">            originstory = &quot;I found this water in a well a few years ago.&quot;</span>
<span class="sd">            h2o = Material(pyne.material.from_atom_frac({10010: 2.0, &#39;O16&#39;: 1.0}),</span>
<span class="sd">                           name=&#39;water&#39;, description=originstory)</span>
<span class="sd">            h2o.tables = {10010: &#39;71c&#39;}</span>
<span class="sd">            sys.add_material(h2o)</span>

<span class="sd">        Alternatively, the tables can be specified with the constructor::</span>

<span class="sd">            h2o = Material(pyne.material.from_atom_frac({10010: 2.0, &#39;O16&#39;: 1.0}),</span>
<span class="sd">                           name=&#39;water&#39;, tables={10010: &#39;71c&#39;})</span>

<span class="sd">        The ``nucname``&#39;s used for ``tables`` can be different from those used</span>
<span class="sd">        for ``comp``::</span>

<span class="sd">            h2o = Material(pyne.material.from_atom_frac({10010: 2.0, &#39;O16&#39;: 1.0}),</span>
<span class="sd">                           name=&#39;water&#39;, tables={&#39;H1&#39;: &#39;71c&#39;})</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span>  <span class="n">mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span> <span class="o">=</span> <span class="n">mat</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Material</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                                       <span class="n">tables</span><span class="o">=</span><span class="n">tables</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">tables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span>
        <span class="c"># Find longest table ID. Used in card printing for prettiness.</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The ``name`` property of the material cannot be empty.&quot;</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;Material {0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;.&quot;</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;M{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">material_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">den</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">to_atom_frac</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c"># ZAID.</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">     {: 6d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nucname</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">nuc</span><span class="p">))</span>
            <span class="c"># Table ID. Loop allows flexible keys for tables.</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span> 
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nucname</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="n">nucname</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">nuc</span><span class="p">):</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot;.{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
                <span class="c"># +1 for he decimal point.</span>
                <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_table_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="s">&quot; &quot;</span>
            <span class="c"># Concentration/density.</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">float_format</span> <span class="o">%</span> <span class="n">den</span>
            <span class="c"># Nuclide name.</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">&quot; $ {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nucname</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">nuc</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span>

    <span class="nd">@mat.setter</span>
    <span class="k">def</span> <span class="nf">mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">_validate_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="s">&#39;tables&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_max_table_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;tables&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_max_table_len</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>

    <span class="nd">@name.setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">_validate_name</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">&#39;description&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span>

    <span class="nd">@description.setter</span>
    <span class="k">def</span> <span class="nf">description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">&#39;tables&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;tables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;tables&#39;</span><span class="p">]</span>

    <span class="nd">@tables.setter</span>
    <span class="k">def</span> <span class="nf">tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;tables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_table_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>

</div>
<div class="viewcode-block" id="MaterialMCNP"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.MaterialMCNP">[docs]</a><span class="k">class</span> <span class="nc">MaterialMCNP</span><span class="p">(</span><span class="n">Material</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented; would automate the selection of table identifiers. &quot;&quot;&quot;</span>
    <span class="c"># TODO</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="ISurface"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ISurface">[docs]</a><span class="k">class</span> <span class="nc">ISurface</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for all</span>
<span class="sd">    surface cards.</span>

<span class="sd">    The Surface superclass contains properties to set the surface as reflecting</span>
<span class="sd">    or white. For codes other than MCNPX, reflecting or white surfaces may be</span>
<span class="sd">    specified on a separate boundary condition card (i.e. in Serpent) or may</span>
<span class="sd">    not even be available. For other codes, then, the appropriate</span>
<span class="sd">    :py:mod:`inputfile` class needs to pick up this information and print the</span>
<span class="sd">    appropriate string to the code&#39;s input file, or in the latter case return</span>
<span class="sd">    an exception.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.ISurface</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO support rotation.</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reflecting</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">white</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        reflecting : bool, optional</span>
<span class="sd">            The surface has a reflective boundary condition.</span>
<span class="sd">        white : bool, optional</span>
<span class="sd">            The surface has a white boundary condition (reflection with a</span>
<span class="sd">            cosine distribution with respect to the surface normal).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ISurface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reflecting</span> <span class="o">=</span> <span class="n">reflecting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">white</span> <span class="o">=</span> <span class="n">white</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflecting</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">white</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The user set the surface to be reflecting AND &quot;</span>
                    <span class="s">&quot;white, but can only be neither or one of the two.&quot;</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0} {1!r}:{2}{3} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                <span class="s">&quot; reflecting.&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflecting</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot; white.&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">white</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">keystring</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surfaces</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;Surface {0!r} not in simulation.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;{0}{1}{{: &lt;{2}d}} {3:&lt;4}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s">&quot;*&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reflecting</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot;+&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">white</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surfaces</span><span class="p">)))</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> \
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reflecting</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">white</span><span class="p">),</span>
                <span class="n">keystring</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surface_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<div class="viewcode-block" id="ISurface.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ISurface.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Translates the surface. This is an abstract method, and must be</span>
<span class="sd">        defined by each surface card. Shifts may not be permitted for all</span>
<span class="sd">        surfaces in all directions, and in such cases an exception is raised.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vector : 3-element list or :py:class:`np.array`, float [centimeters]</span>
<span class="sd">            The elements specify translation in the x, y, and z directions, </span>
<span class="sd">            in this order.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Both of the following lines shifts the surface along the x axis by 3 cm::</span>

<span class="sd">            surf.shift([3, 0, 0])</span>
<span class="sd">            surf.shift(np.array([3, 0, 0]))</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;Shifting not implemented for &quot;</span>
                <span class="s">&quot;{0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="ISurface.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ISurface.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stretches (scales) the surface from the origin. This is an abstract</span>
<span class="sd">        method, and must be defined by each surface card. Stretches may not be</span>
<span class="sd">        permitted for all surfaces in all directions, and in such cases an</span>
<span class="sd">        exception is raised.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vector : 3-element list or :py:class:`np.array`, float [unitless]</span>
<span class="sd">            The elements specify a stretch in the x, y, and z directions, in</span>
<span class="sd">            this order. A zero in any of the directions indicates that no</span>
<span class="sd">            stretch is done in that direction. Negative values are allowed, and</span>
<span class="sd">            represent reflections.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Both of the following lines stretch the surface along the y axis by a</span>
<span class="sd">        factor of 2. The x and z directions are unaffected::</span>

<span class="sd">            surf.stretch([0, 2, 0])</span>
<span class="sd">            surf.stretch(np.array([0, 2, 0]))</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;Stretching not implemented for &quot;</span>
                <span class="s">&quot;{0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="ISurface.neg"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ISurface.neg">[docs]</a>    <span class="k">def</span> <span class="nf">neg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A property that creates and returns a</span>
<span class="sd">        :py:class:`RegionLeaf` that can then be used in</span>
<span class="sd">        boolean arithmetic with subclasses of</span>
<span class="sd">        :py:class:`Region`. The region is define as the</span>
<span class="sd">        space on the side of the surface that has a negative sense.</span>

<span class="sd">        In the expected typical usage of the :py:mod:`pyne.simplesim` package,</span>
<span class="sd">        regions are constructed using these properties.</span>

<span class="sd">        For more information, see :py:class:`Region` and</span>
<span class="sd">        :ref:`usersguide_simplesim`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following shows a simple case of how a more complex region can be</span>
<span class="sd">        constructed from regions returned by this property::</span>

<span class="sd">            reg1 = surf1.neg</span>
<span class="sd">            reg2 = surf2.neg</span>
<span class="sd">            reg3 = reg1 &amp; reg2</span>
<span class="sd">            reg4 = reg1 | reg2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RegionLeaf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="ISurface.pos"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ISurface.pos">[docs]</a>    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Similar to :py:attr:`neg`, except the resulting</span>
<span class="sd">        :py:class:`RegionLeaf` is on the side of the surface with a positive</span>
<span class="sd">        sense.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following shows a simple case of how a more complex region can be</span>
<span class="sd">        constructed from regions returned by this property::</span>

<span class="sd">            reg1 = surf1.pos</span>
<span class="sd">            reg2 = surf2.pos</span>
<span class="sd">            reg3 = reg1 &amp; reg2</span>
<span class="sd">            reg4 = reg1 | reg2</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RegionLeaf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    </div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reflecting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reflecting</span>

    <span class="nd">@reflecting.setter</span>
    <span class="k">def</span> <span class="nf">reflecting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;The property ``reflecting`` must be of &quot;</span>
                    <span class="s">&quot;boolean type. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reflecting</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">white</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_white</span>

    <span class="nd">@white.setter</span>
    <span class="k">def</span> <span class="nf">white</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;The property ``white`` must be of &quot;</span>
                    <span class="s">&quot;boolean type. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_white</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="IAxisSurface"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IAxisSurface">[docs]</a><span class="k">class</span> <span class="nc">IAxisSurface</span><span class="p">(</span><span class="n">ISurface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for all simple</span>
<span class="sd">    axis-aligned surfaces. Accordingly, such classes share the cartesian_axis</span>
<span class="sd">    property.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.IAxisSurface</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cartesian_axis</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        cartesian_axis : str</span>
<span class="sd">            Either &#39;x&#39;, &#39;X&#39;, &#39;y&#39;, &#39;Y&#39;, &#39;z&#39;, or &#39;Z&#39;. Regardless of input, it is</span>
<span class="sd">            stored as lower-case. The meaning depends on the surface.</span>
<span class="sd">        reflecting : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`</span>
<span class="sd">        white : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IAxisSurface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">=</span> <span class="n">cartesian_axis</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IAxisSurface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IAxisSurface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    
    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="IAxisSurface.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IAxisSurface.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.shift`.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="IAxisSurface.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IAxisSurface.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.stretch`.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cartesian_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cartesian_axis</span>

    <span class="nd">@cartesian_axis.setter</span>
    <span class="k">def</span> <span class="nf">cartesian_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;AxisCylinder&#39;s cartesian_axis property must be &quot;</span>
                    <span class="s">&quot;a string. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;x&#39;</span> <span class="ow">and</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;y&#39;</span> <span class="ow">and</span> 
                <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;z&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;AxisCylinder&#39;s cartesian_axis property must be &quot;</span>
                    <span class="s">&quot;&#39;x&#39;, &#39;X&#39;, &#39;y&#39;, &#39;Y&#39;, or &#39;z&#39;, &#39;Z&#39;. &quot;</span>
                    <span class="s">&quot;User provided &#39;{0}&#39;.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cartesian_axis</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="AxisCylinder"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.AxisCylinder">[docs]</a><span class="k">class</span> <span class="nc">AxisCylinder</span><span class="p">(</span><span class="n">IAxisSurface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cylinder aligned with and centered on one of the Cartesian axes.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.AxisCylinder</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># TODO if this is shifted, then it becomes not an axis-cylinder.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cartesian_axis</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        cartesian_axis : str</span>
<span class="sd">            The axis with which the cylinder is aligned and centered.</span>
<span class="sd">            See :py:class:`IAxisSurface`.</span>
<span class="sd">        radius : float [centimeters]</span>
<span class="sd">            Radius of the cylinder.</span>
<span class="sd">        reflecting : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`</span>
<span class="sd">        white : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following creates a cylinder aligned with the z axis, going through</span>
<span class="sd">        centered on the z axis, with a radius of 0.4 cm::</span>

<span class="sd">            cyl = AxisCylinder(&#39;mycyl&#39;, &#39;z&#39;, 0.4)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AxisCylinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cartesian_axis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AxisCylinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Axis cylinder&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;aligned and centered on {0} axis, &quot;</span>
                <span class="s">&quot;with radius {1:g} cm (diameter {2:g} cm).&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AxisCylinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot;C{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>
        <span class="k">return</span> <span class="n">string</span>
    
<div class="viewcode-block" id="AxisCylinder.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.AxisCylinder.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.shift`. Axis cylinders can only be shifted along</span>
<span class="sd">        their axis, and even in such cases the shift has no effect. However,</span>
<span class="sd">        such a shift must be permitted in case this surface is part of a region</span>
<span class="sd">        that is being shifted.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following is okay (where we have imported :py:mod:`numpy` as ``np``)::</span>

<span class="sd">            cyl = AxisCylinder(&#39;mycyl&#39;, &#39;z&#39;, 0.4)</span>
<span class="sd">            cyl.shift([0, 0, 3])</span>
<span class="sd">            cyl.shift(np.array([0, 0, 3]))</span>

<span class="sd">        The following do not work:</span>

<span class="sd">            cyl.shift([3, 0, 0])</span>
<span class="sd">            cyl.shift([0, 3, 3])</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Flag for exception.</span>
        <span class="n">iserror</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;x&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">iserror</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">dirs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;y&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">iserror</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">dirs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;z&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">iserror</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">dirs</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iserror</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;A cylinder aligned with the {0[0]} axis cannot &quot;</span>
                    <span class="s">&quot;be shifted in the {0[1]} or {0[2]} directions.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">dirs</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="AxisCylinder.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.AxisCylinder.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface:stretch`. Axis cylinders can be stretched in</span>
<span class="sd">        the direction of their axis, which has no effect (permitted in case</span>
<span class="sd">        this surface is part of a region that is being stretched), or can be</span>
<span class="sd">        stretched `uniformly` in the plane perpendicular to its axis.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following stretches are okay for a cylinder aligned with the x axis</span>
<span class="sd">        (where we have imported :py:mod:`numpy` as ``np``)::</span>
<span class="sd">            </span>
<span class="sd">            cyl = AxisCylinder(&#39;mycyl&#39;, &#39;z&#39;, 0.4)</span>
<span class="sd">            cyl.stretch([0, 0, 2])</span>
<span class="sd">            cyl.stretch([3, 3, 0])</span>
<span class="sd">            cyl.stretch(np.array([3, 3, 2]))</span>

<span class="sd">        However, the following would cause the cylinder to lose its</span>
<span class="sd">        circular cross section, which cannot be accommodated::</span>

<span class="sd">            cyl.stretch([0, 3, 0])</span>
<span class="sd">            cyl.stretch([2, 3, 1])</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># TODO allow some slop between the same two values for a uniform</span>
        <span class="c"># perpendicular stretch.</span>
        <span class="c"># Flag for exception.</span>
        <span class="n">iserror</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c"># &#39;out&#39; is used in the exception below.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;x&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="n">iserror</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;x&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="n">iserror</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;y&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;z&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">iserror</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;z&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">iserror</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Stretches perpendicular to the axis must be &quot;</span>
                    <span class="s">&quot;uniform in the two perpendicular directions. User &quot;</span>
                    <span class="s">&quot;provided {0[0]} stretch {0[1]:g} and {0[2]} stretch &quot;</span>
                    <span class="s">&quot;{0[3]:g} for a {0[4]}-aligned cylinder.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>

    <span class="nd">@radius.setter</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The ``radius`` property must be &quot;</span>
                    <span class="s">&quot;positive. User provided {0:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="AxisPlane"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.AxisPlane">[docs]</a><span class="k">class</span> <span class="nc">AxisPlane</span><span class="p">(</span><span class="n">IAxisSurface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plane perpendicular to one of the Cartesian axes.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.AxisPlane</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cartesian_axis</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        cartesian_axis : str</span>
<span class="sd">            The axis to which the plane is perpendicular.</span>
<span class="sd">            See :py:class:`IAxisSurface`.</span>
<span class="sd">        position : float [centimeters]</span>
<span class="sd">            Position of the plane along :py:attr:`cartesian_axis`.</span>
<span class="sd">        reflecting : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`</span>
<span class="sd">        white : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following creates a plane perpendicular to the x axis, 3 cm along</span>
<span class="sd">        the positive x axis with a reflecting boundary condition::</span>

<span class="sd">           plane = AxisPlane(&#39;myplane&#39;, &#39;x&#39;, 3, reflecting=True) </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AxisPlane</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cartesian_axis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
    
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AxisPlane</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Axis plane&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;{0} = {1:g} cm.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">AxisPlane</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot;P{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
        <span class="k">return</span> <span class="n">string</span>

<div class="viewcode-block" id="AxisPlane.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.AxisPlane.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.shift`. Axis planes can be shifted in any</span>
<span class="sd">        direction, but only shifts along their axis have an effect.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following has the effect of shifting the plane&#39;s position to x = 6</span>
<span class="sd">        cm::</span>

<span class="sd">           plane = AxisPlane(&#39;myplane&#39;, &#39;x&#39;, 3)</span>
<span class="sd">           plane.shift([3, 0, 0])</span>

<span class="sd">        The following has no effect, but is allowed::</span>

<span class="sd">           plane.shift([0, 3, 2])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;x&#39;</span><span class="p">:</span>   <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;z&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="AxisPlane.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.AxisPlane.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.stretch`. Axis planes can be stretched in any</span>
<span class="sd">        direction, but only stretches along their axis have an effect. The</span>
<span class="sd">        position of the plane is scaled by the stretch factor.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following has the effect of moving the plane&#39;s position to x = 9 cm::</span>

<span class="sd">            plane = AxisPlane(&#39;myplane&#39;, &#39;x&#39;, 3)</span>
<span class="sd">            plane.stretch([3, 0, 0])</span>
<span class="sd">        </span>
<span class="sd">        The following has no effect, but is allowed::</span>

<span class="sd">            plane.stretch([0, 3, 2])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;x&#39;</span> <span class="ow">and</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;y&#39;</span> <span class="ow">and</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">==</span> <span class="s">&#39;z&#39;</span> <span class="ow">and</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>

    <span class="nd">@position.setter</span>
    <span class="k">def</span> <span class="nf">position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="IMacrobody"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IMacrobody">[docs]</a><span class="k">class</span> <span class="nc">IMacrobody</span><span class="p">(</span><span class="n">ISurface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for all</span>
<span class="sd">    macrobody cards. Macrobodies are an MCNP concept. The classes here account</span>
<span class="sd">    for the notion of facets.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.IMacrobody</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="c"># TODO abstract method for obtaining &quot;sub&quot;-surfaces. This is one reason why</span>
    <span class="c"># you&#39;d pass objects rather than just object names around: I could pass</span>
    <span class="c"># IMacrobody.top, etc.</span>
    <span class="c"># TODO facets are not functional because they have the same name as their</span>
    <span class="c"># macrobody, so when the System Definition looks it up, it only finds the</span>
    <span class="c"># macrobody and not the facet. I don&#39;t know how to solve this yet.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IMacrobody</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IMacrobody</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">IMacrobody</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="IMacrobody.facet"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IMacrobody.facet">[docs]</a>    <span class="k">def</span> <span class="nf">facet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        facet : :py:class:`Facet`</span>
<span class="sd">            The facet can be used as a normal surface, though logically there</span>
<span class="sd">            is no MCNP surface card for just a facet. The facet can be used in</span>
<span class="sd">            constructing a :py:class:`IRegion`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;Facets not implemented for {0!r}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">))</span>

</div></div>
<div class="viewcode-block" id="Facet"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Facet">[docs]</a><span class="k">class</span> <span class="nc">Facet</span><span class="p">(</span><span class="n">ISurface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Used in conjunction with macrobodies. See</span>
<span class="sd">    :py:meth:`pyne.simplesim.definition.SystemDefinition.surface_num` to see</span>
<span class="sd">    how the appropriate surface number is obtained. The name of the surface is</span>
<span class="sd">    the same as that of the macrobody.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO ideally we would dynamically subclass this using whatever class</span>
    <span class="c"># surface is.</span>
    <span class="c"># TODO facets do not work right now because they have the same name as an</span>
    <span class="c"># already-existant surface.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">macrobody</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The user does not use this constructor. The user creates facets</span>
<span class="sd">        using :py:meth:`IMacrobody.facet`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Facets are not implemented properly yet.&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Facet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">macrobody</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrobody</span> <span class="o">=</span> <span class="n">macrobody</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">descriptor</span> <span class="o">=</span> <span class="n">descriptor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0}. facet {0!r}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">macrobody</span><span class="o">.</span><span class="n">comment</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">descriptor</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;There is no notion of a facet surface card.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrobody</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrobody</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Parallelepiped"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Parallelepiped">[docs]</a><span class="k">class</span> <span class="nc">Parallelepiped</span><span class="p">(</span><span class="n">IMacrobody</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rectangular parallelepiped in which all surfaces are parallel to the</span>
<span class="sd">    cartesian axes.</span>

<span class="sd">    .. inheritance-diagram::pyne.simplesim.cards.Parallelepiped</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">facets</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;east&#39;</span>  <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="s">&#39;west&#39;</span>  <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
              <span class="s">&#39;north&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
              <span class="s">&#39;south&#39;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
              <span class="s">&#39;top&#39;</span>   <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
              <span class="s">&#39;bottom&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        xmin, xmax, ymin, ymax, zmin, zmax : float [centimeters]</span>
<span class="sd">            Bounds of the parallelepiped in the given direction. The min value</span>
<span class="sd">            must be less than the max value. Setting both min and max in a</span>
<span class="sd">            given direction to 0 indicates the parallelepiped is infinite in</span>
<span class="sd">            that direction.</span>
<span class="sd">        reflecting : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`.</span>
<span class="sd">        white : bool, optional</span>
<span class="sd">            See :py:class:`ISurface`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following creates a cube centered at the origin with 4 cm sides::</span>

<span class="sd">            pp = Parallelepiped(&#39;mypp&#39;, -2, 2, -2, 2, -2, 2)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Parallelepiped</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zlims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Parallelepiped</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Parallelepiped&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;[{0[0]:g}, {0[1]:g}] x &quot;</span>
                <span class="s">&quot;[{1[0]:g}, {1[1]:g}] x [{2[0]:g}, {2[1]:g}] cm.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">xlims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zlims</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Parallelepiped</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;RPP&quot;</span><span class="p">)</span>
        <span class="n">formatstr</span> <span class="o">=</span>  <span class="s">&quot;{0} {0}  {0} {0}  {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlims</span><span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ylims</span><span class="p">)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zlims</span><span class="p">))</span>

<div class="viewcode-block" id="Parallelepiped.facet"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Parallelepiped.facet">[docs]</a>    <span class="k">def</span> <span class="nf">facet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`IMacrobody.facet`.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        descriptor : str</span>
<span class="sd">            One of the following:</span>

<span class="sd">            - &#39;east&#39;: x = xmax plane</span>
<span class="sd">            - &#39;west&#39;: x = xmin plane</span>
<span class="sd">            - &#39;north&#39;: y = ymax plane</span>
<span class="sd">            - &#39;south&#39;: y = ymin plane</span>
<span class="sd">            - &#39;top&#39;: z = zmax plane</span>
<span class="sd">            - &#39;bottom&#39;: z = zmin plane</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        facet : :py:class:`Facet`</span>
<span class="sd">            The facet can be used as a normal surface, though logically there</span>
<span class="sd">            is no MCNP surface card for just a facet.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">descriptor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">facets</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Facet descriptor {0!r} unacceptable.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">descriptor</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Facet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">facets</span><span class="p">[</span><span class="n">descriptor</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Parallelepiped.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Parallelepiped.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.shift`.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following::</span>

<span class="sd">            pp = Parallelepiped(&#39;mypp&#39;, -2, 2, -2, 2, -2, 2)</span>
<span class="sd">            pp.shift([2, 0, 0])</span>

<span class="sd">        creates a parallelepiped bounded by [0, 4] x [-2, 2] x [-2, 2].</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlims</span> <span class="o">+=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylims</span> <span class="o">+=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zlims</span> <span class="o">+=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Parallelepiped.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Parallelepiped.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See :py:meth:`ISurface.stretch`. Handling reflections (negative</span>
<span class="sd">        stretch factors) requires additional consideration for this surface,</span>
<span class="sd">        but is implemented.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following::</span>

<span class="sd">            pp = Parallelepiped(&#39;mypp&#39;, 0, 4, -2, 2, -2, 2)</span>
<span class="sd">            pp.stretch([2, 0, 3])</span>

<span class="sd">        creates a parallelepiped bounded by [0, 8] x [-2, 2] x [-6, 6].</span>
<span class="sd">        Consider the reflection of the following parallelepiped</span>
<span class="sd">        about the z axis::</span>
<span class="sd">        </span>
<span class="sd">            pp = Parallelepiped(&#39;mypp&#39;, 0, 4, -2, 2, -3, 6)</span>
<span class="sd">            pp.stretch([0, 0, -1])</span>

<span class="sd">        This results in bounds of [0, 4] x [-2, 2] x [-6, 3].</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlims</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlims</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlims</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c"># Stretch factor is negative, swap limits.</span>
        <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylims</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylims</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylims</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zlims</span> <span class="o">*=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zlims</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">zlims</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xlims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xlims</span>

    <span class="nd">@xlims.setter</span>
    <span class="k">def</span> <span class="nf">xlims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The value of xmin, {0:g}, is greater than &quot;</span>
                    <span class="s">&quot;that of xmax, {1:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xlims</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ylims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ylims</span>

    <span class="nd">@ylims.setter</span>
    <span class="k">def</span> <span class="nf">ylims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The value of ymin, {0:g}, is greater than &quot;</span>
                    <span class="s">&quot;that of ymax, {1:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ylims</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">zlims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zlims</span>

    <span class="nd">@zlims.setter</span>
    <span class="k">def</span> <span class="nf">zlims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The value of zmin, {0:g}, is greater than &quot;</span>
                    <span class="s">&quot;that of zmax, {1:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_zlims</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Cuboid"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Cuboid">[docs]</a><span class="k">class</span> <span class="nc">Cuboid</span><span class="p">(</span><span class="n">Parallelepiped</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Same exact thing as a :py:class:`Parallelepiped`. This class is provided</span>
<span class="sd">    because the name is shorter, and thus may be preferred by those who fancy</span>
<span class="sd">    brevity.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cuboid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IRegion"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegion">[docs]</a><span class="k">class</span> <span class="nc">IRegion</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for</span>
<span class="sd">    all regions. Represents a volume (space) confined by unions and</span>
<span class="sd">    intersections of surfaces.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO transformation functions</span>
    <span class="c"># TODO Complement functionality can be added by overloading the</span>
    <span class="c"># __not__ operator and defining a complement boolean property that is set</span>
    <span class="c"># by the __not__ operator.</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IRegion</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">):</span>
        <span class="c"># TODO deepcopy?</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">RegionLeaf</span><span class="p">):</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">RegionLeaf</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">surface</span><span class="p">,</span> <span class="n">region</span><span class="o">.</span><span class="n">pos_sense</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">RegionOr</span><span class="p">):</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">RegionOr</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">left_child</span><span class="p">,</span> <span class="n">region</span><span class="o">.</span><span class="n">right_child</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">RegionAnd</span><span class="p">):</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">RegionAnd</span><span class="p">(</span><span class="n">region</span><span class="o">.</span><span class="n">left_child</span><span class="p">,</span> <span class="n">region</span><span class="o">.</span><span class="n">right_child</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls :py:meth:`intersect`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls :py:meth:`union`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

<div class="viewcode-block" id="IRegion.intersect"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegion.intersect">[docs]</a>    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        arg : :py:class:`IRegion` subclass</span>
<span class="sd">            The region with which to intersect this region.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        reg : :py:class:`RegionAnd`</span>
<span class="sd">            A region that has been intersected with the input.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RegionAnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRegion.union"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegion.union">[docs]</a>    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        arg : :py:class:`IRegion` subclass</span>
<span class="sd">            The region with which to union this region.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        reg : :py:class:`RegionAnd`</span>
<span class="sd">            A region that has been unioned with the input.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RegionOr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRegion.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegion.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shifts all the surfaces that this region is composed of. Note that</span>
<span class="sd">        the surfaces themselves are modified, and are not copied, so the</span>
<span class="sd">        dimensions of the surfaces in other regions is also modified.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vector : 3-element list or :py:class:`np.array`</span>
<span class="sd">            See :py:class:`ISurface`.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># TODO make copies of the surfaces?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_child</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_child</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IRegion.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegion.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stretches all the surfaces that this region is composed of. Note that</span>
<span class="sd">        the surfaces themselves are modified, and are not copied, so the</span>
<span class="sd">        dimensions of the surfaces in other regions is also modified.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vector : 3-element list or :py:class:`np.array`</span>
<span class="sd">            See :py:class:`ISurface`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># TODO make copies of the surfaces?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_child</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_child</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IRegion.walk"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegion.walk">[docs]</a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leaf_func</span><span class="p">,</span> <span class="n">and_func</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">or_func</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Walks the Region tree, calling ``leaf_func`` if the Region is a</span>
<span class="sd">        ``RegionLeaf``, ``and_func`` if the Region is a ``RegionAnd``, and</span>
<span class="sd">        ``or_func`` if the Region is a ``RegionOr``. This is used in</span>
<span class="sd">        ``pyne.definition`` to discover all surfaces in the Region.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RegionLeaf</span><span class="p">):</span>
            <span class="n">leaf_func</span><span class="o">.</span><span class="n">im_func</span><span class="p">(</span><span class="n">leaf_func</span><span class="o">.</span><span class="n">im_self</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_child</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">leaf_func</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">and_func</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">and_func</span><span class="p">):</span>
                <span class="n">and_func</span><span class="o">.</span><span class="n">im_func</span><span class="p">(</span><span class="n">and_func</span><span class="o">.</span><span class="n">im_self</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">or_func</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">or_func</span><span class="p">):</span>
                <span class="n">or_func</span><span class="o">.</span><span class="n">im_func</span><span class="p">(</span><span class="n">or_func</span><span class="o">.</span><span class="n">im_func</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right_child</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">leaf_func</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="IRegionBool"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegionBool">[docs]</a><span class="k">class</span> <span class="nc">IRegionBool</span><span class="p">(</span><span class="n">IRegion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for</span>
<span class="sd">    :py:class:`RegionAnd` and :py:class:`RegionOr`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_child</span><span class="p">,</span> <span class="n">right_child</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&lt;Empty&gt;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IRegionBool</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_child</span> <span class="o">=</span> <span class="n">left_child</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right_child</span> <span class="o">=</span> <span class="n">right_child</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">midchar</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_child</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">midchar</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">right_child</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">midchar</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_child</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span> <span class="o">+</span> <span class="n">midchar</span> <span class="o">+</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">right_child</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">left_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Left child&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_left_child</span>

    <span class="nd">@left_child.setter</span>
<div class="viewcode-block" id="IRegionBool.left_child"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegionBool.left_child">[docs]</a>    <span class="k">def</span> <span class="nf">left_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_left_child</span> <span class="o">=</span> <span class="n">value</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">right_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Right child.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right_child</span>

    <span class="nd">@right_child.setter</span>
<div class="viewcode-block" id="IRegionBool.right_child"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IRegionBool.right_child">[docs]</a>    <span class="k">def</span> <span class="nf">right_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_right_child</span> <span class="o">=</span> <span class="n">value</span>

</div></div>
<div class="viewcode-block" id="RegionAnd"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RegionAnd">[docs]</a><span class="k">class</span> <span class="nc">RegionAnd</span><span class="p">(</span><span class="n">IRegionBool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The intersection of two regions, held in :py:attr:`left_child` and</span>
<span class="sd">    :py:attr:`right_child`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RegionAnd</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&#39;&amp;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RegionAnd</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RegionOr"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RegionOr">[docs]</a><span class="k">class</span> <span class="nc">RegionOr</span><span class="p">(</span><span class="n">IRegionBool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The union of two regions, held in :py:attr:`left_child` and</span>
<span class="sd">    :py:attr:`right_child`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RegionOr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&#39;|&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RegionOr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="RegionLeaf"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RegionLeaf">[docs]</a><span class="k">class</span> <span class="nc">RegionLeaf</span><span class="p">(</span><span class="n">IRegion</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The region of space to one side of a surface (constructed by calling</span>
<span class="sd">    :py:attr:`ISurface.neg` or :py:attr:`ISurface.pos`).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">pos_sense</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&lt;Empty&gt;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        surface : :py:class:`ISurface` subclass</span>
<span class="sd">            The surface that defines the edge of this region.</span>
<span class="sd">        pos_sense : bool</span>
<span class="sd">            True if this region is on the side of the surface with a positive</span>
<span class="sd">            sense, False otherwise.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            The name of this surface. Currently, it is not really needed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RegionLeaf</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface</span> <span class="o">=</span> <span class="n">surface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_sense</span> <span class="o">=</span> <span class="n">pos_sense</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_sense</span><span class="p">:</span>  <span class="n">prefix</span> <span class="o">=</span> <span class="s">&#39;+&#39;</span>
        <span class="k">else</span><span class="p">:</span>               <span class="n">prefix</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span>
        <span class="k">return</span> <span class="n">prefix</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_sense</span><span class="p">:</span>  <span class="n">prefix</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>               <span class="n">prefix</span> <span class="o">=</span> <span class="s">&#39;-&#39;</span>
        <span class="k">return</span> <span class="s">&quot;{0}{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surface_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<div class="viewcode-block" id="RegionLeaf.shift"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RegionLeaf.shift">[docs]</a>    <span class="k">def</span> <span class="nf">shift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls the shift method of the surface.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="RegionLeaf.stretch"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RegionLeaf.stretch">[docs]</a>    <span class="k">def</span> <span class="nf">stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calls the stretch method of the surface.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">stretch</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface</span>

    <span class="nd">@surface.setter</span>
    <span class="k">def</span> <span class="nf">surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_surface</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pos_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pos_sense</span>

    <span class="nd">@pos_sense.setter</span>
    <span class="k">def</span> <span class="nf">pos_sense</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c"># TODO this is probably not okay by the proponents of duck typing.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;User provided a value for pos_sense that is &quot;</span>
                    <span class="s">&quot;not of boolean type.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pos_sense</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="IMisc"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IMisc">[docs]</a><span class="k">class</span> <span class="nc">IMisc</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for unnumbered</span>
<span class="sd">    cards that do not fit in other categories.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IMisc</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

</div>
<div class="viewcode-block" id="ScatteringLaw"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ScatteringLaw">[docs]</a><span class="k">class</span> <span class="nc">ScatteringLaw</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Scattering law for a material. Unique card for a given material, with</span>
<span class="sd">    name `scatlaw-&lt;matname&gt;`. In MCNP, this is the **MT** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.ScatteringLaw</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat_name</span><span class="p">,</span> <span class="n">libraries</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mat_name : str</span>
<span class="sd">            Name of the material for which this card applies.</span>
<span class="sd">        libraries : dict of :py:class:`nucname`: str pairs</span>
<span class="sd">            The keys are the nuclides on the material for which a library is</span>
<span class="sd">            being provided, and the values are the appropriate library</span>
<span class="sd">            identifiers as strings.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        This specifies hydrogen bound in water, in MCNP::</span>

<span class="sd">           h2o = Material(name=&#39;water&#39;)</span>
<span class="sd">           h2o.from_atom_frac({10010: 2.0, &#39;O16&#39;: 1.0})</span>
<span class="sd">           sys.add_material(h2o)</span>
<span class="sd">           sl = ScatteringLaw(&#39;water&#39;, {&#39;H1&#39;: &#39;lwtr.16t&#39;})</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ScatteringLaw</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;scatlaw-{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mat_name</span><span class="p">),</span>
                <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_name</span> <span class="o">=</span> <span class="n">mat_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">libraries</span> <span class="o">=</span> <span class="n">libraries</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Scattering law {0!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">lib</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">libraries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}: {1},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nucname</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">nuc</span><span class="p">),</span> <span class="n">lib</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;MT{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">material_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_name</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">nuc</span><span class="p">,</span> <span class="n">lib</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">libraries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_libraries</span>

    <span class="nd">@libraries.setter</span>
    <span class="k">def</span> <span class="nf">libraries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_libraries</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ISource"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ISource">[docs]</a><span class="k">class</span> <span class="nc">ISource</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for all source</span>
<span class="sd">    cards.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ISource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

</div>
<div class="viewcode-block" id="GeneralSource"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.GeneralSource">[docs]</a><span class="k">class</span> <span class="nc">GeneralSource</span><span class="p">(</span><span class="n">ISource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A general source. Unique with name `gensource`. In MCNP, this is the</span>
<span class="sd">    **SDEF** card. See the respective code (e.g. MCNP) for the default behavior</span>
<span class="sd">    of the arguments. Note that the x, y, and z coordinates of the</span>
<span class="sd">    source are separate inputs because they might each be on their own</span>
<span class="sd">    distributions. To learn about Python keyword arguments, visit</span>
<span class="sd">    `the Python docs</span>
<span class="sd">    &lt;docs.python.org/tutorial/controlflow.html#keyword-arguments&gt;`_. Each</span>
<span class="sd">    keyword argument is also an attribute of this class, and can be modified</span>
<span class="sd">    individually after the card is created::</span>

<span class="sd">        src = GeneralSource()</span>
<span class="sd">        src.cell = &#39;fuel&#39;</span>

<span class="sd">    A source is added to a simulation as follows::</span>
<span class="sd">        </span>
<span class="sd">        sys = definition.SystemDefinition()</span>
<span class="sd">        ...</span>
<span class="sd">        sim = definition.MCNPSimulation(sys)</span>
<span class="sd">        sim.add_source(src)</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.GeneralSource</span>

<span class="sd">    Limitations:</span>

<span class="sd">    - Keyword cannot depend on other keywords, as they can in MCNP.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO non-ambiguous names required.</span>
    <span class="c"># TODO cell card for repeated structures is not simple.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">keyword_args</span><span class="p">):</span>
        <span class="c"># Using &#39;keyword_args&#39; instead of &#39;kwargs&#39; to help PyNovices.</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str, int, :py:class:`Distribution` name, optional (default: None)</span>
<span class="sd">            Name of a particle, &#39;spont-fiss-by-neut&#39;, &#39;spont-fiss-by-hist&#39;, or</span>
<span class="sd">            &#39;spont-phot&#39;, integer to specify a heavy ion ZAID, or the name of a</span>
<span class="sd">            :py:class:`Distribution` card. If</span>
<span class="sd">            the string is the name of a distribution in the simulation, then</span>
<span class="sd">            that distribution is used, and the other possible inputs are</span>
<span class="sd">            ignored. Therefore, be careful with how distribution cards are</span>
<span class="sd">            name.</span>
<span class="sd">        cell : str, :py:class:`Distribution` name, optional (default: None)</span>
<span class="sd">            Name of a cell in which the source exists, or the name of a</span>
<span class="sd">            :py:class:`Distribution`. If both a cell and distribution have the</span>
<span class="sd">            same card name (ambiguous input), an exception is raised. **CEL**</span>
<span class="sd">            in MCNP.</span>
<span class="sd">        surface : str, :py:class:`Distribution` name, optional (default: None)</span>
<span class="sd">            Name of a surface, or the name of a :py:class:`Surface`. If both a</span>
<span class="sd">            surface and a distribution have the same card name (ambiguous</span>
<span class="sd">            input), an exception is</span>
<span class="sd">            raised. **SUR** in MCNP.</span>
<span class="sd">        energy : float, :py:class:`Distribution` name, optional (default: None) [MeV] </span>
<span class="sd">            Particle energy, or a distribution of energies. **ERG** in MCNP.</span>
<span class="sd">        time : float, :py:class:`Distribution` name, (default: None) [seconds]</span>
<span class="sd">            Time at which the source particles are created, or a distribution</span>
<span class="sd">            of times. **TME** in MCNP.</span>
<span class="sd">        ref_dir : 3-element list, optional (default: None)</span>
<span class="sd">            Reference vector for sampling particle&#39;s direction of travel.</span>
<span class="sd">            **VEC** in MCNP.</span>
<span class="sd">        cosine : float, :py:class:`Distribution` name, optional (default: None)</span>
<span class="sd">            Cosine of the angle between the reference vector</span>
<span class="sd">            :py:attr:`ref_dir` and the particle&#39;s direction of travel, or</span>
<span class="sd">            distribution. **DIR**</span>
<span class="sd">            in MCNP. **DIR** in MCNP.</span>
<span class="sd">        normal_sign : str, optional (default: None)</span>
<span class="sd">            &#39;pos&#39; for a positive surface normal, &#39;neg&#39; for a negative surface</span>
<span class="sd">            normal. **NRM** in MCNP.</span>
<span class="sd">        ref_pos : 3-element list, :py:class:`Distribution` name, optional (default: None) [cm]</span>
<span class="sd">            Reference point for position sampling. **POS** in MCNP, or</span>
<span class="sd">            distribution. For</span>
<span class="sd">            cylinders, it is the point at the center of the base of the</span>
<span class="sd">            cylinder.</span>
<span class="sd">        offset : float, :py:class:`Distribution` name, optional (default: None) [cm]</span>
<span class="sd">            **EXT** in MCNP. Meaning varies, or distribution. For cylinders, it</span>
<span class="sd">            is the length of the cylinder.</span>
<span class="sd">        radius : float, :py:class:`Distribution` name, optional (default: None) [cm]</span>
<span class="sd">            Radial distance of sampled points from :py:attr:`ref_pos` or</span>
<span class="sd">            :py:attr:`axis`, or distribution. **RAD** in MCNP. For cylinders,</span>
<span class="sd">            it is the radius of the cylinder.</span>
<span class="sd">        axis : 3-element list, :py:class:`Distribution` name, optional (default: None)</span>
<span class="sd">            Reference vector or distribution for use in conjunction with</span>
<span class="sd">            :py:attr:`offset` and :py:attr:`radius`. **AXS** in MCNP. For</span>
<span class="sd">            cylinders, it is the axis of the cylinder.</span>
<span class="sd">        x : float, :py:class:`Distribution` name, optional (default: None) [cm]</span>
<span class="sd">            x-coordinate or distribution for source position sampling. **X** in</span>
<span class="sd">            MCNP.</span>
<span class="sd">        y : float, :py:class:`Distribution` name, optional (default: None) [cm]</span>
<span class="sd">            y-coordinate or distribution for source position sampling. **Y** in</span>
<span class="sd">            MCNP.</span>
<span class="sd">        z : float, :py:class:`Distribution` name, optional (default: None) [cm]</span>
<span class="sd">            z-coordinate or distribution for source position sampling. **Z** in</span>
<span class="sd">            MCNP.</span>
<span class="sd">        cookie_cutter : str, :py:class:`Distribution` name, optional (default: None)</span>
<span class="sd">            Name of a cell to use as cookie-cutter, or distribution Be wary of</span>
<span class="sd">            naming cells and distributions with the same name. **CCC** in MCNP.</span>
<span class="sd">        area : float, optional (default: None) [cm^2]</span>
<span class="sd">            Area of the surface, if this is a surface source. **ARA** in MCNP.</span>
<span class="sd">        weight : float, optional (default: None)</span>
<span class="sd">            Explicit particle weight. **WGT** in MCNP.</span>
<span class="sd">        transformation : str, optional (default: None)</span>
<span class="sd">            Name of a :py:class:`Transformation` in the simulation.</span>
<span class="sd">        eff : float, optional (default: None)</span>
<span class="sd">            **EFF** in MCNP. Explicit value. See MCNP manual.</span>
<span class="sd">        beam_emit : 3-element tuple, optional (default: None)</span>
<span class="sd">            **BEM** in MCNP. The tuple contains:</span>

<span class="sd">            1. parameter for x coordinate [pi-cm-rad]</span>
<span class="sd">            2. parameter for y coordinate [pi-cm-rad]</span>
<span class="sd">            3. distance [cm]</span>

<span class="sd">            See MCNP manual.</span>
<span class="sd">        beam_aper : 2-element tuple, optional</span>
<span class="sd">            **BAP** in MCNP. The tuple contains:</span>

<span class="sd">            1. parameter for x [cm]</span>
<span class="sd">            2. parameter for y [cm]</span>

<span class="sd">            See MCNP manual.</span>
<span class="sd">        user_custom : str, optional</span>
<span class="sd">            Appended to the end of :py:meth:`mcnp` output. The user can use</span>
<span class="sd">            this to account for functionality that is not otherwise provided by</span>
<span class="sd">            this class.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following creates the default source::</span>

<span class="sd">            gs = GeneralSource()</span>

<span class="sd">        The following creates a photon source in cell &#39;cellA&#39;::</span>

<span class="sd">            gs = GeneralSource(particle=&#39;photon&#39;, cell=&#39;cellA&#39;)</span>

<span class="sd">        The cookie-cutter input operates the same way as the cell input. The</span>
<span class="sd">        following uses a :py:class:`Distribution` for both the particle and the</span>
<span class="sd">        cell, assuming that the user has created distributions with the names</span>
<span class="sd">        &#39;partdist&#39; and &#39;celldist&#39;, and that there is no cell with the name</span>
<span class="sd">        &#39;celldist&#39;::</span>

<span class="sd">            gs = GeneralSource(particle=&#39;partdist&#39;, cell=&#39;celldist&#39;)</span>

<span class="sd">        Surfaces work the same way as cells. The following shows the</span>
<span class="sd">        specification of energies from a distribution, as well as a time::</span>

<span class="sd">            gs = GeneralSource(energy=&#39;energydist&#39;, time=2e10)</span>

<span class="sd">        The following shows the specification of a reference direction and the</span>
<span class="sd">        cosine from that reference vector::</span>

<span class="sd">            gs = GeneralSource(ref_dir=[1, 0, 0], cosine=0.5)</span>

<span class="sd">        The following shows how a distribution for ``x``, ``y``, and ``z`` can</span>
<span class="sd">        be requested (make sure to add the distributions to the simulation)::</span>

<span class="sd">            gs = GeneralSource(x=&#39;xdist&#39;, y=&#39;ydist&#39;, z=&#39;zdist&#39;)</span>
<span class="sd">            xd = Distribution(&#39;xdist&#39;, [0, 10], [0, 1])</span>
<span class="sd">            yd = Distribution(&#39;ydist&#39;, [-5, 5], [0, 1])</span>
<span class="sd">            zd = Distribution(&#39;zdist&#39;, [0, 1], [0, 1])</span>

<span class="sd">        The following shows how a transformation can be applied to the source</span>
<span class="sd">        (assuming the transformation is added to the simulation)::</span>

<span class="sd">            tr = Transformation(&#39;source&#39;, ...)</span>
<span class="sd">            gs = GeneralSource(transformation=&#39;source&#39;)</span>


<span class="sd">        The following shows how ``beam_emit`` and ``beam_aper`` are used::</span>

<span class="sd">            gs = GeneralSource(beam_emit=(1, 2, 3), beam_aper=(4, 5))</span>

<span class="sd">        All variables for which an example was not given function similarly to</span>
<span class="sd">        the other variables.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GeneralSource</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;gensource&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;particle&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;cell&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;surface&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;energy&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref_dir</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;ref_dir&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cosine</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;cosine&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;normal_sign&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;ref_pos&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;offset&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;radius&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;axis&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;cookie_cutter&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;area&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;weight&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;transformation&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eff</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;eff&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beam_emit</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;beam_emit&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beam_aper</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;beam_aper&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span> <span class="o">=</span> <span class="n">keyword_args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;user_custom&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="c"># Old constructor:</span>
        <span class="c">#def __init__(self, cell=None, surface=None, energy=None, time=None, </span>
        <span class="c">#             ref_dir=None, cosine=None, normal_sign=None, ref_pos=None,</span>
        <span class="c">#             offset=None, radius=None, axis=None, x=None, y=None,</span>
        <span class="c">#             z=None, cookie-cutter=None, area=None, weight=None,</span>
        <span class="c">#             transformation=None, ec*, direction*, normal_sign, </span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;General source {0!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; particle={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; cell={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; surface={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; energy={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; time={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_dir</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ref. dir={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; cosine={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cosine</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0} surf. normal,&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ref. pos={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; offset={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; radius={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; axis={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; x={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; y={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; z={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; c. cutter cell={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; area={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; weight={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; trans.={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eff</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; eff.={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eff</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_emit</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; beam emit.={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beam_emit</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_aper</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; beam aper.={0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beam_aper</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; and user input.&quot;</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">vecformat</span> <span class="o">=</span> <span class="s">&quot;{0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;SDEF&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; PAR=&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">==</span> <span class="s">&#39;spont-fiss-by-neut&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;SF&quot;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">==</span> <span class="s">&#39;spint-fiss-by-hist&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;-SF&quot;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">==</span> <span class="s">&#39;spont-phot&#39;</span><span class="p">:</span>         <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;SP&quot;</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">Particle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; CEL=&quot;</span>
            <span class="c">#if isinstance(self.cell, Cell): </span>
            <span class="c">#    string += &quot;{0}&quot;.format(sim.sys.cell_num(self.cell.name))</span>
            <span class="c">#elif isinstance(self.cell, Distribution):</span>
            <span class="c">#    string += &quot;{0}&quot;.format(sim.dist_num(self.cell.name))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Name {0!r} is both a cell and dist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Name {0!r} is not a cell or dist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; SUR&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surfaces</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dist</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Name {0!r} is both surface and dist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surfaces</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surface_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Name {0!r} is not a surface or dist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">surface</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ERG=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; TME=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">secs2shakes</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_dir</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; VEC=&quot;</span> <span class="o">+</span> <span class="n">vecformat</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; DIR=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cosine</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cosine</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; NRM=&quot;</span>
            <span class="k">if</span>   <span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span> <span class="o">==</span> <span class="s">&#39;neg&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;-1&quot;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span> <span class="o">==</span> <span class="s">&#39;pos&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;+1&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Input ``normal_sign`` cannot be {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">normal_sign</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; POS=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">formatstr</span> <span class="o">=</span> <span class="n">vecformat</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; EXT=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offset</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">offset</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; RAD=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; AXS=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">vecformat</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; X=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; Y=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; Z=&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; CCC=&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span> <span class="ow">and</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Name {0!r} is both a cell and dist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;D{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Name {0!r} is not a cell or dist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cookie_cutter</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ARA=&quot;</span>
            <span class="c">#if type(self.area) is str:</span>
            <span class="c">#    string += &quot;D{0}&quot;.format(sim.dist_num(self.area))</span>
            <span class="c">#else:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">area</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; WGT=&quot;</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; TR={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">sim</span><span class="o">.</span><span class="n">transformation_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformation</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eff</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; EFF=&quot;</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">eff</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_emit</span><span class="p">:</span>
            <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot; BEM={0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_emit</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_aper</span><span class="p">:</span>
            <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot; BAP={0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">beam_aper</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user_custom</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span>

    <span class="nd">@particle.setter</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell</span>

    <span class="nd">@cell.setter</span>
    <span class="k">def</span> <span class="nf">cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cell</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">surface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface</span>

    <span class="nd">@surface.setter</span>
    <span class="k">def</span> <span class="nf">surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_surface</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_energy</span>

    <span class="nd">@energy.setter</span>
    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_energy</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>

    <span class="nd">@time.setter</span>
    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ref_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_dir</span>

    <span class="nd">@ref_dir.setter</span>
    <span class="k">def</span> <span class="nf">ref_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_dir</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cosine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cosine</span>

    <span class="nd">@cosine.setter</span>
    <span class="k">def</span> <span class="nf">cosine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cosine</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">normal_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normal_sign</span>

    <span class="nd">@normal_sign.setter</span>
    <span class="k">def</span> <span class="nf">normal_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normal_sign</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ref_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_pos</span>

    <span class="nd">@ref_pos.setter</span>
    <span class="k">def</span> <span class="nf">ref_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_pos</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">offset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span>

    <span class="nd">@offset.setter</span>
    <span class="k">def</span> <span class="nf">offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span>

    <span class="nd">@radius.setter</span>
    <span class="k">def</span> <span class="nf">radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_radius</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axis</span>

    <span class="nd">@axis.setter</span>
    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axis</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="nd">@x.setter</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="nd">@y.setter</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span>

    <span class="nd">@z.setter</span>
    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cookie_cutter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cookie_cutter</span>

    <span class="nd">@cookie_cutter.setter</span>
    <span class="k">def</span> <span class="nf">cookie_cutter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cookie_cutter</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_area</span>

    <span class="nd">@area.setter</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_area</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">weight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weight</span>

    <span class="nd">@weight.setter</span>
    <span class="k">def</span> <span class="nf">weight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weight</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformation</span>

    <span class="nd">@transformation.setter</span>
    <span class="k">def</span> <span class="nf">transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformation</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">eff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eff</span>
    
    <span class="nd">@eff.setter</span>
    <span class="k">def</span> <span class="nf">eff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eff</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">beam_emit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beam_emit</span>
    
    <span class="nd">@beam_emit.setter</span>
    <span class="k">def</span> <span class="nf">beam_emit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beam_emit</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">beam_aper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beam_aper</span>
    
    <span class="nd">@beam_aper.setter</span>
    <span class="k">def</span> <span class="nf">beam_aper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beam_aper</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">user_custom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_custom</span>

    <span class="nd">@user_custom.setter</span>
    <span class="k">def</span> <span class="nf">user_custom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_custom</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Distribution"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Distribution">[docs]</a><span class="k">class</span> <span class="nc">Distribution</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A distribution used in conjunction with source variables on the</span>
<span class="sd">    :py:class:`GeneralSource` card. The value of a</span>
<span class="sd">    source variable can be sampled from a distribution, described by this</span>
<span class="sd">    class. Distributions are added to a simulation using</span>
<span class="sd">    :py:attr:`definition.MCNPSimulation.add_dist`. In MCNP, this card is</span>
<span class="sd">    implemented with a pair of **SI** and **SP** cards.</span>

<span class="sd">    Limititations:</span>

<span class="sd">    - Embedded sources are not supported; to use this the user must provide an</span>
<span class="sd">      explicit string for ``keys``.</span>
<span class="sd">    - In MCNP, particles also have a number associated with them. It is</span>
<span class="sd">      necessary to use those numbers, instead of the abbreviations like &#39;N&#39; or</span>
<span class="sd">      &#39;H&#39; (see :py:attr:`Particle.mcnp_abbrev`), to avoid conflict with the key</span>
<span class="sd">      settings. Specifying a particle name like &#39;proton&#39; will not cause this</span>
<span class="sd">      code to find the particle number, but in such cases the user can provide</span>
<span class="sd">      the particle number on their own. Alternatively, the user can provide</span>
<span class="sd">      their ``keys`` input explicitly as a string .</span>
<span class="sd">    - Particles that are heavy ions are not supported through</span>
<span class="sd">      ``pyne.nucname``, but the user can provide the ZAID integer as part of the</span>
<span class="sd">      ``keys`` list</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_keys</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;histogram&#39;</span><span class="p">:</span> <span class="s">&#39;H&#39;</span><span class="p">,</span>
                 <span class="s">&#39;discrete&#39;</span> <span class="p">:</span> <span class="s">&#39;L&#39;</span><span class="p">,</span>
                 <span class="s">&#39;pdf_indep&#39;</span><span class="p">:</span> <span class="s">&#39;A&#39;</span><span class="p">,</span>
                 <span class="s">&#39;dist&#39;</span>     <span class="p">:</span> <span class="s">&#39;S&#39;</span><span class="p">}</span>
    <span class="n">mcnp_vals</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;prob&#39;</span>     <span class="p">:</span> <span class="s">&#39;D&#39;</span><span class="p">,</span>
                 <span class="s">&#39;cumprob&#39;</span>  <span class="p">:</span> <span class="s">&#39;C&#39;</span><span class="p">,</span>
                 <span class="s">&#39;propvol&#39;</span>  <span class="p">:</span> <span class="s">&#39;V&#39;</span><span class="p">,</span>
                 <span class="s">&#39;partint&#39;</span>  <span class="p">:</span> <span class="s">&#39;W&#39;</span><span class="p">}</span>
    <span class="n">analytic</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;maxwell&#39;</span>   <span class="p">:</span>  <span class="mi">2</span><span class="p">,</span>
                <span class="s">&#39;watt&#39;</span>      <span class="p">:</span>  <span class="mi">3</span><span class="p">,</span>  
                <span class="s">&#39;gauss&#39;</span>     <span class="p">:</span>  <span class="mi">4</span><span class="p">,</span>  
                <span class="s">&#39;evap&#39;</span>      <span class="p">:</span>  <span class="mi">5</span><span class="p">,</span>  
                <span class="s">&#39;muir&#39;</span>      <span class="p">:</span>  <span class="mi">6</span><span class="p">,</span>  
                <span class="s">&#39;exp_decay&#39;</span> <span class="p">:</span>  <span class="mi">7</span><span class="p">,</span>  
                <span class="s">&#39;power&#39;</span>     <span class="p">:</span> <span class="mi">21</span><span class="p">,</span> 
                <span class="s">&#39;exp&#39;</span>       <span class="p">:</span> <span class="mi">31</span><span class="p">,</span> 
                <span class="s">&#39;gauss_beam&#39;</span><span class="p">:</span> <span class="mi">41</span><span class="p">}</span> 

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">key_setting</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">val_setting</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The ``keys`` are the independent variable in the distribution, and</span>
<span class="sd">        the ``vals`` are probability values for the independent variable.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`. Used to reference this card from the</span>
<span class="sd">            :py:class:`GeneralSource` card.</span>
<span class="sd">        key_setting : str, optional</span>
<span class="sd">            Specifies what the keys represent. The following settings are</span>
<span class="sd">            allowed:</span>

<span class="sd">            - &#39;histogram&#39;: bin upper boundaries. **H** in MCNP.</span>
<span class="sd">            - &#39;discrete&#39;: source variable values. **L** in MCNP.</span>
<span class="sd">            - &#39;pdf_indep&#39;: independent variable for probability density</span>
<span class="sd">              function. **A** in MCNP.</span>
<span class="sd">            - &#39;dist&#39;: names of other distributions. **S** in MCNP.</span>
<span class="sd">            - &#39;analytic&#39;: ``vals`` contains the parameters of a built-in</span>
<span class="sd">              analytic probability density function, and the function is</span>
<span class="sd">              determined by the ``key_setting``. In this case, ``keys`` must be</span>
<span class="sd">              an empty list ``[]`` or ``list()``, or the bounds of the domain</span>
<span class="sd">              for the function.</span>

<span class="sd">        val_setting : str, optional</span>
<span class="sd">            Specifies what the values represent. The following settings are</span>
<span class="sd">            allowed:</span>

<span class="sd">            - &#39;prob&#39;: bin probabilities. ** D** in MCNP.</span>
<span class="sd">            - &#39;cumprob&#39;: cumulative bin probabilities. **C** in MCNP.</span>
<span class="sd">            - &#39;propvol&#39;: probability proportional to cell vol. **V** in MCNP.</span>
<span class="sd">            - &#39;partint&#39;: intensities of particle sources. Values can be the</span>
<span class="sd">              name of a cell for spontaneous fission or spontaneous photon</span>
<span class="sd">              sources. **W** in MCNP.</span>
<span class="sd">            - if ``key_setting`` == &#39;analytic&#39;, this value is one of the</span>
<span class="sd">              following, with parameters specified in a list on ``vals``:</span>
<span class="sd">                 </span>
<span class="sd">                - &#39;maxwell&#39;: 1 parameter</span>
<span class="sd">                - &#39;watt&#39;: 2 parameters</span>
<span class="sd">                - &#39;gauss&#39;: 2 parameters</span>
<span class="sd">                - &#39;evap&#39;: 1 parameter</span>
<span class="sd">                - &#39;muir&#39;: 2 parameters</span>
<span class="sd">                - &#39;exp_decay&#39;: 1 parameter</span>
<span class="sd">                - &#39;power&#39;: 1 parameter</span>
<span class="sd">                - &#39;exp&#39;: 1 parameter</span>
<span class="sd">                - &#39;gauss_beam&#39;: 2 parameters</span>

<span class="sd">            All the analytic parameters have defaults, and the defaults can be</span>
<span class="sd">            invoked if ``vals`` is an empty list. See MCNP manual for more</span>
<span class="sd">            information.</span>
<span class="sd">        keys : list, str</span>
<span class="sd">            If a string, the string is printed after the ``key_setting``, if</span>
<span class="sd">            provided. A string is used if the class does not provide the</span>
<span class="sd">            desired functionality, and the user wants to provide their own</span>
<span class="sd">            input. If a list, elements can be:</span>
<span class="sd">            </span>
<span class="sd">            - particle names (keys of :py:attr:`Particle.mcnp_abbrev`),</span>
<span class="sd">            - &#39;spont-fiss-by-neut&#39;, &#39;spont-fiss-by-hist&#39;, &#39;spont-phot&#39;,</span>
<span class="sd">            - a 3-element list or :py:class:`np.array`,</span>
<span class="sd">            - the name of another :py:class:`Distribution`, or</span>
<span class="sd">            - anything else.</span>

<span class="sd">            The list should be as long as ``vals``, unless ``key_setting`` is</span>
<span class="sd">            ``analytic``, in which case it is an empty list or the bounds of</span>
<span class="sd">            the domain of the analytic function.</span>
<span class="sd">        vals : list, str</span>
<span class="sd">            If a string, the string is printed after the ``val_setting``, if</span>
<span class="sd">            provided. A string is used if the class does not provide the</span>
<span class="sd">            desired functionality, and the user wants to provide their own</span>
<span class="sd">            input. If a list, elements can be:</span>
<span class="sd">            </span>
<span class="sd">            - cell name,</span>
<span class="sd">            - analytic function parameters, or</span>
<span class="sd">            - anything else (a normal bin probability).</span>

<span class="sd">            The list should be as long as ``keys``, unless ``key_setting`` is</span>
<span class="sd">            &#39;analytic&#39;, in which case the list contains the 1 or 2 parameters</span>
<span class="sd">            for the analytic function, or can be an empty list to use the</span>
<span class="sd">            default parameters.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following might be used for the ``x`` source variable::</span>

<span class="sd">            sd = Distribution(&#39;distA&#39;, [-2, 2], [0, 1])</span>
<span class="sd">            sd = Distribution(&#39;distA&#39;, [-2, 2], [0, 1], &#39;histogram&#39;, &#39;prob&#39;)</span>

<span class="sd">        The following specifies multiple particle types and their intensities,</span>
<span class="sd">        also showing how a cell name can be provided as an intensity value, and</span>
<span class="sd">        a heavy ion can be specified::</span>

<span class="sd">            sd = Distribution(&#39;distA&#39;, </span>
<span class="sd">                    [&#39;neutron&#39;, &#39;photon&#39;, &#39;spont-fiss-by-neut&#39;, 92238],</span>
<span class="sd">                    [1, 1, &#39;cellA&#39;, 2],</span>
<span class="sd">                    key_setting=&#39;discrete&#39;,</span>
<span class="sd">                    val_setting=&#39;partint&#39;)</span>

<span class="sd">        The names of other distributions can be provided as well. It is assumed</span>
<span class="sd">        in this example that &#39;distB&#39; and &#39;distC&#39; are the names of</span>
<span class="sd">        :py:class:`Distribution`&#39;s that will be added to the simulation before</span>
<span class="sd">        an input is created::</span>

<span class="sd">            sd = Distribution(&#39;distA&#39;, [&#39;distB&#39;, &#39;distC&#39;], [0.3, 0.7], &#39;dist&#39;)</span>

<span class="sd">        The following two commands specify an unbounded analytic distribution</span>
<span class="sd">        using the default parameters::</span>

<span class="sd">            sd = Distribution(&#39;distA&#39;, [], [], &#39;analytic&#39;, &#39;maxwell&#39;)</span>
<span class="sd">            sd = Distribution(&#39;distA&#39;, [], [], key_setting=&#39;analytic&#39;,</span>
<span class="sd">                    val_setting=&#39;maxwell&#39;)</span>

<span class="sd">        The following is a bounded analytic distribution, with parameters</span>
<span class="sd">        specified::</span>

<span class="sd">            sd = Distribution(&#39;distA&#39;, [0, 10], [1, 3], &#39;analytic&#39;, &#39;watt&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Distribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span> <span class="o">=</span> <span class="n">key_setting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_setting</span> <span class="o">=</span> <span class="n">val_setting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="n">keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">vals</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">vecformat</span> <span class="o">=</span> <span class="s">&quot; {0} {0} {0}&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Source distribution {0!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; key setting {0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span> <span class="k">else</span> <span class="s">&quot;default&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; val setting {0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">val_setting</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_setting</span> <span class="k">else</span> <span class="s">&quot;default&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; KEYS:&quot;</span>
        <span class="c"># Independent variable.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; default,&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="c"># Probability values.</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; VALS:&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; default,&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0},&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">vecformat</span> <span class="o">=</span> <span class="s">&quot; {0} {0} {0}&quot;</span>
        <span class="c"># Independent variable.</span>
        <span class="n">info</span> <span class="o">=</span> <span class="s">&quot;SI{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span> <span class="o">!=</span> <span class="s">&#39;analytic&#39;</span><span class="p">:</span>
                <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcnp_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Particle</span><span class="o">.</span><span class="n">mcnp_abbrev</span><span class="p">:</span>
                    <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Particle</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;spont-fiss-by-neut&#39;</span><span class="p">:</span> <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; SF&quot;</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;spont-fiss-by-hist&#39;</span><span class="p">:</span> <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; -SF&quot;</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&#39;spont-phot&#39;</span><span class="p">:</span>         <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; SP&quot;</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">info</span> <span class="o">+=</span> <span class="n">vecformat</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">dists</span><span class="p">:</span>
                    <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">info</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="c"># Probability values.</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="s">&quot;SP{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">val_setting</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_setting</span> <span class="o">==</span> <span class="s">&#39;analytic&#39;</span><span class="p">:</span>
                <span class="n">prob</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">analytic</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">val_setting</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prob</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcnp_vals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">val_setting</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">prob</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                    <span class="n">prob</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">-</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">prob</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">float_format</span> <span class="o">%</span> <span class="n">val</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prob</span> <span class="o">+=</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="c"># Don&#39;t print an SI card if ``keys`` is an empty list.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">prob</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0}</span><span class="se">\n</span><span class="s">{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">key_setting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_setting</span>

    <span class="nd">@key_setting.setter</span>
    <span class="k">def</span> <span class="nf">key_setting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">acceptable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_keys</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;analytic&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">acceptable</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The ``key_setting`` {0!r} is &quot;</span>
                <span class="s">&quot;unacceptable.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_setting</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">val_setting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_val_setting</span>

    <span class="nd">@val_setting.setter</span>
    <span class="k">def</span> <span class="nf">val_setting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">acceptable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_vals</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">analytic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">acceptable</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The ``val_setting`` {0!r} is &quot;</span>
                <span class="s">&quot;unacceptable.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_val_setting</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span>

    <span class="nd">@keys.setter</span>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keys</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span>

    <span class="nd">@vals.setter</span>
    <span class="k">def</span> <span class="nf">vals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Criticality"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Criticality">[docs]</a><span class="k">class</span> <span class="nc">Criticality</span><span class="p">(</span><span class="n">ISource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A criticality source of neutrons. Unique card with name `criticality`.</span>
<span class="sd">    In MCNP, this is the **KCODE** card.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Criticality</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_histories</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">keff_guess</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="n">n_skip_cycles</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">n_cycles</span><span class="o">=</span><span class="mi">130</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_histories : int, optional</span>
<span class="sd">            Number of particle histories to run in each cycle.</span>
<span class="sd">        keff_guess : float, optional</span>
<span class="sd">            Initial guess for the effective multiplication constant of the</span>
<span class="sd">            system.</span>
<span class="sd">        n_skip_cycles : int, optional</span>
<span class="sd">            The number of cycles to skip.</span>
<span class="sd">        n_cycles : int, optional</span>
<span class="sd">            The total number of cycles to simulate (skipped + active).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following::</span>

<span class="sd">            critsrc = Criticality(2000, 1.5, 30, 300)</span>

<span class="sd">        creates a criticality source with 2000 histories per cycle, an initial</span>
<span class="sd">        k_eff guess of 1.5, 30 skipped cyles, and 300 total cycles.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Criticality</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;criticality&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">n_histories</span> <span class="o">=</span> <span class="n">n_histories</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keff_guess</span> <span class="o">=</span> <span class="n">keff_guess</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_skip_cycles</span> <span class="o">=</span> <span class="n">n_skip_cycles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_cycles</span> <span class="o">=</span> <span class="n">n_cycles</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot;Criticality source {0!r}: n_histories: {1}, keff_guess: {2:g}&quot;</span>
                <span class="s">&quot;, n_skip_cycles: {3}, n_cycles: {4}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">n_histories</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keff_guess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_skip_cycles</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">n_cycles</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;KCODE {0} {1} {2} {3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_histories</span><span class="p">,</span>
                <span class="n">float_format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_skip_cycles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cycles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">keff_guess</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_histories</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_histories</span>

    <span class="nd">@n_histories.setter</span>
    <span class="k">def</span> <span class="nf">n_histories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``n_histories`` must be an &quot;</span>
                    <span class="s">&quot;integer. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``n_histories`` must be positive. &quot;</span>
                <span class="s">&quot;User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_histories</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">keff_guess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_keff_guess</span>
 
    <span class="nd">@keff_guess.setter</span>
    <span class="k">def</span> <span class="nf">keff_guess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``keff_guess`` must be &quot;</span>
                    <span class="s">&quot;non-negative. User provided {0:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_keff_guess</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_skip_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_skip_cycles</span>

    <span class="nd">@n_skip_cycles.setter</span>
    <span class="k">def</span> <span class="nf">n_skip_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``n_skip_cycles`` must be an &quot;</span>
                    <span class="s">&quot;integer. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``n_skip_cycles`` must be positive. &quot;</span>
                <span class="s">&quot;User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_skip_cycles</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_cycles</span>

    <span class="nd">@n_cycles.setter</span>
    <span class="k">def</span> <span class="nf">n_cycles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``n_cycles`` must be an &quot;</span>
                    <span class="s">&quot;integer. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_skip_cycles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The property ``n_cycles`` must be equal to or &quot;</span>
                    <span class="s">&quot;greater than ``n_skip_cycles``. &quot;</span>
                    <span class="s">&quot;User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="c"># If n_cycles is greater or equal to n_skip_cycles, it is positive.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_cycles</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="CriticalityPoints"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CriticalityPoints">[docs]</a><span class="k">class</span> <span class="nc">CriticalityPoints</span><span class="p">(</span><span class="n">ISource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initial source points for neutrons generated by a criticality source.</span>
<span class="sd">    Unique card with name &#39;criticalitypoints&#39;. In MCNP, this is the **KSRC**</span>
<span class="sd">    card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CriticalityPoints</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points : list of 3-element lists, optional [centimeters]</span>
<span class="sd">            A list of 3-element lists (or numpy arrays) specifying</span>
<span class="sd">            initial neutron source points in 3-D space.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following specifies two initial source points at (1, 2, 3) cm and</span>
<span class="sd">        at (3.141..., 2.718..., 0) cm, where we have imported :py:mod:`numpy`</span>
<span class="sd">        as ``np``::</span>

<span class="sd">            critpts = CriticalityPoints([[1, 2, 3],</span>
<span class="sd">                                        np.array([np.pi, np.e, 0])])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CriticalityPoints</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;criticalitypoints&#39;</span><span class="p">,</span>
                                                <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">points</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Criticality points {0!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ({0[0]:g}, {0[1]:g}, {0[2]:g}) cm{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">point</span><span class="p">,</span>
                <span class="s">&quot;,&quot;</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span> <span class="k">else</span> <span class="s">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c"># Will be editing the points list through popping, so make a copy.</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;KSRC {0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">{0}{1} {1} {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">float_format</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span>

    <span class="nd">@points.setter</span>
    <span class="k">def</span> <span class="nf">points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">point</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Length of all point lists/arrays must be 3.&quot;</span>
                        <span class="s">&quot; User provided a point {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">point</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ITally"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ITally">[docs]</a><span class="k">class</span> <span class="nc">ITally</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for</span>
<span class="sd">    tallies (MCNP) or detectors (Serpent).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">alt_units</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`. Used for, e.g., tally multiplier cards.</span>
<span class="sd">        particle : str, list of str</span>
<span class="sd">            Name of the particle to tally, e.g. &#39;neutron&#39;, &#39;photon&#39;, electron&#39;,</span>
<span class="sd">            or &#39;proton&#39;. For some tallies, may be a list of particle names.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If set to True and the tally can use alternative units, alternative</span>
<span class="sd">            units are used for the tally. See subclasses.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ITally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">=</span> <span class="p">[</span><span class="n">Particle</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">particle</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">=</span> <span class="n">Particle</span><span class="p">(</span><span class="n">particle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alt_units</span> <span class="o">=</span> <span class="n">alt_units</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0} tally {1!r} of &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">name</span>
            <span class="c"># &#39;all&#39; is only for CellEnergyDeposition.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s">&#39;all&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;s&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pcounter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">:</span>
                <span class="n">pcounter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pcounter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;, &quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s">&quot; (in alt. units)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alt_units</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>
    
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pre</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">alt_units</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Can&#39;t have * and + as tally prefix.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alt_units</span><span class="p">:</span> <span class="n">pre</span> <span class="o">=</span> <span class="s">&#39;*&#39;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0}F{1}{2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pre</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">sim</span><span class="o">.</span><span class="n">tally_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="n">num</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># &#39;all&#39; is only for CellEnergyDeposition.</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;:&quot;</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span> <span class="n">plist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span>
            <span class="k">else</span><span class="p">:</span>                           <span class="n">plist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">]</span>
            <span class="n">pcounter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
                <span class="n">pcounter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">part</span><span class="o">.</span><span class="n">mcnp</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">pcounter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span>

    <span class="nd">@particle.setter</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">alt_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alt_units</span>

    <span class="nd">@alt_units.setter</span>
    <span class="k">def</span> <span class="nf">alt_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alt_units</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ICellSurfTally"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICellSurfTally">[docs]</a><span class="k">class</span> <span class="nc">ICellSurfTally</span><span class="p">(</span><span class="n">ITally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for</span>
<span class="sd">    tallies over cells and surfaces, as opposed to detector tallies. In MCNP,</span>
<span class="sd">    these are the **F1**, **F2**, **F4**, **F6**, **F7** and **F8** tallies.</span>
<span class="sd">    Some of these are for cells, and some are for surfaces.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        cards : str name of :py:class:`Cell` or :py:class:`ISurface`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            **Basic** If tallying 1 cell/surface, the input is that</span>
<span class="sd">            cell/surface card. If tallying multiple cells/surfaces, the</span>
<span class="sd">            individual cell/surface cards are provided in a list. To obtain the</span>
<span class="sd">            average tally across multiple cells/surfaces, these cell/surface</span>
<span class="sd">            cards are provided in their own list, within the outer list. To</span>
<span class="sd">            avoid ambiguity, if only one set of averages is desired, then this</span>
<span class="sd">            set must be nested in two lists. See the examples.</span>

<span class="sd">            **Unit** For a more complex tally, specifically for nested geometry</span>
<span class="sd">            or what is called `repeated structures` in MCNP, the user can</span>
<span class="sd">            supply an instance of a subclass of</span>
<span class="sd">            :py:class:`pyne.simplesim.nestedgeom.IUnit`, or such an instance as</span>
<span class="sd">            part of the list of card names. However, a unit cannot be averaged</span>
<span class="sd">            with other units (e.g. nested within another list); there is</span>
<span class="sd">            functionality within the units for averaging/unioning. There is a</span>
<span class="sd">            good amount of documentation in that module, and there are examples</span>
<span class="sd">            below.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following gives the tally in cell &#39;cA&#39;::</span>

<span class="sd">            tally = CellFlux(&#39;fuel&#39;, &#39;neutron&#39;, &#39;cA&#39;)</span>

<span class="sd">        The following two cards give the tally in surface &#39;sA&#39; and &#39;sB&#39;, and</span>
<span class="sd">        the average across surfaces &#39;sB&#39; and &#39;sC&#39;::</span>

<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;photon&#39;, [&#39;sA&#39;, &#39;sB&#39;, [&#39;sB&#39;, &#39;sC&#39;]],</span>
<span class="sd">                    average=True)</span>

<span class="sd">        To obtain the average across surfaces &#39;sA&#39; and &#39;sB&#39; only, a nested list</span>
<span class="sd">        is required to distinguish the case of tallying on &#39;sA&#39; and &#39;sB&#39;</span>
<span class="sd">        individually::</span>

<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;neutron&#39;, [[&#39;sA&#39;, &#39;sB&#39;]])</span>

<span class="sd">        Alternatively, the cards can be specified by something like the</span>
<span class="sd">        following (see :py:mod:`pyne.simplesim.nestedgeom`)::</span>

<span class="sd">            import .simplesim.nestedgeom as ng</span>
<span class="sd">            unit = ng.Surf(&#39;sA&#39;) &lt; ng.FCell(&#39;cA&#39;)</span>
<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;neutron&#39;, unit)</span>

<span class="sd">        The basic input and the unit input can be mixed, and two different</span>
<span class="sd">        units can be requested::</span>

<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;neutron&#39;, [&#39;sA&#39;, unit])</span>
<span class="sd">            unit2 = ng.Surf(&#39;sA&#39;) &lt; ng.FCell(&#39;cA&#39;).lat(ng.Lin(2))</span>
<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;neutron&#39;, [unit, unit2])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ICellSurfTally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cards</span> <span class="o">=</span> <span class="n">cards</span>
        <span class="c"># Affects behavior in comment() and mcnp(), etc.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;card_type&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">!=</span> <span class="s">&#39;cell&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">!=</span> <span class="s">&#39;surface&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Card type must be &#39;cell&#39; or &#39;surface. &quot;</span>
                    <span class="s">&quot;Got {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">card_type</span><span class="p">))</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">union_type</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ICellSurfTally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">title</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">==</span> <span class="s">&#39;cell&#39;</span><span class="p">:</span>      <span class="n">classcheck</span> <span class="o">=</span> <span class="n">Cell</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">==</span> <span class="s">&#39;surface&#39;</span><span class="p">:</span> <span class="n">classcheck</span> <span class="o">=</span> <span class="n">ISurface</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span> 
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">,</span> <span class="n">ng</span><span class="o">.</span><span class="n">IUnit</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0} {1!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">card_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected list, string, or IUnit; &quot;</span>
                        <span class="s">&quot;got {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}s &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">card_type</span><span class="p">)</span>
            <span class="n">outcounter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">:</span>
                <span class="n">outcounter</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ng</span><span class="o">.</span><span class="n">IUnit</span><span class="p">):</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span>
                    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected list, string, or IUnit; &quot;</span>
                                <span class="s">&quot;got {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="c"># Not a unit.</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0} in &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">union_type</span><span class="p">)</span>
                    <span class="n">incounter</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">avgobj</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">avgobj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                            <span class="k">raise</span><span class="p">(</span><span class="s">&quot;Expected string; got {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgobj</span><span class="p">))</span>
                        <span class="n">incounter</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="c"># Must be a cell/surface card name.</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgobj</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">incounter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;, &quot;</span>
                <span class="k">if</span> <span class="n">outcounter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;; &quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ICellSurfTally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span>
                                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">==</span> <span class="s">&#39;cell&#39;</span><span class="p">:</span>      <span class="n">getname</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_type</span> <span class="o">==</span> <span class="s">&#39;surface&#39;</span><span class="p">:</span> <span class="n">getname</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surface_num</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span> <span class="n">clist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards</span>
        <span class="k">else</span><span class="p">:</span>                        <span class="n">clist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">]</span>
        <span class="n">outcounter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">clist</span><span class="p">:</span>
            <span class="n">outcounter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ng</span><span class="o">.</span><span class="n">IUnit</span><span class="p">):</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">getname</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected string or IUnit; got &quot;</span>
                            <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; (&quot;</span>
                <span class="k">for</span> <span class="n">avgobj</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                    <span class="c"># Must be a cell/surface card name.</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">avgobj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected string; got &quot;</span>
                                <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgobj</span><span class="p">))</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">getname</span><span class="p">(</span><span class="n">avgobj</span><span class="p">))</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;)&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">_unique_card_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># TODO Broken after implementing IUnit (does not expect card to contain</span>
        <span class="c"># any IUnits) but seems unneeded.</span>
        <span class="c"># Returns a unique list of all the card names provided in self.cards.</span>
        <span class="c"># This method, in the future, may be called by</span>
        <span class="c"># :py:class:`pyne.simplesim.SimulationDefinition` for error-checking.</span>
        <span class="c"># TODO this is ideally recursive, and maybe can be implemented in a</span>
        <span class="c"># cleaner way.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">card_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">avgobj</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">avgobj</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="ow">and</span>
                                <span class="n">avgobj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">card_list</span><span class="p">):</span>
                            <span class="n">card_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">avgobj</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">card_list</span><span class="p">:</span>
                    <span class="c"># Not a list, must be a cell/surface name.</span>
                    <span class="n">card_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">card_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected cell or surface name, or list,&quot;</span>
                <span class="s">&quot; got {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards</span><span class="p">)))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cards</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cards</span>

    <span class="nd">@cards.setter</span>
    <span class="k">def</span> <span class="nf">cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cards</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">alt_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alt_units</span>

    <span class="nd">@alt_units.setter</span>
    <span class="k">def</span> <span class="nf">alt_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alt_units</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="SurfaceCurrent"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.SurfaceCurrent">[docs]</a><span class="k">class</span> <span class="nc">SurfaceCurrent</span><span class="p">(</span><span class="n">ICellSurfTally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Surface current tally. In MCNP, this is the **F1** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.SurfaceCurrent</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        cards : str name of :py:class:`ISurface`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`ICellSurfTally`.</span>
<span class="sd">        total : bool, optional</span>
<span class="sd">            Include a tally for the total current across all surfaces</span>
<span class="sd">            specified on this card (note: NOT across all surfaces in the</span>
<span class="sd">            `problem`).</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, Tally is additionally weighted by particle energy.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in surface &#39;sA&#39;, surface &#39;sB&#39;, as well</span>
<span class="sd">        as the total across &#39;sA&#39; and &#39;sB&#39;::</span>

<span class="sd">            tally = SurfaceCurrent(&#39;fuel&#39;, &#39;electron&#39;, [&#39;sA&#39;, &#39;sB&#39;],</span>
<span class="sd">                    total=True)</span>

<span class="sd">        In the following, the tally is also weighted by particle energy::</span>

<span class="sd">            tally = SurfaceCurrent(&#39;fuel&#39;, &#39;photon&#39;, [[&#39;sA&#39;, &#39;sB&#39;]],</span>
<span class="sd">                    alt_units=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceCurrent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span>
                                             <span class="n">card_type</span><span class="o">=</span><span class="s">&#39;surface&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">total</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceCurrent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Surface current&quot;</span><span class="p">,</span>
                                                     <span class="s">&#39;total&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;; and total of all provided.&quot;</span>
        <span class="k">else</span><span class="p">:</span>          <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;.&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceCurrent</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; T&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

</div>
<div class="viewcode-block" id="IAverageTally"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IAverageTally">[docs]</a><span class="k">class</span> <span class="nc">IAverageTally</span><span class="p">(</span><span class="n">ICellSurfTally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for</span>
<span class="sd">    tallies of averaged quantities. In MCNP, these are the **F2**, **F4**,</span>
<span class="sd">    **F6**, **F7** and **F8** tallies. Some of these are for cells, and some</span>
<span class="sd">    are for surfaces.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        cards : str name of :py:class:`Cell` or :py:class:`ISurface`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`ICellSurfTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            Include a tally for the average flux across all cells/surfaces</span>
<span class="sd">            specified on this card (note: NOT across all cells in the</span>
<span class="sd">            `problem`).</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If set to True and the tally can use alternative units, alternative</span>
<span class="sd">            units are used for the tally. See subclasses, and :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in cell &#39;cA&#39;, cell &#39;cB&#39;, as well as</span>
<span class="sd">        the average across &#39;cA&#39; and &#39;cB&#39;::</span>

<span class="sd">            tally = CellEnergyDeposition(&#39;fuel&#39;, &#39;neutron&#39;, [&#39;cA&#39;, &#39;cB&#39;],</span>
<span class="sd">                    average=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">average</span> <span class="o">=</span> <span class="n">average</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">avgstr</span> <span class="o">=</span> <span class="s">&#39;avg.&#39;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">avgstr</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">average</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;; and {0} of all provided.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgstr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;.&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span>
                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">average</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; T&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span>

    <span class="nd">@average.setter</span>
    <span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_average</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="SurfaceFlux"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.SurfaceFlux">[docs]</a><span class="k">class</span> <span class="nc">SurfaceFlux</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Surface flux tally. In MCNP, this is the **F2** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.SurfaceFlux</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        cards : str name of :py:class:`ISurface`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, Tally is additionally weighted by particle energy.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in surface &#39;sA&#39;, surface &#39;sB&#39;, as well</span>
<span class="sd">        as the average across &#39;sA&#39; and &#39;sB&#39;::</span>

<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;electron&#39;, [&#39;sA&#39;, &#39;sB&#39;],</span>
<span class="sd">                    average=True)</span>

<span class="sd">        In the following, the tally is also weighted by particle energy::</span>

<span class="sd">            tally = SurfaceFlux(&#39;fuel&#39;, &#39;proton&#39;, [[&#39;sA&#39;, &#39;sB&#39;]],</span>
<span class="sd">                    alt_units=True)</span>
<span class="sd">        </span>
<span class="sd">        See base classes for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceFlux</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span>
                                          <span class="n">card_type</span><span class="o">=</span><span class="s">&#39;surface&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceFlux</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Surface flux&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceFlux</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span>

    <span class="nd">@total.setter</span>
    <span class="k">def</span> <span class="nf">total</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="CellFlux"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellFlux">[docs]</a><span class="k">class</span> <span class="nc">CellFlux</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cell flux tally. In MCNP, this is the **F4** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CellFlux</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        cards : str name of :py:class:`Cell`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, Tally is additionally weighted by particle energy.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in cell &#39;cA&#39;, cell &#39;cB&#39;, as well as</span>
<span class="sd">        the average across &#39;cA&#39; and &#39;cB&#39;::</span>

<span class="sd">            tally = CellFlux(&#39;fuel&#39;, &#39;electron&#39;, [&#39;cA&#39;, &#39;cB&#39;],</span>
<span class="sd">                    average=True)</span>

<span class="sd">        In the following, the tally is also weighted by particle energy::</span>

<span class="sd">            tally = CellFlux(&#39;fuel&#39;, &#39;proton&#39;, [[&#39;cA&#39;, &#39;cB&#39;]],</span>
<span class="sd">                    alt_units=True)</span>
<span class="sd">        </span>
<span class="sd">        See base classes for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CellFlux</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="n">card_type</span><span class="o">=</span><span class="s">&#39;cell&#39;</span><span class="p">,</span>
                                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellFlux</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Cell flux&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellFlux</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CellEnergyDeposition"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellEnergyDeposition">[docs]</a><span class="k">class</span> <span class="nc">CellEnergyDeposition</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Energy deposition tally. In MCNP, this is the **F6** card. In MCNP, it</span>
<span class="sd">    is not permitted to use a particle &#39;all&#39; and also to use alternative units.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CellEnergyDeposition</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">6</span>

    <span class="c"># TODO in mcnp input, prevent particle all and alt_units</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particles : str, list of str</span>
<span class="sd">            See :py:class:`ITally`. For this tally, the user can specify the</span>
<span class="sd">            particle type as a list of strs to tally more than one type of</span>
<span class="sd">            particle. Also, the additional value of &#39;all&#39; is allowed, and</span>
<span class="sd">            specifies collision heating. As may be expected, &#39;all&#39; cannot be</span>
<span class="sd">            provided as part of a list.</span>
<span class="sd">        cards : str name of :py:class:`Cell`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, alternative units are used for the tally. In MCNP, the</span>
<span class="sd">            default units are MeV/g and the alternative units are jerks/g.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the energy deposited by neutrons in cell &#39;cA&#39;::</span>

<span class="sd">            tally = CellEnergyDeposition(&#39;energy&#39;, &#39;neutron&#39;, &#39;cA&#39;)</span>


<span class="sd">        The following requests the energy deposited by neutrons and protons in</span>
<span class="sd">        cell &#39;cA&#39;::</span>

<span class="sd">            tally = CellEnergyDeposition(&#39;energy&#39;, [&#39;neutron&#39;, &#39;proton&#39;],</span>
<span class="sd">                    &#39;cA&#39;)</span>
<span class="sd">        </span>
<span class="sd">        The following requests the energy deposited by all particles in cell</span>
<span class="sd">        &#39;cA&#39;::</span>

<span class="sd">            tally = CellEnergyDeposition(&#39;energy&#39;, &#39;all&#39;, &#39;cA&#39;)</span>

<span class="sd">        The following are not allowed in MCNP::</span>
<span class="sd">            </span>
<span class="sd">            tally = CellEnergyDeposition(&#39;energy&#39;, [&#39;neutron&#39;, &#39;all&#39;], &#39;cA&#39;)</span>
<span class="sd">            tally = CellEnergyDeposition(&#39;energy&#39;, &#39;all&#39;, &#39;cA&#39;, alt_units=True)</span>

<span class="sd">        See base classes for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CellEnergyDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span>
                                                   <span class="n">card_type</span><span class="o">=</span><span class="s">&#39;cell&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c"># TODO move this error check to the MCNP method.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">alt_units</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The particle cannot be &#39;all&#39; if alt_units is &quot;</span>
                    <span class="s">&quot;True.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellEnergyDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Energy deposition&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">pre</span> <span class="o">=</span> <span class="s">&#39;+&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pre</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellEnergyDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">,</span>
                                                      <span class="n">pre</span><span class="o">=</span><span class="n">pre</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span>

    <span class="nd">@particle.setter</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c"># Make sure that if there is more than one particle, that none of them</span>
        <span class="c"># has name &#39;all&#39;.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The particle &#39;all&#39; cannot be given with&quot;</span>
                            <span class="s">&quot; other particles.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="CellFissionEnergyDeposition"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellFissionEnergyDeposition">[docs]</a><span class="k">class</span> <span class="nc">CellFissionEnergyDeposition</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">):</span>        
    <span class="sd">&quot;&quot;&quot;Fission energy deposition tally. In MCNP, this is the **F7** card. The</span>
<span class="sd">    particle is necessarily neutron.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CellFissionEnergyDeposition</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="c"># TODO prevent user from specifying a different particle.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        cards : str name of :py:class:`Cell`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, alternative units are used for the tally. In MCNP, the</span>
<span class="sd">            default units are MeV/g and the alternative units are jerks/g.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in cell &#39;cA&#39;, cell &#39;cB&#39;, as well as</span>
<span class="sd">        the average across &#39;cA&#39; and &#39;cB&#39;::</span>

<span class="sd">            tally = CellFissionEnergyDeposition(&#39;fuel&#39;, [&#39;cA&#39;,</span>
<span class="sd">                    &#39;cB&#39;], average=True)</span>

<span class="sd">        In the following, the alternate units are used::</span>

<span class="sd">            tally = CellFissionEnergyDeposition(&#39;fuel&#39;, [[&#39;cA&#39;,</span>
<span class="sd">                    &#39;cB&#39;]], alt_units=True)</span>
<span class="sd">        </span>
<span class="sd">        See base classes for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CellFissionEnergyDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39;neutron&#39;</span><span class="p">,</span>
                <span class="n">cards</span><span class="p">,</span> <span class="n">card_type</span><span class="o">=</span><span class="s">&#39;cell&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellFissionEnergyDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span>
                <span class="s">&quot;Fission energy deposition&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellFissionEnergyDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span>
                <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CellPulseHeight"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellPulseHeight">[docs]</a><span class="k">class</span> <span class="nc">CellPulseHeight</span><span class="p">(</span><span class="n">IAverageTally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pulse height tally in cells. In MCNP, this is the **F8** card. For a</span>
<span class="sd">    charge deposition tally, see :py:class:`CellChargeDeposition`.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CellPulseHeight</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particles : str, list of str</span>
<span class="sd">            See :py:class:`ITally`. Multiple particles can be provided in a</span>
<span class="sd">            list of str. In MCNP, if only &#39;proton&#39;, or &#39;electron&#39; is</span>
<span class="sd">            specified, both are automatically included.</span>
<span class="sd">        cards : str name of :py:class:`Cell`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, alternative units are used for the tally. In MCNP, the</span>
<span class="sd">            default units are pulses and the alternative units are MeV.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in cell &#39;cA&#39; and cell &#39;cB&#39; for both</span>
<span class="sd">        protons and electrons, and requests units of MeV::</span>

<span class="sd">            tally = CellPulseHeight(&#39;fuel&#39;, [&#39;proton&#39;, &#39;electron&#39;], [&#39;cA&#39;,</span>
<span class="sd">                    &#39;cB&#39;], alt_units=True)</span>

<span class="sd">        See base classes for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CellPulseHeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span>
                                              <span class="n">card_type</span><span class="o">=</span><span class="s">&#39;cell&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellPulseHeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Pulse height&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellPulseHeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">,</span>
                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span>

    <span class="nd">@particle.setter</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c"># Copied from CellEnergyDeposition.particle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="CellChargeDeposition"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellChargeDeposition">[docs]</a><span class="k">class</span> <span class="nc">CellChargeDeposition</span><span class="p">(</span><span class="n">CellPulseHeight</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Charge deposition tally in cells. In MCNP, this is the **+F8** card. No</span>
<span class="sd">    alternative units are available.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.CellChargeDeposition</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO it doesn&#39;t make sense that the user can provide the particle type</span>
    <span class="c"># here, at least for MCNP.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particles : str, list of str</span>
<span class="sd">            See :py:class:`ITally`. Multiple particles can be provided in a</span>
<span class="sd">            list of str. In MCNP, if only &#39;proton&#39;, or &#39;electron&#39; is</span>
<span class="sd">            specified, both are automatically included.</span>
<span class="sd">        cards : str name of :py:class:`Cell`, OR :py:class:`pyne.simplesim.nestedgeom.IUnit`, list, list of lists</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>
<span class="sd">        average : bool, optional</span>
<span class="sd">            See :py:class:`IAverageTally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests the tally in cell &#39;cA&#39; and cell &#39;cB&#39; for both</span>
<span class="sd">        protons and electrons::</span>

<span class="sd">            tally = CellChargeDeposition(&#39;fuel&#39;, [&#39;proton&#39;, &#39;electron&#39;], </span>
<span class="sd">                    [&#39;cA&#39;, &#39;cB&#39;])</span>

<span class="sd">        See base classes for more examples.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CellChargeDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cards</span><span class="p">,</span>
                                                   <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellChargeDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Charge deposition&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellChargeDeposition</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                                                      <span class="n">pre</span><span class="o">=</span><span class="s">&#39;+&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IDetector"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IDetector">[docs]</a><span class="k">class</span> <span class="nc">IDetector</span><span class="p">(</span><span class="n">ITally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the detector. Abstract base class for detector</span>
<span class="sd">    tallies.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mcnp_num</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">args_per_set</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particles : str, list of str</span>
<span class="sd">            See :py:class:`ITally`. In MCNP, this tally is only for neutrons and</span>
<span class="sd">            photons.</span>
<span class="sd">        sep_direct : bool, optional (default: True)</span>
<span class="sd">            In MCNP, the direct contribution to the tally is printed</span>
<span class="sd">            separately. Set to False to disable the separate printing. </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sep_direct</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;sep_direct&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_args_per_set</span> <span class="o">=</span> <span class="n">args_per_set</span>
        <span class="k">for</span> <span class="n">i_set</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args_per_set</span><span class="p">):</span>
            <span class="n">i_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_args_per_set</span> <span class="o">*</span> <span class="n">i_set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_start</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_args_per_set</span><span class="p">])</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">IDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">post</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">det</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">detectors</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="n">det</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detectors</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;;&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;; direct contrib is {0}separate.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sep_direct</span> <span class="k">else</span> <span class="s">&#39;not &#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>
    
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">IDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                
        <span class="k">for</span> <span class="n">det</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">detectors</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">det</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">detectors</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">string</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">*</span> <span class="s">&quot; &quot;</span>
            <span class="k">else</span><span class="p">:</span>                        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="s">&quot; &quot;</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">det</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sep_direct</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ND&quot;</span>
        <span class="k">return</span> <span class="n">string</span>
    
    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">detectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detectors</span>

    <span class="nd">@detectors.setter</span>
    <span class="k">def</span> <span class="nf">detectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_detectors</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sep_direct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sep_direct</span>

    <span class="nd">@sep_direct.setter</span>
    <span class="k">def</span> <span class="nf">sep_direct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sep_direct</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="PointDetector"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.PointDetector">[docs]</a><span class="k">class</span> <span class="nc">PointDetector</span><span class="p">(</span><span class="n">IDetector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A point detector tally. In MCNP, this is the **F5** card. This is not to</span>
<span class="sd">    be confused with the more general use of the term `Detector` in Serpent.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.PointDetector</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Point</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Point&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;pos&#39;</span><span class="p">,</span> <span class="s">&#39;soe_rad&#39;</span><span class="p">,</span> <span class="s">&#39;soe_units&#39;</span><span class="p">])</span>
    <span class="sd">&quot;&quot;&quot;Named tuple with which input entries are stored.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particles : str, list of str</span>
<span class="sd">            See :py:class:`ITally`. In MCNP, this tally is only for neutrons and</span>
<span class="sd">            photons.</span>
<span class="sd">        position : 3-element list, or :py:class:`np.array`</span>
<span class="sd">            Location of the point detector.</span>
<span class="sd">        soe_radius : float</span>
<span class="sd">            Radius of the sphere of exclusion.</span>
<span class="sd">        soe_units : str</span>
<span class="sd">            Units for the radius of the sphere of exclusion. Either &#39;cm&#39; or</span>
<span class="sd">            &#39;mfp&#39; for mean free paths.</span>
<span class="sd">        *args : position, soe_radius, soe_units, ...</span>
<span class="sd">            To request more than one detector, supply the last 3 arguments for</span>
<span class="sd">            the additional detectors. See examples. This can also be done using</span>
<span class="sd">            :py:meth:`add`.</span>
<span class="sd">        sep_direct : bool, optional</span>
<span class="sd">            See :py:class:`IDetector`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, Tally is additionally weighted by particle energy.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following creates a single point detector at the origin, without a</span>
<span class="sd">        sphere of exclusion::</span>

<span class="sd">            det = PointDetector(&#39;point&#39;, &#39;neutron&#39;, [0, 0, 0], 0, &#39;cm&#39;)</span>

<span class="sd">        The following creates a detector at (1, 1, 1) cm with a sphere of</span>
<span class="sd">        exclusion with a radius of 1 cm, where we have imported :py:mod:`numpy`</span>
<span class="sd">        as ``np``)::</span>

<span class="sd">            det = PointDetector(&#39;point&#39;, &#39;neutron&#39;, np.array([1, 1, 1]), 1,</span>
<span class="sd">                    &#39;cm&#39;)</span>

<span class="sd">        The radius for the sphere of exclusion here is 3 mfp::</span>

<span class="sd">            det = PointDetector(&#39;point&#39;, &#39;neutron&#39;, [1, 0, 0], 3, &#39;mfp&#39;)</span>

<span class="sd">        This is an example of requesting two point detectors::</span>
<span class="sd">        </span>
<span class="sd">            det = PointDetector(&#39;point&#39;, &#39;photon&#39;, [0, 0, 0],  0, &#39;cm&#39;,</span>
<span class="sd">                                                   [1, 0, 0], 3, &#39;mfp&#39;)</span>

<span class="sd">        Here, it is requested that the direct contribution is not tallied</span>
<span class="sd">        separately and that alternative units are used for the output::</span>

<span class="sd">            det = PointDetector(&#39;point&#39;, &#39;photon&#39;, [0, 0, 0], 0, &#39;cm&#39;,</span>
<span class="sd">                    sep_direct=False, alt_units=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PointDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="PointDetector.add"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.PointDetector.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">soe_radius</span><span class="p">,</span> <span class="n">soe_units</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : 3-element list, or :py:class:`np.array`</span>
<span class="sd">        soe_radius : float</span>
<span class="sd">        soe_units : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The last example above can also be achieved by the following::</span>

<span class="sd">            det = PointDetector(&#39;point&#39;, &#39;photon&#39;, sep_direct=False,</span>
<span class="sd">                    alt_units=True)</span>
<span class="sd">            det.add([0, 0, 0], 0, &#39;cm&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">soe_units</span> <span class="o">!=</span> <span class="s">&#39;cm&#39;</span> <span class="ow">and</span> <span class="n">soe_units</span> <span class="o">!=</span> <span class="s">&#39;mfp&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The input ``soe_units`` must be &#39;cm&#39; or &quot;</span>
                    <span class="s">&quot;&#39;mfp&#39;. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">soe_units</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectors</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">soe_radius</span><span class="p">,</span> <span class="n">soe_units</span><span class="p">)]</span>
        </div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PointDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Point detector&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">det</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot; point ({0[0]:g}, {0[1]:g}, {0[2]:g}) cm, radius &quot;</span>
                <span class="s">&quot;{1:g} {2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_rad</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_units</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PointDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">det</span><span class="p">):</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;{0} {0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">soe_rad</span> <span class="o">*</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_units</span> <span class="o">==</span> <span class="s">&#39;mfp&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">),))</span>

</div>
<div class="viewcode-block" id="RingDetector"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RingDetector">[docs]</a><span class="k">class</span> <span class="nc">RingDetector</span><span class="p">(</span><span class="n">IDetector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A ring detector tally. In MCNP, this is the **F5a** card. This is not to</span>
<span class="sd">    be confused with the more general use of the term `Detector` in Serpent.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.RingDetector</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Ring</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Ring&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s">&#39;pos&#39;</span><span class="p">,</span> <span class="s">&#39;rad&#39;</span><span class="p">,</span> <span class="s">&#39;soe_rad&#39;</span><span class="p">,</span> <span class="s">&#39;soe_units&#39;</span><span class="p">])</span>
    <span class="sd">&quot;&quot;&quot;Named tuple with which input entries are stored.&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="n">cartesian_axis</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ITally`.</span>
<span class="sd">        particles : str, list of str</span>
<span class="sd">            See :py:class:`ITally`. In MCNP for this tally, only neutrons and</span>
<span class="sd">            photons are allowed.</span>
<span class="sd">        cartesian_axis : str</span>
<span class="sd">            Cartesian axis string (&#39;x&#39;, &#39;X&#39;, &#39;y&#39;, &#39;Y&#39;, &#39;z&#39;, or &#39;Z&#39;).</span>
<span class="sd">        position : float</span>
<span class="sd">            Position along the cartesian axis.</span>
<span class="sd">        radius : float</span>
<span class="sd">            Radius of the ring.</span>
<span class="sd">        soe_radius : float</span>
<span class="sd">            Radius of the sphere of exclusion.</span>
<span class="sd">        soe_units : float</span>
<span class="sd">            Units for the radius of the sphere of exclusion.</span>
<span class="sd">        *args : position, radius, soe_radius, soe_units, ...</span>
<span class="sd">            To request more than one detector, supply the last 4 arguments for</span>
<span class="sd">            the additional detectors. See examples. This can also be done using</span>
<span class="sd">            :py:meth:`add`.</span>
<span class="sd">        sep_direct : bool, optional</span>
<span class="sd">            See :py:class:`IDetector`.</span>
<span class="sd">        alt_units : bool, optional</span>
<span class="sd">            If True, Tally is additionally weighted by particle energy.</span>
<span class="sd">            See :py:class:`ITally`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following creates a single ring detector at x = 10.0 cm, with a</span>
<span class="sd">        2.0 cm radius, and a 1.0 cm radius sphere of exclusion::</span>

<span class="sd">            det = RingDetector(&#39;ring&#39;, &#39;neutron&#39;, &#39;x&#39;, 10.0, 2.0,  1.0, &#39;cm&#39;)</span>

<span class="sd">        In the following, the sphere of exclusion has a radius of 1.0 mfp::</span>

<span class="sd">            det = RingDetector(&#39;ring&#39;, &#39;neutron&#39;, &#39;x&#39;, 10.0, 2.0, 1.0, &#39;mfp&#39;)</span>

<span class="sd">        This is an example of requesting two ring detectors::</span>

<span class="sd">            det = RingDetector(&#39;ring&#39;, &#39;neutron&#39;, &#39;y&#39;, 10.0, 2.0, 1.0, &#39;mfp&#39;,</span>
<span class="sd">                                                       20.0, 3.0, 1.0, &#39;cm&#39;)</span>

<span class="sd">        Here it is requested that the direct contribution is not tallied</span>
<span class="sd">        separately, and alternative units are used for the output::</span>
<span class="sd">        </span>
<span class="sd">            det = RingDetector(&#39;ring&#39;, &#39;neutron&#39;, &#39;x&#39;, 10.0, 2.0, 1.0, &#39;cm&#39;</span>
<span class="sd">                    sep_direct=False, alt_units=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RingDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">particles</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> 
                                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span> <span class="o">=</span> <span class="n">cartesian_axis</span>

<div class="viewcode-block" id="RingDetector.add"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.RingDetector.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">soe_radius</span><span class="p">,</span> <span class="n">soe_units</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        position : float</span>
<span class="sd">        radius : float</span>
<span class="sd">        soe_radius : float</span>
<span class="sd">        soe_units : float</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The last example above can be achieved with the following::</span>

<span class="sd">            det = RingDetector(&#39;ring&#39;, &#39;neutron&#39;, &#39;x&#39;, sep_direct=False,</span>
<span class="sd">                    alt_units=True)</span>
<span class="sd">            det.add(10.0, 2.0, 1.0, &#39;cm&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">soe_units</span> <span class="o">!=</span> <span class="s">&#39;cm&#39;</span> <span class="ow">and</span> <span class="n">soe_units</span> <span class="o">!=</span> <span class="s">&#39;mfp&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The input ``soe_units`` must be &#39;cm&#39; or &quot;</span>
                    <span class="s">&quot;&#39;mfp&#39;. User provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">soe_units</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectors</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Ring</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">soe_radius</span><span class="p">,</span> <span class="n">soe_units</span><span class="p">)]</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RingDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Ring detector&quot;</span><span class="p">,</span>
                <span class="s">&quot; along {0} axis.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">det</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot; ring {0} = {1:g} cm, radius {2:g} cm, s.o.e. &quot;</span>
                <span class="s">&quot;radius {3:g} {4}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span>
                    <span class="n">det</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_rad</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_units</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RingDetector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">,</span>
                <span class="n">post</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cartesian_axis</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">det</span><span class="p">):</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;{0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="p">(</span><span class="n">det</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">rad</span><span class="p">,</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_rad</span> <span class="o">*</span> <span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">det</span><span class="o">.</span><span class="n">soe_units</span> <span class="o">==</span> <span class="s">&#39;mfp&#39;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cartesian_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cartesian_axis</span>

    <span class="nd">@cartesian_axis.setter</span>
    <span class="k">def</span> <span class="nf">cartesian_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cartesian_axis</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="EnergyGrid"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.EnergyGrid">[docs]</a><span class="k">class</span> <span class="nc">EnergyGrid</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Energy grid for tallies. In MCNP, this is the **E** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.EnergyGrid</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO make this a unique-by-tally card.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">tally</span><span class="p">,</span> <span class="n">energies</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        tally : str name of :py:class:`ITally`, None</span>
<span class="sd">            The name of the tally for which this energy grid should apply. If</span>
<span class="sd">            requesting for this grid to apply to all tallies, then this is</span>
<span class="sd">            None.</span>
<span class="sd">        energies : list, :py:class:`np.array`</span>
<span class="sd">            The upper bounds of the energy groups.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following energy grid applies to all tallies::</span>

<span class="sd">            egrid = EnergyGrid(&#39;grid0&#39;, None, [1e-4, 1, 100e3, 10e6])</span>

<span class="sd">        The following applies to tally &#39;tallyA&#39;::</span>

<span class="sd">            egrid = EnergyGrid(&#39;grid0&#39;, &#39;tallyA&#39;,</span>
<span class="sd">                    np.array([1e-4, 1, 100e3, 10e6]))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EnergyGrid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tally</span> <span class="o">=</span> <span class="n">tally</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energies</span> <span class="o">=</span> <span class="n">energies</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Energy grid {0!r} for &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;all tallies&quot;</span>
        <span class="k">else</span><span class="p">:</span>                  <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;tally {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tally</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;: {0} groups.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energies</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;E{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">sim</span><span class="o">.</span><span class="n">tally_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tally</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tally</span> <span class="k">else</span> <span class="s">&quot;0&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">energies</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="p">(</span><span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">float_format</span><span class="p">)</span> <span class="o">%</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">energies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_energies</span>

    <span class="nd">@energies.setter</span>
    <span class="k">def</span> <span class="nf">energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_energies</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Comment"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Comment">[docs]</a><span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="Mode"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Mode">[docs]</a><span class="k">class</span> <span class="nc">Mode</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="NeutronPhysics"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.NeutronPhysics">[docs]</a><span class="k">class</span> <span class="nc">NeutronPhysics</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="PhotonPhysics"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.PhotonPhysics">[docs]</a><span class="k">class</span> <span class="nc">PhotonPhysics</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="ElectronPhysics"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ElectronPhysics">[docs]</a><span class="k">class</span> <span class="nc">ElectronPhysics</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="ProtonPhysics"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ProtonPhysics">[docs]</a><span class="k">class</span> <span class="nc">ProtonPhysics</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="Transformation"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Transformation">[docs]</a><span class="k">class</span> <span class="nc">Transformation</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A coordinate transformation. In MCNP, this is the **TR** card. MCNP</span>
<span class="sd">    allows the specification of less than 9 values in the rotation matrix; this</span>
<span class="sd">    is not supported here. Note that if generating an input for MCNP, this card</span>
<span class="sd">    needs to be added to the simulation by</span>
<span class="sd">    :py:meth:`pyne.simplesim.definition.MCNPSimulation.add_transformation`.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Transformation</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO support for MCNP&#39;s less-than-9-element transformation matrices.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">displacement</span><span class="p">,</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">aux_in_main</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">degrees</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        displacement : 3-element list, :py:class:`np.array`, float [cm]</span>
<span class="sd">            Displacement vector.</span>
<span class="sd">        rotation : 3 x 3 list, :py:class:`np.array`, :py:class:`np.matrix`</span>
<span class="sd">            Rotation matrix.</span>
<span class="sd">        aux_in_main : bool, optional</span>
<span class="sd">            The displacement vector is in the main coordinate system and points</span>
<span class="sd">            to the origin of the transformed/auxiliary coordinate system. If</span>
<span class="sd">            False, then the displacement vector is in the</span>
<span class="sd">            transformed/auxiliary coordiante system and points to the origin of</span>
<span class="sd">            the main coordinate system.</span>
<span class="sd">        degrees : bool, optional</span>
<span class="sd">            If True, then the elements of the rotation matrix are in degrees.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Here&#39;s a number of examples::</span>

<span class="sd">            trans = Transformation(&#39;trans1&#39;, [1, 2, 3],</span>
<span class="sd">                    [[4, 5, 6], [7, 8, 9], [10, 11, 12]])</span>
<span class="sd">            trans = Transformation(&#39;trans1&#39;, [1, 2, 3],</span>
<span class="sd">                    np.array([[4, 5, 6], [7, 8, 9], [10, 11, 12]]))</span>
<span class="sd">            trans = Transformation(&#39;trans1&#39;, [1, 2, 3],</span>
<span class="sd">                    np.matrix([[4, 5, 6], [7, 8, 9], [10, 11, 12]]))</span>
<span class="sd">            trans = Transformation(&#39;trans1&#39;, [1, 2, 3],</span>
<span class="sd">                    [[4, 5, 6], [7, 8, 9], [10, 11, 12]],</span>
<span class="sd">                    aux_in_main=False)</span>
<span class="sd">            trans = Transformation(&#39;trans1&#39;, [1, 2, 3],</span>
<span class="sd">                    [[4, 5, 6], [7, 8, 9], [10, 11, 12]],</span>
<span class="sd">                    degrees=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Transformation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">displacement</span> <span class="o">=</span> <span class="n">displacement</span>
        <span class="c"># For numpy matrices.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">rotation</span><span class="p">,</span> <span class="s">&#39;tolist&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>                           <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aux_in_main</span> <span class="o">=</span> <span class="n">aux_in_main</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="o">=</span> <span class="n">degrees</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;Transformation {0!r}: pos. of {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_in_main</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;aux origin in main&quot;</span>
        <span class="k">else</span><span class="p">:</span>                <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;main origin in aux&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ({0[0]:g}, {0[1]:g}, {0[2]:g}) cm,&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">displacement</span><span class="p">)</span>
        <span class="n">dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}&#39; &lt;{1:g}, {2:g}, {3:g}&gt;{4}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dirs</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span>
                    <span class="s">&quot; deg&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0}TR{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;*&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">degrees</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="n">sim</span><span class="o">.</span><span class="n">transformation_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">):</span> 
        <span class="c"># Needed by CellMCNP.</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot; {0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displacement</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i_col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation</span><span class="p">[</span><span class="n">i_row</span><span class="p">][</span><span class="n">i_col</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot; 1&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_in_main</span> <span class="k">else</span> <span class="s">&quot; -1&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displacement</span>
    
    <span class="nd">@displacement.setter</span>
    <span class="k">def</span> <span class="nf">displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displacement</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span>
    
    <span class="nd">@rotation.setter</span>
    <span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aux_in_main</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aux_in_main</span>
    
    <span class="nd">@aux_in_main.setter</span>
    <span class="k">def</span> <span class="nf">aux_in_main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aux_in_main</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ICellMod"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICellMod">[docs]</a><span class="k">class</span> <span class="nc">ICellMod</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for cards that</span>
<span class="sd">    can be specified in MCNP on both the cell card or in the data block.  All</span>
<span class="sd">    subclasses are unique, have a ``cell`` property, and have a similar form.</span>
<span class="sd">    Entries for a given cell can be modified by providing an input for the same</span>
<span class="sd">    cell.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># The mcnp() method of this class implements the jump feature, which</span>
    <span class="c"># ICellModParticle does not.</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">n_args_per_cell</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;\</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICard`.</span>
<span class="sd">        n_args_per_cell : int</span>
<span class="sd">            The number of arguments the subclass expects per cell.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span> <span class="o">=</span> <span class="n">n_args_per_cell</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_args_per_cell</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;The length of ``*args`` must be a multiple &quot;</span>
                    <span class="s">&quot;of {0}. Length is {1}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_args_per_cell</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_process_varargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span><span class="p">):</span>
            <span class="n">i_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span> <span class="o">*</span> <span class="n">i_cell</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_start</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span><span class="p">])</span>

    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="ICellMod.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICellMod.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one. See subclasses.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">cell</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">+=</span> <span class="p">[</span><span class="n">cell</span><span class="p">]</span>
</div>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">poststr</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0} {1!r}:{2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">poststr</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; cell {0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">keystring</span><span class="p">):</span>
        <span class="c"># TODO this ordering might not be correct, particularly once we add</span>
        <span class="c"># support for universes, etc.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keystring</span><span class="p">)</span>
        <span class="c"># TODO this should loop through in the print order.</span>
        <span class="c">#</span>
        <span class="c"># `gathering` empty cells (cells for which no value is given).</span>
        <span class="n">empty_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">empty_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}J&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">empty_count</span><span class="p">)</span>
                    <span class="n">empty_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">empty_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c"># Account for running out of cells with empty baggage.</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}J&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">empty_count</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span>

    <span class="nd">@cells.setter</span>
    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Expected cell name, got {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Universes"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Universes">[docs]</a><span class="k">class</span> <span class="nc">Universes</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Universe names for each cell. Unique card with name `universes`. In</span>
<span class="sd">    MCNP, this is the **U** card. The user can initialize this card without</span>
<span class="sd">    providing any universe names.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Universes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which a universe name is being provided.</span>
<span class="sd">        univ_name : str</span>
<span class="sd">            The name of the universe that the cell is a part of.</span>
<span class="sd">        truncate : bool</span>
<span class="sd">            By default, the cell is truncated by the boundary of higher-level</span>
<span class="sd">            cells. Not an optional argument, but is typically True.</span>
<span class="sd">        *args : cell, univ_name, truncate, ...</span>
<span class="sd">            To provide universe names for more than one cell, supply the last</span>
<span class="sd">            three arguments for the other cells. See example. This can also be</span>
<span class="sd">            done using :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following adds the cell cards with names &#39;pincell&#39; and</span>
<span class="sd">        &#39;coolantcell&#39; to the universe &#39;unitcell&#39;. All other cell cards, as of</span>
<span class="sd">        yet, are then part of the real world universe::</span>

<span class="sd">            uni = Universes(&#39;pincell&#39;, &#39;unitcell&#39;, True,</span>
<span class="sd">                            &#39;coolantcell&#39;, &#39;unitcell&#39;, True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Universes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;universes&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncates</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Universes.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Universes.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">univ_name</span><span class="p">,</span> <span class="n">truncate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        univ_name : str</span>
<span class="sd">        truncate : bool</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>

<span class="sd">            uni = Universes()</span>
<span class="sd">            uni.set(&#39;pincell&#39;, &#39;unitcell&#39;, True)</span>
<span class="sd">            uni.set(&#39;coolantcell&#39;, &#39;unitcell&#39;, True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Universes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">univ_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncates</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">truncate</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Universes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Universes&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0} ({1}truncated)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">],</span>
                <span class="s">&quot;&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncates</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="k">else</span> <span class="s">&quot;not &quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Universes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;U&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">universes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;This card has not been added to the simulation.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">universe_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncates</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">univ_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_univ_names</span>

    <span class="nd">@univ_names.setter</span>
    <span class="k">def</span> <span class="nf">univ_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_univ_names</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">truncates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncates</span>

    <span class="nd">@truncates.setter</span>
    <span class="k">def</span> <span class="nf">truncates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_truncates</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Fill"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Fill">[docs]</a><span class="k">class</span> <span class="nc">Fill</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Allows the user to fill certain cells with a universe or lattice. Unique</span>
<span class="sd">    card with name `fill`. In MCNP, this is the **FILL** card. The user can</span>
<span class="sd">    initialize this card without providing any inputs. </span>
<span class="sd">    </span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Fill</span>

<span class="sd">    Limitations:</span>

<span class="sd">    - Combining transformations with the fill is not supported.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># The following is no longer true:</span>
    <span class="c">#The :py:class:`Universe`</span>
    <span class="c">#card, or keywords on the :py:class:`Cell` card, must be added to the</span>
    <span class="c">#simulation before this card. Otherwise, the code will not be able to find</span>
    <span class="c">#the universes specified on this card.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell being filled by a universe.</span>
<span class="sd">        univ_name : str</span>
<span class="sd">            The name of the universe filling this cell.</span>
<span class="sd">        *args : cell, univ_name, ...</span>
<span class="sd">            To fill more than one cell, supply the last 2 arguments for the</span>
<span class="sd">            other cells. See examples. This can also be done using</span>
<span class="sd">            :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        If &#39;unit&#39; and &#39;cellB&#39; are names of cells and &#39;unitcell&#39; and &#39;otheruniv`</span>
<span class="sd">        are the names of universes, the user can do the following::</span>

<span class="sd">            fill = Fill(&#39;unit&#39;, &#39;unitcell&#39;, &#39;cellB&#39;, &#39;otheruniv&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Fill</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;fill&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Fill.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Fill.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">univ_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        univ_name : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>

<span class="sd">            fill = Fill()</span>
<span class="sd">            fill.set(&#39;unit&#39;, &#39;unitcell&#39;)</span>
<span class="sd">            fill.set(&#39;cellB&#39;, &#39;otheruniv&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Fill</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">univ_name</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Fill</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Fill&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Fill</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;FILL&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">universe_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">univ_names</span><span class="p">[</span><span class="n">cell</span><span class="p">]))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">univ_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_univ_names</span>

    <span class="nd">@univ_names.setter</span>
    <span class="k">def</span> <span class="nf">univ_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_univ_names</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Lattice"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Lattice">[docs]</a><span class="k">class</span> <span class="nc">Lattice</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets cells to be lattice cells. Unique card with name `lattice`. In MCNP,</span>
<span class="sd">    this is the **LAT** card. The user can initialize this card without</span>
<span class="sd">    providing any inputs.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Lattice</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">acceptable</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hexahedra&#39;</span><span class="p">,</span> <span class="s">&#39;hexagonal&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which the lattice setting is being</span>
<span class="sd">            provided.</span>
<span class="sd">        setting : str</span>
<span class="sd">            &#39;hexahedra&#39;, or &#39;hexagonal&#39;.</span>
<span class="sd">        *args : cell, setting, ...</span>
<span class="sd">            To provide lattice settings for more than one cell, supply the last</span>
<span class="sd">            2 arguments for the other cells. This can also be done using</span>
<span class="sd">            :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following shows a typical usage, where &#39;pincell&#39; is a cell</span>
<span class="sd">        representing a fuel pin, &#39;coolantcell&#39; is a cell representing the</span>
<span class="sd">        coolant flowing around the pin, &#39;unit&#39; is a cell filled with the</span>
<span class="sd">        &#39;unitcell&#39; universe, and is made into a hexahedra lattice::</span>
<span class="sd">            </span>
<span class="sd">            uni = Universes()</span>
<span class="sd">            uni.set(&#39;pincell&#39;, &#39;unitcell&#39;, True)</span>
<span class="sd">            uni.set(&#39;coolantcell&#39;, &#39;unitcell&#39;, True)</span>
<span class="sd">            fill = Fill(&#39;unit&#39;, &#39;unitcell&#39;)</span>
<span class="sd">            lat = Lattice(&#39;unit&#39;, &#39;hexahedra&#39;)</span>

<span class="sd">        Inputs for multiple cells can be provided::</span>

<span class="sd">            lat = Lattice(&#39;cellA&#39;, &#39;hexahedra&#39;, &#39;cellB&#39;, &#39;hexagonal&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Lattice</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;lattice&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Lattice.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Lattice.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">setting</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        setting : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>

<span class="sd">            lat = Lattice()</span>
<span class="sd">            lat.set(&#39;cellA&#39;, &#39;hexahedra&#39;)</span>
<span class="sd">            lat.set(&#39;cellB&#39;, &#39;hexagonal&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Lattice</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Lattice</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Lattice&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Lattice</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;LAT&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;hexahedra&#39;</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span>

    <span class="nd">@settings.setter</span>
    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">acceptable</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;``setting`` {0!r} not acceptable.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Volume"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Volume">[docs]</a><span class="k">class</span> <span class="nc">Volume</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cell volumes. Unique card with name `volume`. In MCNP, this is the</span>
<span class="sd">    **VOL** card. The user can initialize this card without providing any cell</span>
<span class="sd">    volumes.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Volume</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which the volume is being provided.</span>
<span class="sd">        vol : float [centimeters^3]</span>
<span class="sd">            Volume of the cell.</span>
<span class="sd">        *args : cell, vol, ...</span>
<span class="sd">            To provide volumes for more than one cell, supply the last two</span>
<span class="sd">            arguments for the other cells. See examples. This can also be done</span>
<span class="sd">            using :py:meth:`set`.</span>
<span class="sd">        manual : bool, optional (default: False)</span>
<span class="sd">            If set to True, the code will not attempt to calculate cell volumes</span>
<span class="sd">            on its own.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following are examples of the usage of this card::</span>

<span class="sd">            vol = Volume(&#39;cellA&#39;, 1)</span>
<span class="sd">            vol = Volume(&#39;cellA&#39;, 1, &#39;cellB&#39;, 2, manual=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Volume</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;volume&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manual</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;manual&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vols</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Volume.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Volume.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">vol</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        vol : float</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>

<span class="sd">            vol = Volume(manual=True)</span>
<span class="sd">            vol.set(&#39;cellA&#39;, 1)</span>
<span class="sd">            vol.set(&#39;cellB&#39;, 2)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            vol.set(&#39;cellB&#39;, 3)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Volume</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vols</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">vol</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">manual</span><span class="p">:</span> <span class="n">poststr</span> <span class="o">=</span> <span class="s">&quot; (all manual)&quot;</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">poststr</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Volume</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Volume&quot;</span><span class="p">,</span> <span class="n">poststr</span><span class="p">)</span>
 
    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0:g} cm^3&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vols</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;VOL&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">manual</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; NO&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Volume</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">vols</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">manual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manual</span>

    <span class="nd">@manual.setter</span>
    <span class="k">def</span> <span class="nf">manual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manual</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vols</span>

    <span class="nd">@vols.setter</span>
    <span class="k">def</span> <span class="nf">vols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vols</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Area"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Area">[docs]</a><span class="k">class</span> <span class="nc">Area</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cell surface areas. Unique card with name `area`. In MCNP, this is the</span>
<span class="sd">    **AREA** card. The user can initialize this card without providing any cell</span>
<span class="sd">    areas.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Area</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which the area is being provided.</span>
<span class="sd">        area : float [centimeters^2]</span>
<span class="sd">            Surface area of the cell.</span>
<span class="sd">        *args : cell, area, ...</span>
<span class="sd">            To provide areas for more than one cell, suppy the last two</span>
<span class="sd">            arguments for the other cells. See examples. This can also be</span>
<span class="sd">            done using :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The follow are examples of the usage of this card::</span>

<span class="sd">            area = Area(&#39;cellA&#39;, 10)</span>
<span class="sd">            area = Area(&#39;cellA&#39;, 10, &#39;cellB&#39;, 20)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;area&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areas</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Area.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Area.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">area</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        area : float [centimeters^2]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>

<span class="sd">            area = Area()</span>
<span class="sd">            area.set(&#39;cellA&#39;, 10)</span>
<span class="sd">            area.set(&#39;cellB&#39;, 20)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            area.set(&#39;cellB&#39;, 30)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">areas</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">area</span>
 </div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Area&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0:g} cm^2&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areas</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;AREA&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">areas</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">areas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_areas</span>

    <span class="nd">@areas.setter</span>
    <span class="k">def</span> <span class="nf">areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_areas</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="FissionTurnoff"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.FissionTurnoff">[docs]</a><span class="k">class</span> <span class="nc">FissionTurnoff</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fission turnoff options. Unique card with name `fissionturnoff`. In</span>
<span class="sd">    MCNP, this is the **NONU** card. If no arguments are provided, then the</span>
<span class="sd">    setting of &#39;capture-gamma&#39; is applied to all cells.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.FissionTurnoff</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which input is provided.</span>
<span class="sd">        setting : str</span>
<span class="sd">            One of the following 3 strings: &#39;capture-gamma&#39; to request fissions</span>
<span class="sd">            to count as capture, but still cause gamma radiation; &#39;real-gamma&#39;</span>
<span class="sd">            for fission to actually occur and to also produce gamma radiation;</span>
<span class="sd">            and &#39;capture-nogamma&#39; for fission to be counted as capture, and to</span>
<span class="sd">            not release gammas.</span>
<span class="sd">        *args : cell, setting, ...</span>
<span class="sd">            To provide a setting for more than one cell, supply the last two</span>
<span class="sd">            arguments for the other cells. See examples. This can also be done</span>
<span class="sd">            using :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following sets all cells to the &#39;capture-gamma&#39; setting::</span>

<span class="sd">            fto = FissionTurnoff()</span>

<span class="sd">        The followings specifies settings for more than one cell::</span>

<span class="sd">            fto = FissionTurnoff(&#39;cellA&#39;, &#39;real-gamma&#39;, &#39;cellB&#39;,</span>
<span class="sd">                    &#39;capture-nogamma&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FissionTurnoff</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;fissionturnoff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="FissionTurnoff.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.FissionTurnoff.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">setting</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        setting : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>
<span class="sd">        </span>
<span class="sd">            fto = FissionTurnoff()</span>
<span class="sd">            fto.set(&#39;cellA&#39;, &#39;real-gamma&#39;)</span>
<span class="sd">            fto.set(&#39;cellB&#39;, &#39;capture-nogamma&#39;)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            fto.set(&#39;cellB&#39;, &#39;real-gamma&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FissionTurnoff</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span>
 </div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Fission turnoff&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot; &#39;fissionturnoff&#39;: capture-gamma for all cells.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">FissionTurnoff</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Fission turnoff&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;NONU&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">string</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">FissionTurnoff</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;capture-gamma&#39;</span><span class="p">:</span>     <span class="k">return</span> <span class="s">&quot;0&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;real-gamma&#39;</span><span class="p">:</span>      <span class="k">return</span> <span class="s">&quot;1&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;capture-nogamma&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot;2&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected &#39;capture-gamma&#39;, &#39;real-gamma&#39;, &quot;</span>
                    <span class="s">&quot;&#39;capture-nogamma&#39;. User provided {0!r}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">cell</span><span class="p">]))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span>

    <span class="nd">@settings.setter</span>
    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="PhotonWeight"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.PhotonWeight">[docs]</a><span class="k">class</span> <span class="nc">PhotonWeight</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Controls production of neutron-induced photons through particle weight.</span>
<span class="sd">    Unique card with name `photonweight`. In MCNP, this is the **PWT** card.</span>
<span class="sd">    Unlike with other subclasses of :py:class:`ICellMod` and</span>
<span class="sd">    :py:class:`ICellModParticle`, this class cannot be formed via only the</span>
<span class="sd">    constructor; the :py:meth:`set` method must be used.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.PhotonWeight</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Weight</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Weight&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;setting&#39;</span><span class="p">,</span> <span class="s">&#39;pre_weight&#39;</span><span class="p">])</span>
    <span class="sd">&quot;&quot;&quot;Named tuple with which input entries are stored.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># The reason for the basic constructor is that it is important that I</span>
        <span class="c"># use an optional keyword argument here, and so a variable argument</span>
        <span class="c"># list is not so pleasant to work with.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PhotonWeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;photonweight&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<div class="viewcode-block" id="PhotonWeight.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.PhotonWeight.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">setting</span><span class="p">,</span> <span class="n">pre_weight</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which the photon weight is being provided.</span>
<span class="sd">        setting : str/float</span>
<span class="sd">            The setting &#39;off&#39; turns of photon production, the setting &#39;one&#39;</span>
<span class="sd">            produces one photon per neutron collision if photon production is</span>
<span class="sd">            enabled, and if a float is provided, it is used to compute a weight</span>
<span class="sd">            threshold for the creation of photons.</span>
<span class="sd">        pre_weight : bool, optional</span>
<span class="sd">            If True, then the weight threshold incorporates the starting weight</span>
<span class="sd">            of the neutron that induced the photon. This argument is ignored if</span>
<span class="sd">            ``setting`` is of type ``str``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The card is first initialized, after which weights can be added using</span>
<span class="sd">        this method. The following turns off neutron-induced photon</span>
<span class="sd">        production for &#39;cellA&#39;::</span>

<span class="sd">            pw = PhotonWeight()</span>
<span class="sd">            pw.set(&#39;cellA&#39;, &#39;off&#39;)</span>

<span class="sd">        The following requests that one photon is produced for every neutron</span>
<span class="sd">        collision in &#39;cellB&#39;::</span>

<span class="sd">            pw.set(&#39;cellB&#39;, &#39;one&#39;)</span>

<span class="sd">        An explicit weight can be given, as well::</span>

<span class="sd">            pw.set(&#39;cellC&#39;, 0.5)</span>

<span class="sd">        The starting neutorn weight can be incorporated in the weight</span>
<span class="sd">        threshold::</span>

<span class="sd">            pw.set(&#39;cellD&#39;, 0.5, pre_weight=True)</span>

<span class="sd">        Previously provided values may be modified later on::</span>

<span class="sd">            pw.set(&#39;cellD&#39;, 0.7, pre_weight=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PhotonWeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">setting</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span> <span class="ow">and</span> <span class="n">setting</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The weight must be non-negative.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Weight</span><span class="p">(</span><span class="n">setting</span><span class="p">,</span> <span class="n">pre_weight</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PhotonWeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Photon weight thresholds&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="n">setting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">setting</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">setting</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">setting</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot; {0:g}{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">setting</span><span class="p">,</span> 
                <span class="s">&quot; (pre-weighted)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">pre_weight</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No entries provided.&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;PWT&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">PhotonWeight</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="n">setting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">setting</span>
        <span class="c"># The following if-statement is for if setting is a float.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">pre_weight</span><span class="p">:</span> <span class="n">setting</span> <span class="o">=</span> <span class="o">-</span><span class="n">setting</span>
        <span class="k">if</span> <span class="n">setting</span> <span class="o">==</span> <span class="s">&#39;off&#39;</span><span class="p">:</span>   <span class="k">return</span> <span class="s">&quot;-1.0E6&quot;</span>
        <span class="k">elif</span> <span class="n">setting</span> <span class="o">==</span> <span class="s">&#39;one&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot;0&quot;</span>
        <span class="k">else</span><span class="p">:</span>                  <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="n">setting</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span>

    <span class="nd">@weights.setter</span>
    <span class="k">def</span> <span class="nf">weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weights</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="DetectorContribution"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DetectorContribution">[docs]</a><span class="k">class</span> <span class="nc">DetectorContribution</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Probability of contribution of cell to a detector. Unique card with name</span>
<span class="sd">    `detcontrib-&lt;detname&gt;`. In MCNP, this is the **PD** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.DetectorContribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">det_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        det_name : str</span>
<span class="sd">            Name of the detector (subclass of :py:class:`IDetector`) for which</span>
<span class="sd">            this card stores probabilities of contribution.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            The name of the cell for which the probability of contribution is</span>
<span class="sd">            being provided.</span>
<span class="sd">        prob : float</span>
<span class="sd">            Probability that this cell contributes to this detector.</span>
<span class="sd">        *args : cell, prob, ...</span>
<span class="sd">            To provide probabilities for more than one cell, supply the last</span>
<span class="sd">            two arguments for the other cells. See examples. This can also be</span>
<span class="sd">            done using :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Suppose a cell &#39;cellA&#39; and a detector &#39;det1&#39; have been</span>
<span class="sd">        defined and are in the simulation. Then, we can do the following::</span>

<span class="sd">            dc = DetectorContribution(&#39;det1&#39;, &#39;cellA&#39;, 0.5)</span>

<span class="sd">        or, if we also have a &#39;cellB&#39;:</span>

<span class="sd">            dc = DetectorContribution(&#39;det1&#39;, &#39;cellA&#39;, 0.5, &#39;cellB&#39;, 0.6)</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">det_name</span> <span class="o">=</span> <span class="n">det_name</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DetectorContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
                <span class="s">&#39;detcontrib-{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">det_name</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="DetectorContribution.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DetectorContribution.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        prob : float</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The last example above can be achieved by the following::</span>

<span class="sd">            dc = DetectorContribution(&#39;det1&#39;)</span>
<span class="sd">            dc.set(cellA, 0.5)</span>
<span class="sd">            dc.set(&#39;cellB&#39;, 0.6)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            dc.set(&#39;cellB&#39;, 0.7)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DetectorContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
 </div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Detector contribution&quot;</span> <span class="c"># to {0!r}&quot;.format(self.det_name)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DetectorContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c"># TODO exception if the detector doesn&#39;t exist.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;PD{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">tally_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">det_name</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DetectorContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span>
                <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probs</span>

    <span class="nd">@probs.setter</span>
    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probs</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="IUniqueParticle"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.IUniqueParticle">[docs]</a><span class="k">class</span> <span class="nc">IUniqueParticle</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for cards that</span>
<span class="sd">    are unique for a given particle.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO not passig any *args or **kwargs.</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pre_name : str</span>
<span class="sd">            First part of card :py:attr:`name`. Names are of the form</span>
<span class="sd">            ``&lt;pre_name&gt;-&lt;particle&gt;``.</span>
<span class="sd">        particle : str</span>
<span class="sd">            A particle string, taken from the keys of</span>
<span class="sd">            :py:attr:`Particle.mcnp_abbrev`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">IUniqueParticle</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
                <span class="s">&quot;{0}-{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pre_name</span><span class="p">,</span> <span class="n">particle</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">=</span> <span class="n">Particle</span><span class="p">(</span><span class="n">particle</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span>

    <span class="nd">@particle.setter</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Temperature"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Temperature">[docs]</a><span class="k">class</span> <span class="nc">Temperature</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Temperature of cells. Unique card with name `temperature`. If a time</span>
<span class="sd">    index is provided, the unique name is `temperature-idx&lt;index&gt;`. In MCNP, this</span>
<span class="sd">    is the **TMP** card and is used for the free gas thermal treatment. This</span>
<span class="sd">    card may require that :py:class:`TemperatureTimes` card is in the</span>
<span class="sd">    simulation.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Temperature</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO check if THTME card exists.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            Name of the cell for which the temperature is being specified.</span>
<span class="sd">        temp : float [Kelvin]</span>
<span class="sd">            Temperature of the cell. For MCNP, this is converted into MeV.</span>
<span class="sd">        *args : cell, temp, ...</span>
<span class="sd">            To provide the temperature for more than one cell, supply the last</span>
<span class="sd">            three arguments for the other cells. See examples. This can also be</span>
<span class="sd">            done with :py:meth:`set`.</span>
<span class="sd">        index : int, optional</span>
<span class="sd">            The index (starting at 1) of a time on the</span>
<span class="sd">            :py:class:`TemperatureTimes` card for which the temperatures are</span>
<span class="sd">            provided. If no :py:class:`TemperatureTimes` card is used, the user</span>
<span class="sd">            does not provide this input, and it defaults to ``None``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following are examples of the usage of this card::</span>

<span class="sd">            temp = Temperature(&#39;cellA&#39;, 600)</span>
<span class="sd">            temp = Temperature(&#39;cellA&#39;, 600, &#39;cellB&#39;, 900, index=2)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;temperature&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">name</span> <span class="o">+=</span> <span class="s">&#39;-idx{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Temperature</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temps</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Temperature.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Temperature.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        temp : float [Kelvin]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following does the same as the example above::</span>

<span class="sd">            temp = Temperature(index=2)</span>
<span class="sd">            temp.set(&#39;cellA&#39;, 600)</span>
<span class="sd">            temp.set(&#39;cellB&#39;, 900)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            temp.set(&#39;cellB&#39;, 950)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Temperature</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Temperature set as less than 200 K. &quot;</span>
                    <span class="s">&quot;Are you trying to specify temperature in degrees &quot;</span>
                    <span class="s">&quot;Celcius, etc.? User provided {0:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Temperature set as less than 1 K. &quot;</span>
                    <span class="s">&quot;Are you trying to specify temperature as &#39;kT&#39;? &quot;</span>
                    <span class="s">&quot;User provided {0:g}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temps</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># TODO get access to sim and show the actual time, not just the index.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Temperatures&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; for time index {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Temperature</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0:g} K&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temps</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;TMP&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Temperature</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temps</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kelvin2kT</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>

    <span class="nd">@index.setter</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">temps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temps</span>

    <span class="nd">@temps.setter</span>
    <span class="k">def</span> <span class="nf">temps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_temps</span> <span class="o">=</span> <span class="n">value</span>
</div>
<div class="viewcode-block" id="TemperatureTimes"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.TemperatureTimes">[docs]</a><span class="k">class</span> <span class="nc">TemperatureTimes</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Times at which temperatuers are specified on the :py:class:`Temperature`</span>
<span class="sd">    card. Unique card with name `temptimes`. In MCNP, this is the **THTME**</span>
<span class="sd">    card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.TemperatureTimes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO ideally this would not be a separate card, and would be generated by</span>
    <span class="c"># only using a Temperature card.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">times</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        times : float [seconds]</span>
<span class="sd">            The times at which temperature cards are provided.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Here is an example of how this card is used::</span>

<span class="sd">            thtme = TemperatureTimes([1e10, 2e10])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TemperatureTimes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;temptimes&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">times</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Temperature times {0!r} (in MeV):&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;THTME&quot;</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">secs2shakes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span>

    <span class="nd">@times.setter</span>
    <span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ICellModParticle"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICellModParticle">[docs]</a><span class="k">class</span> <span class="nc">ICellModParticle</span><span class="p">(</span><span class="n">IUniqueParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class is not used by the user. Abstract base class for cards that</span>
<span class="sd">    can be specified in MCNP on both the cell card or in the data block, and</span>
<span class="sd">    are unique by particle.  All subclasses have a ``particle`` and ``cell``</span>
<span class="sd">    property, and similar form.  All subclasses are unique for a given particle</span>
<span class="sd">    type. Entries for a given cell can be modified by providing an input for</span>
<span class="sd">    the same cell.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_name</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">n_args_per_cell</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pre_name : str</span>
<span class="sd">            See :py:class:`IUniqueParticle`.</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`IUniqueParticle`.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass.</span>
<span class="sd">            The name of the cell for which the card applies.</span>
<span class="sd">        n_args_per_cell : int</span>
<span class="sd">            The number of arguments the subclass expects per cell.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ICellModParticle</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">pre_name</span><span class="p">,</span> <span class="n">particle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span> <span class="o">=</span> <span class="n">n_args_per_cell</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">%</span> <span class="n">n_args_per_cell</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;The length of ``*args`` must be a multiple &quot;</span>
                    <span class="s">&quot;of {0}. Length is {1}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_args_per_cell</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">_process_varargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i_cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span><span class="p">):</span>
            <span class="n">i_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span> <span class="o">*</span> <span class="n">i_cell</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_start</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_cell</span><span class="p">])</span>

    <span class="nd">@abc.abstractmethod</span>
<div class="viewcode-block" id="ICellModParticle.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ICellModParticle.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one. See subclasses.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">+=</span> <span class="p">[</span><span class="n">cell</span><span class="p">]</span>
</div>
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0} {1!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; cell {0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;;&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">keystring</span><span class="p">):</span>
        <span class="c"># TODO this ordering might not be correct, particularly once we add</span>
        <span class="c"># support for universes, etc.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;{0}:{1!s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keystring</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
        <span class="c"># TODO this should loop through in the print order.</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; 0&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span>

    <span class="nd">@cells.setter</span>
    <span class="k">def</span> <span class="nf">cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Expected cell name, got {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cells</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Importance"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Importance">[docs]</a><span class="k">class</span> <span class="nc">Importance</span><span class="p">(</span><span class="n">ICellModParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Particle importance. Unique card for a given particle type, with name</span>
<span class="sd">    `importance-&lt;particle&gt;`. In MCNP, this is the **IMP** card. The user can</span>
<span class="sd">    initialize this card without providing any cell importances.  The typical</span>
<span class="sd">    usage is to provide the importance for all cells, though the card does not</span>
<span class="sd">    require this.</span>
<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Importance</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass.</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        imp : int</span>
<span class="sd">            Cell importance.</span>
<span class="sd">        *args : cell, imp, ...</span>
<span class="sd">            To provide importances for more than one cell, supply the last two</span>
<span class="sd">            arguments for the other cells. See examples. This can also be done</span>
<span class="sd">            using :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following specifies the neutron importance in cells &#39;cellA&#39; and</span>
<span class="sd">        &#39;cellB&#39;::</span>

<span class="sd">            impn = Importance(&#39;neutron&#39;, &#39;cellA&#39;, 1, &#39;cellB&#39;, 2)</span>

<span class="sd">        If providing importances for many cells it may be easier to do the</span>
<span class="sd">        following::</span>

<span class="sd">            args = [&#39;cellA&#39;, 1, &#39;cellB&#39;, 1, &#39;cellC&#39;, 0]</span>
<span class="sd">            impn = cards.Importance(&#39;neutron&#39;, *args)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Importance</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&quot;importance&quot;</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imps</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="Importance.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Importance.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">imp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass.</span>
<span class="sd">        imp : int</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The example above can be achieved by the following::</span>

<span class="sd">            impn = Importance(&#39;neutron&#39;)</span>
<span class="sd">            impn.set(&#39;cellA&#39;, 1)</span>
<span class="sd">            impn.set(&#39;cellB&#39;, 2)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            impn.set(&#39;cellB&#39;, 1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Importance</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imps</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">imp</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Importance</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Importance&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imps</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Importance</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;IMP&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imps</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">imps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imps</span>

    <span class="nd">@imps.setter</span>
    <span class="k">def</span> <span class="nf">imps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imps</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ExponentialTransform"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ExponentialTransform">[docs]</a><span class="k">class</span> <span class="nc">ExponentialTransform</span><span class="p">(</span><span class="n">ICellModParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An exponential transform that adjusts the total cross section by a given</span>
<span class="sd">    factor in a given direction. Unique card for a given particle type, with</span>
<span class="sd">    name `exptransform-&lt;particle&gt;`. In MCNP, this is the **EXT** card.  The</span>
<span class="sd">    user can initialize this card without requesting any exponential</span>
<span class="sd">    transforms.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.ExponentialTransform</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        stretch : str or float</span>
<span class="sd">            The stretch factor. If &#39;capture-to-total&#39;, the stretch factor is</span>
<span class="sd">            the ratio of the capture cross section to the total cross section</span>
<span class="sd">            (referred to as Sigma_a in the MCNP manual). Otherwise, the factor</span>
<span class="sd">            is a number between 0 and 1.</span>
<span class="sd">        direction : str </span>
<span class="sd">            If &#39;currdir&#39; then the stretching is done in the particle&#39;s</span>
<span class="sd">            direction of travel. If &#39;x&#39;, &#39;X&#39;, &#39;y&#39;, &#39;Y&#39;, or &#39;z&#39;, &#39;Z&#39;, the</span>
<span class="sd">            stretching is with respect to the requested axis. Otherwise, it is</span>
<span class="sd">            the name of a vector on the :py:class:`Vector` card.</span>
<span class="sd">        sign : str</span>
<span class="sd">            If &#39;toward&#39;, the stretching is done toward the direction requested.</span>
<span class="sd">            If &#39;away&#39;, the stretching is done away from the direction requested.</span>
<span class="sd">        *args : cell, stretch, direction, sign...</span>
<span class="sd">            To request an exponential transform for more than one cell, supply</span>
<span class="sd">            the last four arguments for the additional cells. See examples.</span>
<span class="sd">            This can also be done using :py:meth:`set`.</span>
<span class="sd"> </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Consider cell &#39;cellA&#39;. The following requests a</span>
<span class="sd">        transformation that stretches by the ratio of the capture cross section</span>
<span class="sd">        to the total cross section, in the direction of the particle&#39;s travel.</span>
<span class="sd">        The name of the card will be `exptransform-neutron`::</span>

<span class="sd">            extn = ExponentialTransform(&#39;neutron&#39;, &#39;cellA&#39;, &#39;capture-to-total&#39;,</span>
<span class="sd">                    &#39;currdir&#39;, &#39;toward&#39;)</span>
<span class="sd">            assert extn.name == &#39;exptransform-neutron&#39;</span>
<span class="sd">        </span>
<span class="sd">        The following requests a transformation that stretches by a factor of</span>
<span class="sd">        0.5 in the direction of the particle&#39;s travel::</span>

<span class="sd">            extn = ExponentialTransform(&#39;neutron&#39;, &#39;cellA&#39;, 0.5, &#39;currdir&#39;,</span>
<span class="sd">                    &#39;toward&#39;)</span>

<span class="sd">        The following requests a transformation with respect to the x axis::</span>

<span class="sd">            extn = ExponentialTransform(&#39;neutron&#39;, &#39;cellA&#39;, 0.5, &#39;x&#39;, &#39;toward&#39;)</span>

<span class="sd">        The following requests a transformation away from the origin::</span>

<span class="sd">            extn = ExponentialTransform(&#39;neutron&#39;, &#39;cellA&#39;, 0.5, &#39;vec1&#39;,</span>
<span class="sd">                    &#39;away&#39;)</span>

<span class="sd">        where somewhere else the user has added::</span>

<span class="sd">            vec = Vector()</span>
<span class="sd">            vec.set(&#39;vec1&#39;, [0, 0, 0])</span>

<span class="sd">        to the simulation. If the user wants to request an exponential</span>
<span class="sd">        transform for cells &#39;cellB&#39; and &#39;cellC&#39; as well, they can do the</span>
<span class="sd">        following::</span>

<span class="sd">            extn = ExponentialTransform(&#39;neutron&#39;, </span>
<span class="sd">                    &#39;cellA&#39;, &#39;capture-to-total&#39;, &#39;currdir&#39;, &#39;toward&#39;, </span>
<span class="sd">                    &#39;cellB&#39;, 0.5, &#39;currdir&#39;, &#39;toward&#39;,</span>
<span class="sd">                    &#39;cellC&#39;, 0.5, &#39;vec1&#39;, &#39;away&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ExponentialTransform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;exptransform&#39;</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span>
                                                   <span class="mi">4</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="c"># Initialize properties for the subclass.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c"># If information for multiple cells has been provided...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="ExponentialTransform.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ExponentialTransform.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">stretch</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">sign</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The user can add additional transforms, for additional cells, or</span>
<span class="sd">        modify existing values using this method. See above for a description</span>
<span class="sd">        of the input.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        stretch : str or float</span>
<span class="sd">        direction : str </span>
<span class="sd">        sign : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The last example above can also be achieved by the following, assuming</span>
<span class="sd">        cell cards &#39;cellA&#39;, &#39;cellB&#39; and &#39;cellC&#39; have been created::</span>

<span class="sd">            extn = ExponentialTransform(&#39;neutron&#39;) </span>
<span class="sd">            extn.set(&#39;cellA&#39;, &#39;capture-to-total&#39;, &#39;currdir&#39;, &#39;toward&#39;)</span>
<span class="sd">            extn.set(&#39;cellB&#39;, 0.5, &#39;currdir&#39;, &#39;toward&#39;)</span>
<span class="sd">            extn.set(&#39;cellC&#39;, 0.5, &#39;vec1&#39;, &#39;away&#39;)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            extn.set(&#39;cellC&#39;, 0.7, &#39;vec1&#39;, &#39;away&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ExponentialTransform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">stretch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">sign</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ExponentialTransform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span>
                <span class="s">&quot;Exponential transform&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot; stretch by &quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot; &quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;away&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;from &quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ExponentialTransform</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot;EXT&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">signs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;away&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;-&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;capture-to-total&#39;</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;S&quot;</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">stretchs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;currdir&#39;</span><span class="p">:</span> <span class="k">pass</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;X&#39;</span> <span class="ow">or</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;Y&#39;</span> <span class="ow">or</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;Z&#39;</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;vector&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Vector card is needed for the Exponential &quot;</span>
                        <span class="s">&quot;transform card.&quot;</span><span class="p">)</span>
            <span class="n">vecname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directions</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;V{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">[</span><span class="s">&#39;vector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">vecname</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="c"># I&#39;m aware that this spelling of stretchs is incorrect; it&#39;s for</span>
    <span class="c"># consistency.</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stretchs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stretchs</span>

    <span class="nd">@stretchs.setter</span>
    <span class="k">def</span> <span class="nf">stretchs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stretchs</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">directions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directions</span>

    <span class="nd">@directions.setter</span>
    <span class="k">def</span> <span class="nf">directions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_directions</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">signs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_signs</span>

    <span class="nd">@signs.setter</span>
    <span class="k">def</span> <span class="nf">signs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="o">!=</span> <span class="s">&#39;toward&#39;</span> <span class="ow">and</span> <span class="n">arg</span> <span class="o">!=</span> <span class="s">&#39;away&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The value of ``sign`` must be &#39;toward&#39; or &quot;</span>
                        <span class="s">&quot;&#39;away&#39;. User provided {0!r}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_signs</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="ForcedCollision"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ForcedCollision">[docs]</a><span class="k">class</span> <span class="nc">ForcedCollision</span><span class="p">(</span><span class="n">ICellModParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A forced collision setting. Unique card for a given particle type, with</span>
<span class="sd">    name `forcedcoll-&lt;particle&gt;`. In MCNP, this is the **FCL** card. The user</span>
<span class="sd">    can initialize this card without requesting forced collisions.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.ForcedCollision</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        prob : float</span>
<span class="sd">            If &#39;none&#39;, there is no forced collision for this cell.</span>
<span class="sd">            If float (between 0 and 1), it is the survival probability as</span>
<span class="sd">            described in the MCNP manual.</span>
<span class="sd">        only_entering : bool</span>
<span class="sd">            If True, the card applies only to particles entering the cell. If</span>
<span class="sd">            False, the card applies to particles entering as well as those</span>
<span class="sd">            surviving weight games in the cell.</span>
<span class="sd">        *args : cell, prob, only_entering, ...</span>
<span class="sd">            To request forced collision for more than one cell, supply</span>
<span class="sd">            the last three arguments for the additional cells. See examples.</span>
<span class="sd">            This can also be done using :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following cards request forced collisions with neutrons in the cell</span>
<span class="sd">        defined by cell card &#39;cellA&#39;::  </span>

<span class="sd">            fcl = ForcedCollision(&#39;neutron&#39;, &#39;cellA&#39;, 0.5, True)</span>
<span class="sd">            fcl = ForcedCollision(&#39;neutron&#39;, &#39;cellA&#39;, 0.5, False)</span>

<span class="sd">        If the user wants to request forced collisions for &#39;cellB&#39; as well,</span>
<span class="sd">        they can do the following::</span>

<span class="sd">            fcl = ForcedCollision(&#39;neutron&#39;, &#39;cellA&#39;, 0.5, True,</span>
<span class="sd">                                             &#39;cellB&#39;, 0.5, False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ForcedCollision</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;forcedcoll&#39;</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">only_enterings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="c"># If information for multiple cells has been provided...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="ForcedCollision.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.ForcedCollision.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">only_entering</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The user can add additional forced collision probabilities, for</span>
<span class="sd">        additional cells, or modify existing data, using this method. See above</span>
<span class="sd">        for a description of the input.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        prob : float</span>
<span class="sd">        only_entering : bool</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The last example above can also be achieved by the following::</span>

<span class="sd">            fcl = ForcedCollision(&#39;neutron&#39;)</span>
<span class="sd">            fcl.set(&#39;cellA&#39;, 0.5, True)</span>
<span class="sd">            fcl.set(&#39;cellB&#39;, 0.5, False)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            fcl.set(&#39;cellB&#39;, 0.7, False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ForcedCollision</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">only_enterings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">only_entering</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ForcedCollision</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;Forced collision&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_enterings</span><span class="p">[</span><span class="n">cell</span><span class="p">]:</span> <span class="n">oestr</span> <span class="o">=</span> <span class="s">&quot;entering only&quot;</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">oestr</span> <span class="o">=</span> <span class="s">&quot;entering and weight games&quot;</span>
        <span class="k">return</span> <span class="s">&quot; prob {0:g} for {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">],</span> <span class="n">oestr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ForcedCollision</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="s">&quot;FCL&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">only_enterings</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="k">else</span> <span class="s">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probs</span>

    <span class="nd">@probs.setter</span>
    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probs</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">only_enterings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_enterings</span>

    <span class="nd">@only_enterings.setter</span>
    <span class="k">def</span> <span class="nf">only_enterings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_enterings</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="WeightWindowBound"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.WeightWindowBound">[docs]</a><span class="k">class</span> <span class="nc">WeightWindowBound</span><span class="p">(</span><span class="n">ICellModParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cell-based weight window lower bounds. Unique card for a given particle</span>
<span class="sd">    type, with name `weightwinbound-&lt;particle&gt;`. In MCNP, this is the **WWN**</span>
<span class="sd">    card. In MCNP, these are typically generated automatically using its weight</span>
<span class="sd">    window generator.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.WeightWindowBound</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        idx_energy : int</span>
<span class="sd">            Index of the energy, on a :py:class:`WeightWindowEnergies` card,</span>
<span class="sd">            for which a bound is being specified. If no energy bins are</span>
<span class="sd">            specified (e.g. 1 energy bin for weight windows), provide 1. The</span>
<span class="sd">            index starts at 1.</span>
<span class="sd">        idx_time : int</span>
<span class="sd">            Index of the time, on a :py:class:`WeightWindowTimes` card,</span>
<span class="sd">            for which a bound is being specified. If no time intervals are</span>
<span class="sd">            specified in the problem (e.g. 1 time interval for weight windows),</span>
<span class="sd">            provide 1. The index starts at 1.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        bound : str or float</span>
<span class="sd">            Lower bound for the weight to cause rouletting, or &#39;killall&#39; to</span>
<span class="sd">            kill all particles entering the cell.</span>
<span class="sd">        *args : cell, idx_energy, idx_time, bound, ...</span>
<span class="sd">            Any number of sets of the previous four arguments can be provided</span>
<span class="sd">            as additional arguments. See examples. This can also be done using</span>
<span class="sd">            :py:meth:`set`.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following specifies the weight window bounds for &#39;cellB&#39; if the</span>
<span class="sd">        :py:class:`WeightWindowEnergies` and :py:class:`WeightWindowTimes`</span>
<span class="sd">        cards are not used::</span>

<span class="sd">            wwn = WeightWindowBound(&#39;neutron&#39;, 1, 1, &#39;cellB&#39;, 0.01)</span>

<span class="sd">        The value of ``bound`` can be &#39;killall&#39;::</span>

<span class="sd">            wwn = WeightWindowBound(&#39;neutron&#39;, 1, 1, &#39;cellB&#39;, &#39;killall&#39;)</span>

<span class="sd">        The following::</span>

<span class="sd">            wwn = WeightWindowBound(&#39;neutron&#39;, 1, 1, &#39;cellB&#39;, 0.01,</span>
<span class="sd">                                               2, 3, &#39;cellB&#39;, 0.01)</span>

<span class="sd">        assumes that cards such as the following have been added to the</span>
<span class="sd">        simulation::</span>

<span class="sd">            wwe = WeightWindowEnergies(&#39;neutron&#39;, [1, 10])</span>
<span class="sd">            wwt = WeightWindowTimes(&#39;neutron&#39;, [1, 1e12, 2e12])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WeightWindowBound</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;weightwinbound&#39;</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span>
                                                <span class="mi">4</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="c"># Check for existence of weight window cards.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx_energys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx_times</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># _multi_dict is a method in this class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi_dict</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="WeightWindowBound.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.WeightWindowBound.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx_energy</span><span class="p">,</span> <span class="n">idx_time</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">bound</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idx_energy : int</span>
<span class="sd">        idx_time : int</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        bound : str or float</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following does the same as the second example above::</span>

<span class="sd">            wwn = WeightWindowBound(&#39;neutron&#39;)</span>
<span class="sd">            wwn.set(1, 1, &#39;cellB&#39;, 0.01)</span>
<span class="sd">            wwn.set(2, 3, &#39;cellB&#39;, 0.01)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            wwn.set(1, 1, &#39;cellB&#39;, 0.02)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WeightWindowBound</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx_energy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_energys</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_energys</span> <span class="o">+=</span> <span class="p">[</span><span class="n">idx_energy</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">idx_time</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_times</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">idx_times</span> <span class="o">+=</span> <span class="p">[</span><span class="n">idx_time</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">cell</span><span class="p">][</span><span class="n">idx_energy</span><span class="p">][</span><span class="n">idx_time</span><span class="p">]</span> <span class="o">=</span> <span class="n">bound</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Weight window bounds {0!r} for {1}s:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_energys</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; energy idx {0}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i_e</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i_t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_times</span><span class="p">:</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; time idx {0}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i_t</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">cell</span><span class="p">][</span><span class="n">i_e</span><span class="p">][</span><span class="n">i_t</span><span class="p">]:</span>
                        <span class="c"># The 3-dim dict&#39;s entries are initialized to None</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; cell {0!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">)</span>
                        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="c"># Change last character from a comma to a period.</span>
        <span class="k">return</span> <span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">):</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">cell</span><span class="p">][</span><span class="n">i_e</span><span class="p">][</span><span class="n">i_t</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>                  <span class="k">return</span> <span class="s">&quot; {0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c"># Prepare to obtain linear index.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_find_n_energies</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="c"># Finally, create all necessary cards (one per linear index).</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i_t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_times</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i_e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_energys</span><span class="p">:</span>
                <span class="c"># Start card, but only if any values are assigned for this idx.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_vals_for</span><span class="p">(</span><span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}WWN{1}:{2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">i_linear</span><span class="p">(</span><span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">),</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
                    <span class="c"># Check all cells in the system.</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
                        <span class="c"># Is this cell on this card, and is there a bound</span>
                        <span class="c"># defined for it, for this energy and time?</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">i_e</span><span class="p">][</span><span class="n">i_t</span><span class="p">]:</span>
                            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span>
                                    <span class="n">float_format</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; 0&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">):</span>
        <span class="n">this_bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">cell</span><span class="p">][</span><span class="n">i_e</span><span class="p">][</span><span class="n">i_t</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">this_bound</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span><span class="p">:</span> <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="n">this_bound</span>
        <span class="k">elif</span> <span class="n">this_bound</span> <span class="o">==</span> <span class="s">&#39;killall&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="s">&quot;-1&quot;</span>
        <span class="k">else</span><span class="p">:</span>                         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Unexpected input.&quot;</span><span class="p">)</span>
 
    <span class="k">def</span> <span class="nf">_n_vals_for</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">):</span>
        <span class="c"># TODO may not need this check.</span>
        <span class="n">n_vals</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="n">cell</span><span class="p">][</span><span class="n">i_e</span><span class="p">][</span><span class="n">i_t</span><span class="p">]:</span> <span class="n">n_vals</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">n_vals</span>

    <span class="k">def</span> <span class="nf">_find_n_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">wwge_name</span> <span class="o">=</span> <span class="s">&#39;weightwingenenergy-{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span>
        <span class="n">wwe_name</span> <span class="o">=</span> <span class="s">&#39;weightwinenergy-{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wwge_name</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span> <span class="ow">and</span> <span class="n">wwe_name</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s">&quot;Both a WWGE and a WWE card have been added; &quot;</span>
                    <span class="s">&quot;using WWGE, ignoring WWE.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wwge_name</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
            <span class="c"># Deal with MCNP default indices that are unhandled by the WWGT</span>
            <span class="c"># card here.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">[</span><span class="n">wwge_name</span><span class="p">]</span><span class="o">.</span><span class="n">for_gen</span> <span class="ow">and</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">[</span><span class="n">wwge_name</span><span class="p">]</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_n_energies</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_n_energies</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">[</span><span class="n">wwge_name</span><span class="p">]</span><span class="o">.</span><span class="n">n_bounds</span>
        <span class="k">elif</span> <span class="n">wwe_name</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_n_energies</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">[</span><span class="n">wwe_name</span><span class="p">]</span><span class="o">.</span><span class="n">n_bounds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No WWGT:{0} or WWT:{0} card found in the &quot;</span>
                    <span class="s">&quot;simulation.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">i_linear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i_e</span><span class="p">,</span> <span class="n">i_t</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">i_t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_energies</span> <span class="o">+</span> <span class="n">i_e</span>
       
    <span class="k">def</span> <span class="nf">_multi_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_dims</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n_dims</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multi_dict</span><span class="p">(</span><span class="n">n_dims</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">idx_energys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idx_energys</span>

    <span class="nd">@idx_energys.setter</span>
    <span class="k">def</span> <span class="nf">idx_energys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idx_energys</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">idx_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idx_times</span>

    <span class="nd">@idx_times.setter</span>
    <span class="k">def</span> <span class="nf">idx_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idx_times</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span>

    <span class="nd">@bounds.setter</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="WeightWindowEnergies"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.WeightWindowEnergies">[docs]</a><span class="k">class</span> <span class="nc">WeightWindowEnergies</span><span class="p">(</span><span class="n">IUniqueParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upper energy bounds for weight windows. Unique card for a given particle</span>
<span class="sd">    type, with name `weightwinenergy-&lt;particle&gt;` or</span>
<span class="sd">    `weightwingenenergy-&lt;particle&gt;`. In MCNP, this is the **WWE**</span>
<span class="sd">    or **WWGE** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.WeightWindowEnergies</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># The choice to combine this card with the WWGE card means that we can&#39;t</span>
    <span class="c"># read in an MCNP input quite as easily? Raise an excpetion if a regular</span>
    <span class="c"># and a generator card are provided by the user; or maybe just a warning,</span>
    <span class="c"># and go with the indices provided by the former. it&#39;s possible that the</span>
    <span class="c"># indices are the same. Why wouldn&#39;t they be?</span>
    <span class="c"># TODO bounds [] can be provided if for_gen=False, in which case MCNP</span>
    <span class="c"># generates a WWE card with 10 indices on it, that could then be used on a</span>
    <span class="c"># WWN card, though if the user is using WWG then they shouldn&#39;t be using</span>
    <span class="c"># WWN directly, but in any case the WWN might say that the WWGE card does</span>
    <span class="c"># not have 10 indices, since only MCNP is handling that. Need to show this</span>
    <span class="c"># to the WWN card. EDIT this is managed in WWN.mcnp()</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">for_gen</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`IUniqueParticle`.</span>
<span class="sd">        bounds : list, :py:class:`np.array` [MeV]</span>
<span class="sd">            Upper energy bounds of the weight windows.</span>
<span class="sd">        for_gen : bool, optional</span>
<span class="sd">            If set to True, this becomes the energies for the weight window</span>
<span class="sd">            generator energies card, **WWGE**.</span>
<span class="sd">            To request the default functionality that MCNP provides on the</span>
<span class="sd">            **WWGE** card when no bounds are specified, provide an empty list</span>
<span class="sd">            for ``bounds``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following specifies energy bins [0, 1] and [1, 10] MeV for photon</span>
<span class="sd">        weight windows::</span>

<span class="sd">            wwe = WeightWindowEnergies(&#39;photon&#39;, [1, 10])            </span>

<span class="sd">        The following specifies the energy bins on a weight window generator</span>
<span class="sd">        times card::</span>

<span class="sd">            wwt = WeightWindowEnergies(&#39;photon&#39;, [1, 1e12], for_gen=True)            </span>

<span class="sd">        The following, in MCNP, uses the default bins if using the generator</span>
<span class="sd">        option::</span>
<span class="sd">        </span>
<span class="sd">            wwt = WeightWindowEnergies(&#39;photon&#39;, [], for_gen=True)            </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WeightWindowEnergies</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
                <span class="s">&#39;weightwin{0}energy&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;gen&#39;</span> <span class="k">if</span> <span class="n">for_gen</span> <span class="k">else</span> <span class="s">&#39;&#39;</span><span class="p">),</span>
                <span class="n">particle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span><span class="o">=</span><span class="n">for_gen</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n_bins</span> <span class="o">=</span> <span class="s">&quot;default&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot;Weight window {0}energies {1!r} for {2}s: {3} bins.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="s">&quot;generator &quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">,</span>
            <span class="n">n_bins</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;WW{0}E:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;G&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
        <span class="n">float_format</span> <span class="o">=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">float_format</span>
        <span class="k">for</span> <span class="n">bound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="n">string</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span>

    <span class="nd">@bounds.setter</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">for_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_gen</span>

    <span class="nd">@for_gen.setter</span>
    <span class="k">def</span> <span class="nf">for_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_gen</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="WeightWindowTimes"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.WeightWindowTimes">[docs]</a><span class="k">class</span> <span class="nc">WeightWindowTimes</span><span class="p">(</span><span class="n">IUniqueParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Upper time bounds for weight windows. Unique card for a given particle</span>
<span class="sd">    type, with name `weightwintime-&lt;particle&gt;` or `weightwingentime-&lt;particle`.</span>
<span class="sd">    In MCNP this is the **WWT** or **WWGT** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.WeightWindowTimes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">for_gen</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`IUniqueParticle`.</span>
<span class="sd">        bounds : list, :py:class:`np.array` [seconds]</span>
<span class="sd">            Upper time bounds of the weight windows.</span>
<span class="sd">        for_gen : bool, optional</span>
<span class="sd">            If set to True, this becomes the energies for the weight window</span>
<span class="sd">            generator energies card, **WWGE**.</span>
<span class="sd">            To request the default functionality that MCNP provides on the</span>
<span class="sd">            **WWGE** card when no bounds are specified, provide an empty list</span>
<span class="sd">            for ``bounds``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following specifies time intervals [-inf, 1] and [1, 1e12] sec for</span>
<span class="sd">        photon weight windows::</span>
<span class="sd">            </span>
<span class="sd">            wwt = WeightWindowTimes(&#39;photon&#39;, [1, 1e12])            </span>

<span class="sd">        The following specifies the time intervals on a weight window generator</span>
<span class="sd">        times card::</span>

<span class="sd">            wwt = WeightWindowTimes(&#39;photon&#39;, [1, 1e12], for_gen=True)            </span>

<span class="sd">        The following, in MCNP, uses the default bins if using the generator</span>
<span class="sd">        option::</span>

<span class="sd">            wwt = WeightWindowTimes(&#39;photon&#39;, [], for_gen=True)            </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WeightWindowTimes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
                <span class="s">&#39;weightwin{0}time&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;gen&#39;</span> <span class="k">if</span> <span class="n">for_gen</span> <span class="k">else</span> <span class="s">&#39;&#39;</span><span class="p">),</span> <span class="n">particle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="o">=</span> <span class="n">for_gen</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># TODO don&#39;t tie the comment to any certain units; units are</span>
        <span class="c"># code-dependent.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">n_bins</span> <span class="o">=</span> <span class="s">&quot;default&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot;Weight window {0}times {1!r} for {2}s: &quot;</span>
                <span class="s">&quot;{3} intervals.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s">&quot;generator &quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;WW{0}T:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;G&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">for_gen</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
        <span class="n">float_format</span> <span class="o">=</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="n">float_format</span>
        <span class="k">for</span> <span class="n">bound</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">:</span> 
            <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="p">(</span><span class="n">bound</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">secs2shakes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span>

    <span class="nd">@bounds.setter</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_bounds</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">for_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_gen</span>

    <span class="nd">@for_gen.setter</span>
    <span class="k">def</span> <span class="nf">for_gen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_for_gen</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="DXTRANContribution"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DXTRANContribution">[docs]</a><span class="k">class</span> <span class="nc">DXTRANContribution</span><span class="p">(</span><span class="n">ICellMod</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Contribution probabilities to DXTRAN sphere by cells. Unique card for a</span>
<span class="sd">    given particle type and DXTRAN sphere, with name</span>
<span class="sd">    `dxtrancont-&lt;sph_name&gt;-&lt;particle&gt;` (or more simply `dxtrancont-&lt;particle&gt;`</span>
<span class="sd">    if input applies for all spheres). In MCNP, this is the **DXC** card.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.DXTRANContribution</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="n">sph_name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        sph_name : str or None</span>
<span class="sd">            Name of the DXTRAN sphere, on the :py:class:`DXTRANSpheres` card,</span>
<span class="sd">            for which this card applies. To apply this card to all spheres, set</span>
<span class="sd">            to None.</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">            See :py:class:`ICellMod`.</span>
<span class="sd">        prob : float</span>
<span class="sd">            The probability of contribution to the sphere.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following shows how this card is used to specify contribution</span>
<span class="sd">        probabilities for all DXTRAN spheres::</span>

<span class="sd">            dxc = DXTRANContribution(&#39;neutron&#39;, None, &#39;cellA&#39;, 0.5)</span>

<span class="sd">        The following applies for only &#39;sph1&#39; on the :py:class:`DXTRANSpheres`</span>
<span class="sd">        card::</span>

<span class="sd">            dxc = DXTRANContribution(&#39;neutron&#39;, &#39;sph1&#39;, &#39;cellA&#39;, 0.5)</span>

<span class="sd">        The following provides probabilities for two different cells::</span>

<span class="sd">            dxc = DXTRANContribution(&#39;neutron&#39;, &#39;sph1&#39;, &#39;cellA&#39;, 0.5,</span>
<span class="sd">                                                        &#39;cellB&#39;, 0.75)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># DXTRANSphere must be added first before this can be used?</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DXTRANContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
                <span class="s">&#39;dxtrancont{0}-{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="s">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sph_name</span> <span class="k">if</span> <span class="n">sph_name</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">particle</span><span class="p">),</span>
                <span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">particle</span> <span class="o">=</span> <span class="n">Particle</span><span class="p">(</span><span class="n">particle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sph_name</span> <span class="o">=</span> <span class="n">sph_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_varargs</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="DXTRANContribution.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DXTRANContribution.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">prob</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cell : str name of :py:class:`Cell` or subclass</span>
<span class="sd">        prob : float</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following shows how this card can be constructed using this</span>
<span class="sd">        method::</span>

<span class="sd">            dxc = DXTRANContribution(&#39;neutron&#39;, &#39;sph1&#39;)</span>
<span class="sd">            dxc.set(&#39;cellA&#39;, 0.5)</span>
<span class="sd">            dxc.set(&#39;cellB&#39;, 0.75)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            dxc.set(&#39;cellB&#39;, 0.8)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DXTRANContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;DXTRAN contribution&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sph_name</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; for sphere {0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sph_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>             <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; for all spheres&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DXTRANContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot; {0:g}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;DXC{0}:{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sph_index</span><span class="p">(</span><span class="n">sim</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DXTRANContribution</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sph_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sph_name</span><span class="p">:</span>
            <span class="c"># Get sphere index.</span>
            <span class="n">dxt_name</span> <span class="o">=</span> <span class="s">&#39;dxtranspheres-{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dxt_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;To specify DXTRAN contributions for &quot;</span>
                        <span class="s">&quot;{0}s, a {1} misc card must be in the &quot;</span>
                        <span class="s">&quot;simulation.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="p">,</span> <span class="n">dxt_name</span><span class="p">))</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">misc</span><span class="p">[</span><span class="n">dxt_name</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sph_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Applies to all spheres.</span>
            <span class="n">index</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">probs</span><span class="p">[</span><span class="n">cell</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span>

    <span class="nd">@particle.setter</span>
    <span class="k">def</span> <span class="nf">particle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_particle</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probs</span>

    <span class="nd">@probs.setter</span>
    <span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_probs</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="DXTRANSpheres"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DXTRANSpheres">[docs]</a><span class="k">class</span> <span class="nc">DXTRANSpheres</span><span class="p">(</span><span class="n">IUniqueParticle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;DXTRAN spheres. Unique card for a given particle type, with name</span>
<span class="sd">    `dixtranspheres-&lt;particle&gt;`. In MCNP, this is the **DXT** card. See the</span>
<span class="sd">    code&#39;s (e.g. MCNP&#39;s) manual for default values. All the spheres added to</span>
<span class="sd">    this card are named so that they can be referenced by other cards.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.DXTRANSpheres</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Sphere</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s">&#39;Sphere&#39;</span><span class="p">,</span>
            <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;center&#39;</span><span class="p">,</span> <span class="s">&#39;inrad&#39;</span><span class="p">,</span> <span class="s">&#39;outrad&#39;</span><span class="p">])</span>
    <span class="sd">&quot;&quot;&quot;Named tuple with which input entries are stored.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">particle</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        particle : str</span>
<span class="sd">            See :py:class:`IUniqueParticle`.</span>
<span class="sd">        sph_name : str</span>
<span class="sd">            Name of the sphere.</span>
<span class="sd">        center : 3-element list or :py:class:`np.array` [centimeters]</span>
<span class="sd">            Center of this sphere.</span>
<span class="sd">        inner_radius : float [centimeters]</span>
<span class="sd">            Inner radius of this sphere.</span>
<span class="sd">        outer_radius : float [centimeters]</span>
<span class="sd">            Outer radius of this sphere.</span>
<span class="sd">        *args : sph_name, point, inner_radius, outer_radius, ...</span>
<span class="sd">            To request more than one sphere, supply the last 4 arguments for</span>
<span class="sd">            the additional spheres. See examples. This can also be done using</span>
<span class="sd">            :py:meth:`set`.</span>
<span class="sd">        upper_cutoff : float, optional</span>
<span class="sd">            Upper weight cutoff, for all spheres.</span>
<span class="sd">        lower_cutoff : float, optional</span>
<span class="sd">            Lower weight cutoff, for all spheres.</span>
<span class="sd">        min_photon_weight : float, optional</span>
<span class="sd">            Only relevant if this card is for neutrons.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following requests a DXTRAN sphere `sph1` at (1, 2, 3) cm, with</span>
<span class="sd">        inner radius 4 cm and outer radius 5 cm::</span>

<span class="sd">            dsph = DXTRANSpheres(&#39;neutron&#39;, &#39;sph1&#39;, [1, 2, 3], 4, 5)</span>

<span class="sd">        It is possible to define multiple spheres in the constructor; keyword</span>
<span class="sd">        arguments come after the sphere parameters::</span>

<span class="sd">            dsph = DXTRANSpheres(&#39;neutron&#39;, &#39;sph1&#39;, [1, 2, 3], 4, 5,</span>
<span class="sd">                                            &#39;sph2&#39;, [4, 5, 6], 7, 8,</span>
<span class="sd">                                 upper_cutoff=0.1, lower_cutoff=0.05,</span>
<span class="sd">                                 min_photon_weight=0.5)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DXTRANSpheres</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;dxtranspheres&#39;</span><span class="p">,</span> <span class="n">particle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_cutoff</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;upper_cutoff&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_cutoff</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;lower_cutoff&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_photon_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;min_photon_weight&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_set</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="c"># TODO copied from ICellMod, ICellModParticle.</span>
        <span class="k">for</span> <span class="n">i_set</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_set</span><span class="p">):</span>
            <span class="n">i_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_set</span> <span class="o">*</span> <span class="n">i_set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="n">i_start</span><span class="p">:</span><span class="n">i_start</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_n_args_per_set</span><span class="p">])</span>

<div class="viewcode-block" id="DXTRANSpheres.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DXTRANSpheres.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sph_name</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an entry or modify an existing one.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sph_name : str</span>
<span class="sd">            Name of the sphere.</span>
<span class="sd">        center : 3-element list or :py:class:`np.array` [centimeters]</span>
<span class="sd">            Center of this sphere.</span>
<span class="sd">        inner_radius : float [centimeters]</span>
<span class="sd">            Inner radius of this sphere.</span>
<span class="sd">        outer_radius : float [centimeters]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The last example above can be achieved as follows::</span>

<span class="sd">            dsph = DXTRANSpheres(&#39;neutron&#39;, upper_cutoff=0.1,</span>
<span class="sd">                                 lower_cutoff=0.05,</span>
<span class="sd">                                 min_photon_weight=0.5)</span>
<span class="sd">            dsph.set(&#39;sph1&#39;, [1, 2, 3], 4, 5)</span>
<span class="sd">            dsph.set(&#39;sph2&#39;, [4, 5, 6], 7, 8)</span>

<span class="sd">        Previously provided values can be modified later on::</span>

<span class="sd">            dsph.set(&#39;sph2&#39;, [4.5, 5.5, 6.5], 8.5, 9.5)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="p">[</span><span class="n">sph_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span>
                <span class="n">sph_name</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">upcut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_cutoff</span>
        <span class="n">lowcut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_cutoff</span>
        <span class="n">mpw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_photon_weight</span>
        <span class="n">string</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;DXTRAN spheres {0!r}: &quot;</span>
                  <span class="s">&quot;up. cut. {1}, low cut. {2}, min photon wgt. {3}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">upcut</span>  <span class="k">if</span> <span class="n">upcut</span>  <span class="k">else</span> <span class="s">&#39;default&#39;</span><span class="p">,</span>
                      <span class="n">lowcut</span> <span class="k">if</span> <span class="n">lowcut</span> <span class="k">else</span> <span class="s">&#39;default&#39;</span><span class="p">,</span>
                      <span class="n">mpw</span>    <span class="k">if</span> <span class="n">mpw</span>    <span class="k">else</span> <span class="s">&#39;default&#39;</span><span class="p">))</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; sphere &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comment_unit</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;;&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">_comment_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">sph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="s">&quot;{0!r} at ({1[0]:g}, {1[1]:g}, {1[2]:g}) cm, &quot;</span>
                <span class="s">&quot;in. rad. {2:g} cm, out. rad. {3:g} cm&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">sph</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">sph</span><span class="o">.</span><span class="n">inrad</span><span class="p">,</span> <span class="n">sph</span><span class="o">.</span><span class="n">outrad</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">mpw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_photon_weight</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;DXT:{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">particle</span><span class="o">.</span><span class="n">mcnp</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;  &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mcnp_unit</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="s">&quot; &quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_cutoff</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_cutoff</span>
        <span class="k">else</span><span class="p">:</span>                 <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;0&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_cutoff</span><span class="p">:</span> <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_cutoff</span>
        <span class="k">else</span><span class="p">:</span>                 <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;0&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; &quot;</span>
        <span class="k">if</span> <span class="n">mpw</span><span class="p">:</span>               <span class="n">string</span> <span class="o">+=</span> <span class="n">float_format</span> <span class="o">%</span> <span class="n">mpw</span>
        <span class="k">else</span><span class="p">:</span>                 <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;0&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="nf">_mcnp_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">sph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot;{0} {0} {0} {0} {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">float_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">sph</span><span class="o">.</span><span class="n">center</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sph</span><span class="o">.</span><span class="n">inrad</span><span class="p">,</span> <span class="n">sph</span><span class="o">.</span><span class="n">outrad</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sph_name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spheres</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sph_name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">upper_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upper_cutoff</span>

    <span class="nd">@upper_cutoff.setter</span>
    <span class="k">def</span> <span class="nf">upper_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upper_cutoff</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lower_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lower_cutoff</span>

    <span class="nd">@lower_cutoff.setter</span>
    <span class="k">def</span> <span class="nf">lower_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lower_cutoff</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">min_photon_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_photon_weight</span>

    <span class="nd">@min_photon_weight.setter</span>
    <span class="k">def</span> <span class="nf">min_photon_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_photon_weight</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">spheres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spheres</span>

    <span class="nd">@spheres.setter</span>
    <span class="k">def</span> <span class="nf">spheres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spheres</span> <span class="o">=</span> <span class="n">value</span>

</div>
<div class="viewcode-block" id="Vector"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Vector">[docs]</a><span class="k">class</span> <span class="nc">Vector</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Position vector. In MCNP, this is the **VECT** card. Unique card with name</span>
<span class="sd">    `vector`. Vector are added to the card via the :py:meth:`add`. The card is</span>
<span class="sd">    used with the :py:class:`ExponentialTransform` card in MCNP.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.cards.Vector</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO don&#39;t require the user to make this card. The reason we&#39;re allowing</span>
    <span class="c"># it is vector re-use.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Vector</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="s">&#39;vector&#39;</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vectors</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>

<div class="viewcode-block" id="Vector.set"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Vector.set">[docs]</a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vecname</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a vector with name ``vecname`` to the card. If a vector with that</span>
<span class="sd">        vecname has already been added, that vector is then changed to the new</span>
<span class="sd">        value. Returns the index</span>
<span class="sd">        of the vector.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vecname : str</span>
<span class="sd">            Name of the vector. The names &#39;currdir&#39;, &#39;x&#39;, &#39;X&#39;, &#39;y&#39;, &#39;Y&#39;, &#39;z&#39;,</span>
<span class="sd">            and &#39;Z&#39; will cause a conflict with the</span>
<span class="sd">            :py:class:`ExponentialTransform`, as they have other meanings on</span>
<span class="sd">            that card.</span>
<span class="sd">        vector : 3-element list, :py:class:`np.array`, etc. [centimeters]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        index : int</span>
<span class="sd">            Index of the vector that ends up on the **VECT** card.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following adds two vectors, where we have imported :py:mod:`numpy`</span>
<span class="sd">        as ``np``::</span>

<span class="sd">            vec = Vector()</span>
<span class="sd">            vec.set(&#39;origin&#39;, [0, 0, 0])</span>
<span class="sd">            vec.set(&#39;x-axis&#39;, np.array([1, 0, 0]))</span>

<span class="sd">        The vector &#39;origin&#39; has index 1 and the vector &#39;x-axis&#39; has index 2.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vectors</span><span class="p">[</span><span class="n">vecname</span><span class="p">]</span> <span class="o">=</span> <span class="n">vector</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">vecname</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;Vector {0!r}:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0}: ({1[0]:g}, {1[1]:g}, {1[2]:g}) cm&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectors</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vectors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">StandardError</span><span class="p">(</span><span class="s">&quot;No vectors added.&quot;</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;VECT&quot;</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">formatstr</span> <span class="o">=</span> <span class="s">&quot; V{0} {1} {1} {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">float_format</span><span class="p">)</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">formatstr</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">string</span>
        
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vecname</span><span class="p">):</span>
        <span class="c"># MCNP is okay with index 0.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">vecname</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Burnup"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Burnup">[docs]</a><span class="k">class</span> <span class="nc">Burnup</span><span class="p">(</span><span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unimplemented.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">times</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">power_fracs</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">power</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">materials</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">matl_omit</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">min_frac</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">chain_convergence</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">fp_tier</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">out_order</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">out_per_step</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                 <span class="n">model_opt</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">volume</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">conc_change</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># TODO</span>
        <span class="k">pass</span>
    <span class="c">#def __init__(self, times=[1], power_fracs, power=1, materials=None,</span>
    <span class="c">#        matl_omit=None, min_frac=1e-10, chain_convergence=1e-10, fp_tier=1,</span>
    <span class="c">#        out_order=&#39;mass&#39;, out_per_step=False, model_opt=&#39;fatal&#39;,</span>
    <span class="c">#        volume=None, conc_change=None)</span>

</div>
<div class="viewcode-block" id="Custom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Custom">[docs]</a><span class="k">class</span> <span class="nc">Custom</span><span class="p">(</span><span class="n">ICard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Allows the user to specify a custom card. It is logical for this class,</span>
<span class="sd">    in the future, to have attributes like ``serpent``.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the card. Must be unique within the type of card.</span>
<span class="sd">        comment : str, optional</span>
<span class="sd">            A comment to be placed in the input file, if comments are</span>
<span class="sd">            requested.</span>
<span class="sd">        mcnp : str, optional</span>
<span class="sd">            The card to be printed in an MCNP input. Must be given for any card</span>
<span class="sd">            that will be used in generating an MCNP input. This excludes the</span>
<span class="sd">            card number, except for one case with tallies.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Except for materials, custom cards look like the following::</span>

<span class="sd">            cust = SurfaceCustom(&#39;customsurf&#39;, comment=&#39;My Surface&#39;, </span>
<span class="sd">                                               mcnp=&#39;RPP ...&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I am intentionally avoiding using super().</span>
        <span class="n">ICard</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comment_string</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_string</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mcnp&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_string</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;Custom card.&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_string</span>

<div class="viewcode-block" id="Custom.mcnp"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Custom.mcnp">[docs]</a>    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raises an exception if the ``mcnp`` attribute is not defined.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_string</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;mcnp not defined on custom {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="s">&quot;{0}{1}{2}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">pre</span> <span class="k">if</span> <span class="n">pre</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot;{0} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="k">if</span> <span class="n">number</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_string</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="CellCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.CellCustom">[docs]</a><span class="k">class</span> <span class="nc">CellCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`Cell` card.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: CellCustom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Provide number automatically.</span>
    <span class="c"># TODO correct spacing given the number.</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CellCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="SurfaceCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.SurfaceCustom">[docs]</a><span class="k">class</span> <span class="nc">SurfaceCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ISurface</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`ISurface` card.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: SurfaceCustom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Provide number automatically.</span>
    <span class="c"># TODO correct spacing given the number.</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">SurfaceCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surface_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="MaterialCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.MaterialCustom">[docs]</a><span class="k">class</span> <span class="nc">MaterialCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">Material</span><span class="p">):</span>
<span class="c">#class MaterialCustom(Material, Custom):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`Material` card.</span>

<span class="sd">    .. inheritance-diagram:: MaterialCustom</span>

<span class="sd">    NOTE The name of the MaterialCustom</span>
<span class="sd">    card must be given as a keyword argument, otherwise an error will arise::</span>

<span class="sd">        mc = MaterialCustom(name=&#39;matc&#39;, comment=&#39;Made in USA&#39;, mcnp=&#39;...&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span>  <span class="n">mat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mat</span> <span class="o">=</span> <span class="n">mat</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MaterialCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c"># Provide number automatically.</span>
    <span class="c"># TODO correct spacing given the number.</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MaterialCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">material_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">pre</span><span class="o">=</span><span class="s">&quot;M&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="SourceCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.SourceCustom">[docs]</a><span class="k">class</span> <span class="nc">SourceCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ISource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`ISource` card.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: SourceCustom</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="DistributionCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.DistributionCustom">[docs]</a><span class="k">class</span> <span class="nc">DistributionCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">Distribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`Distribution` card.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: DistributionCustom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`Custom`.</span>
<span class="sd">        comment : str, optional</span>
<span class="sd">            See :py:class:`Custom`.</span>
<span class="sd">        mcnp : list of 2-element tuples, optional</span>
<span class="sd">            Unlike with :py:class:`Custom`, this is a list of 2-element tuples,</span>
<span class="sd">            since a distribution in MCNP is done with a number of cards (i.e.</span>
<span class="sd">            SI, SP, SB).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following is expected::</span>

<span class="sd">            dc = DistributionCustom(&#39;disti&#39;, comment=&#39;My dist.&#39;,</span>
<span class="sd">                    mcnp=[(&#39;SP&#39;, &#39;prob string&#39;)])</span>
<span class="sd">            dc = DistributionCustom(&#39;disti&#39;, comment=&#39;My dist.&#39;,</span>
<span class="sd">                    mcnp=[(&#39;SI&#39;, &#39;info string&#39;), (&#39;SP&#39;, &#39;prob string&#39;)])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DistributionCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c"># Provide number automatically.</span>
    <span class="c"># TODO correct spacing given the number.</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="c"># Use superclass&#39;s exception, but not its output.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DistributionCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_string</span><span class="p">:</span>
            <span class="n">prestr</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;{0}{1} {2}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">prestr</span><span class="p">,</span>
                    <span class="n">sim</span><span class="o">.</span><span class="n">dist_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                    <span class="n">content</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">string</span>

</div>
<div class="viewcode-block" id="TallyCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.TallyCustom">[docs]</a><span class="k">class</span> <span class="nc">TallyCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ITally</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`ITally` card.</span>
<span class="sd">    The card is printed in the order that it</span>
<span class="sd">    is added, but unlike with the other custom cards the user must provide</span>
<span class="sd">    their own tally number.</span>

<span class="sd">    .. inheritance-diagram:: TallyCustom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`Custom`.</span>
<span class="sd">        comment : str, optional</span>
<span class="sd">            See :py:class:`Custom`.</span>
<span class="sd">        mcnp : str, optional</span>
<span class="sd">            See :py:class:`Custom`.</span>
<span class="sd">        mcnp_pre : str, optional</span>
<span class="sd">            A string (i.e. &#39;+&#39; or &#39;*&#39;) to print before the tally number (i.e.</span>
<span class="sd">            &#39;F14&#39;).</span>
<span class="sd">        tallyclass : :py:class:`ITally` class object, optional</span>
<span class="sd">            Since each type of tally is numbered separately, the user may want</span>
<span class="sd">            to specify which tally class to use so that the custom tally is</span>
<span class="sd">            added in the right place. If this is not provided, then the user</span>
<span class="sd">            must provide the tally number in the output string (e.g. in</span>
<span class="sd">            ``mcnp``).</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The tallyclass does not need to be provided::</span>

<span class="sd">            tal1 = TallyCustom(&#39;tal1&#39;, comment=&quot;&quot;, mcnp=&quot;F14:N 1 2 3&quot;)</span>

<span class="sd">        But if it is provided, the class takes care of printing the begining of</span>
<span class="sd">        the card::</span>

<span class="sd">            tal1 = TallyCustom(&#39;tal1&#39;, comment=&quot;&quot;, mcnp=&quot;:N 1 2 3&quot;,</span>
<span class="sd">                    tallyclass=CellFlux)</span>
<span class="sd">            tal1 = TallyCustom(&#39;tal1&#39;, comment=&quot;&quot;, mcnp=&quot;:N 1 2 3&quot;,</span>
<span class="sd">                    tallyclass=CellFlux)</span>
<span class="sd">            tal1 = TallyCustom(&#39;tal1&#39;, comment=&quot;&quot;, mcnp=&quot;:N 1 2 3&quot;,</span>
<span class="sd">                    mcnp_pre=&#39;*&#39;,</span>
<span class="sd">                    tallyclass=CellFlux)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># I am intentionally avoiding using super().</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TallyCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_pre</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mcnp_pre&#39;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tallyclass</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;tallyclass&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tallyclass</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">TallyCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                    <span class="mi">10</span> <span class="o">*</span> <span class="n">sim</span><span class="o">.</span><span class="n">tally_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tallyclass</span><span class="o">.</span><span class="n">mcnp_num</span><span class="p">,</span>
                    <span class="n">pre</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mcnp_pre</span> <span class="o">+</span> <span class="s">&quot;F&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">TallyCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                    <span class="n">pre</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mcnp_pre</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="MiscCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.MiscCustom">[docs]</a><span class="k">class</span> <span class="nc">MiscCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">IMisc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`IMisc` card.</span>
<span class="sd">    </span>
<span class="sd">    .. inheritance-diagram:: MiscCustom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>

</div>
<div class="viewcode-block" id="TransformationCustom"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.TransformationCustom">[docs]</a><span class="k">class</span> <span class="nc">TransformationCustom</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">Transformation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Custom :py:class:`Transformation` card.</span>

<span class="sd">    .. inheritance-diagram:: TransformationCustom</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Provide number automatically.</span>
    <span class="c"># TODO correct spacing given the number.</span>
    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">TransformationCustom</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="n">sim</span><span class="o">.</span><span class="n">transformation_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">pre</span><span class="o">=</span><span class="s">&quot;TR&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Particle"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Particle">[docs]</a><span class="k">class</span> <span class="nc">Particle</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Facilitates the use of particle abbreviations, and is an attribute in</span>
<span class="sd">    various cards (:py:class:`ITally` cards, and other :py:class:`IMisc` cards.)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># These are provided in the order in which they are listed in the MCNP</span>
    <span class="c"># manual. TODO may need to escape some of these characters?</span>
    <span class="n">mcnp_abbrev</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;neutron&#39;</span><span class="p">:</span> <span class="s">&#39;N&#39;</span><span class="p">,</span>
                   <span class="s">&#39;anti-neutron&#39;</span><span class="p">:</span> <span class="s">&#39;-N&#39;</span><span class="p">,</span>
                   <span class="s">&#39;photon&#39;</span><span class="p">:</span> <span class="s">&#39;P&#39;</span><span class="p">,</span>
                   <span class="s">&#39;electron&#39;</span><span class="p">:</span> <span class="s">&#39;E&#39;</span><span class="p">,</span>
                   <span class="s">&#39;positron&#39;</span><span class="p">:</span> <span class="s">&#39;-E&#39;</span><span class="p">,</span>
                   <span class="s">&#39;muon&#39;</span><span class="p">:</span> <span class="s">&#39;|&#39;</span><span class="p">,</span>
                   <span class="s">&#39;anti-muon&#39;</span><span class="p">:</span> <span class="s">&#39;-|&#39;</span><span class="p">,</span>
                   <span class="s">&#39;tau&#39;</span><span class="p">:</span> <span class="s">&#39;*&#39;</span><span class="p">,</span>
                   <span class="s">&#39;electron_neutrino&#39;</span><span class="p">:</span> <span class="s">&#39;U&#39;</span><span class="p">,</span>
                   <span class="s">&#39;anti-electron_neutrino&#39;</span><span class="p">:</span> <span class="s">&#39;-U&#39;</span><span class="p">,</span>
                   <span class="s">&#39;muon_neutrino&#39;</span><span class="p">:</span> <span class="s">&#39;V&#39;</span><span class="p">,</span>
                   <span class="s">&#39;tau_neutrino&#39;</span><span class="p">:</span> <span class="s">&#39;W&#39;</span><span class="p">,</span>
                   <span class="s">&#39;proton&#39;</span><span class="p">:</span> <span class="s">&#39;H&#39;</span><span class="p">,</span>
                   <span class="s">&#39;anti-proton&#39;</span><span class="p">:</span> <span class="s">&#39;-H&#39;</span><span class="p">,</span>
                   <span class="s">&#39;lambda&#39;</span><span class="p">:</span> <span class="s">&#39;L&#39;</span><span class="p">,</span>
                   <span class="s">&#39;sigma+&#39;</span><span class="p">:</span> <span class="s">&#39;+&#39;</span><span class="p">,</span>
                   <span class="s">&#39;sigma-&#39;</span><span class="p">:</span> <span class="s">&#39;-&#39;</span><span class="p">,</span>
                   <span class="s">&#39;cascade0&#39;</span><span class="p">:</span> <span class="s">&#39;X&#39;</span><span class="p">,</span>
                   <span class="s">&#39;cascade-&#39;</span><span class="p">:</span> <span class="s">&#39;Y&#39;</span><span class="p">,</span>
                   <span class="s">&#39;omega&#39;</span><span class="p">:</span> <span class="s">&#39;O&#39;</span><span class="p">,</span>
                   <span class="s">&#39;lambdac+&#39;</span><span class="p">:</span> <span class="s">&#39;C&#39;</span><span class="p">,</span>
                   <span class="s">&#39;cascadec+&#39;</span><span class="p">:</span> <span class="s">&#39;!&#39;</span><span class="p">,</span>
                   <span class="s">&#39;cascadec0&#39;</span><span class="p">:</span> <span class="s">&#39;?&#39;</span><span class="p">,</span>
                   <span class="s">&#39;lambdab0&#39;</span><span class="p">:</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span>
                   <span class="s">&#39;pion+&#39;</span><span class="p">:</span> <span class="s">&#39;/&#39;</span><span class="p">,</span>
                   <span class="s">&#39;pion-&#39;</span><span class="p">:</span> <span class="s">&#39;-/&#39;</span><span class="p">,</span>
                   <span class="s">&#39;neutral_pion&#39;</span><span class="p">:</span> <span class="s">&#39;Z&#39;</span><span class="p">,</span>
                   <span class="s">&#39;kaon+&#39;</span><span class="p">:</span> <span class="s">&#39;K&#39;</span><span class="p">,</span>
                   <span class="s">&#39;kaon-&#39;</span><span class="p">:</span> <span class="s">&#39;-K&#39;</span><span class="p">,</span>
                   <span class="s">&#39;K0-short&#39;</span><span class="p">:</span> <span class="s">&#39;%&#39;</span><span class="p">,</span>
                   <span class="s">&#39;K0-long&#39;</span><span class="p">:</span> <span class="s">&#39;^&#39;</span><span class="p">,</span>
                   <span class="s">&#39;D+&#39;</span><span class="p">:</span> <span class="s">&#39;G&#39;</span><span class="p">,</span>
                   <span class="s">&#39;D0&#39;</span><span class="p">:</span> <span class="s">&#39;@&#39;</span><span class="p">,</span>
                   <span class="s">&#39;Ds+&#39;</span><span class="p">:</span> <span class="s">&#39;f&#39;</span><span class="p">,</span>
                   <span class="s">&#39;B+&#39;</span><span class="p">:</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span>
                   <span class="s">&#39;B0&#39;</span><span class="p">:</span> <span class="s">&#39;B&#39;</span><span class="p">,</span>
                   <span class="s">&#39;Bs0&#39;</span><span class="p">:</span> <span class="s">&#39;Q&#39;</span><span class="p">,</span>
                   <span class="s">&#39;deuteron&#39;</span><span class="p">:</span> <span class="s">&#39;D&#39;</span><span class="p">,</span>
                   <span class="s">&#39;triton&#39;</span><span class="p">:</span> <span class="s">&#39;T&#39;</span><span class="p">,</span>
                   <span class="s">&#39;helium-3&#39;</span><span class="p">:</span> <span class="s">&#39;S&#39;</span><span class="p">,</span>
                   <span class="s">&#39;helium-4&#39;</span><span class="p">:</span> <span class="s">&#39;A&#39;</span><span class="p">,</span>
                   <span class="s">&#39;heavy_ions&#39;</span><span class="p">:</span> <span class="s">&#39;#&#39;</span>
                   <span class="p">}</span>
    <span class="sd">&quot;&quot;&quot;Map of particle names to their abbreviations in MCNP.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the particle. Acceptable names depend on the use. For</span>
<span class="sd">            example, the particles acceptable for MCNP are in</span>
<span class="sd">            :py:attr:`mcnp_abbrev`.</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<div class="viewcode-block" id="Particle.mcnp"><a class="viewcode-back" href="../../../pyapi/simplesim/cards.html#pyne.simplesim.cards.Particle.mcnp">[docs]</a>    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        abbrev : str</span>
<span class="sd">            MCNP&#39;s one or two character abbreviation for a particle.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_abbrev</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Particle {0!r} not recognized.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mcnp_abbrev</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</pre></div></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../../index.html">
          <img class="logo" src="../../../_static/pyne_icon_small.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../../gallery/index.html">Gallery</a> | </li>
    <li><a href="../../../index.html">PyNE</a> &raquo;</li>

          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2011-2014, The PyNE Development Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div><script type="text/javascript">
    if(ga_enabled){
        document.write("<div class=\"footer\">This page uses <a href=\"http://analytics.google.com\">Google Analytics</a> to collect statistics. ");
        document.write("Click <button title=\"set cookie to disable analytics for this site\" class=\"link\" onclick=\"$.cookie('disable-ga', 'true', {expires: 3650, path: '/'}); window.location.reload(); return false; \">here</button> to disable analytics for this site.");
        document.write("</div>");
    }else{
        document.write("<div class=\"footer\">Google Analytics has been disabled. ");
        document.write("Click <button title=\"set cookie to re-enable analytics for this site\" class=\"link\" onclick=\"$.cookie('disable-ga', null, {path: '/'}); window.location.reload(); return false; \">here</button> to re-enable analytics for this site.");
    };
</script>
    <!-- cloud_sptheme 1.3 -->
  </body>
</html>