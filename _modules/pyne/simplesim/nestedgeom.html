


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyne.simplesim.nestedgeom &mdash; PyNE 0.2-dev</title>
    
    <link rel="stylesheet" href="../../../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.2-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../../_static/toggle_sections.js"></script>
    <script type="text/javascript" src="../../../_static/toggle_sidebar.js"></script>
    <link rel="shortcut icon" href="../../../_static/pyne_icon.ico"/>
    <link rel="top" title="PyNE 0.2-dev" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../../index.html">PyNE</a> &raquo;</li>

          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyne.simplesim.nestedgeom</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>

<span class="sd">&quot;&quot;&quot;The classes in this module aid the specification of tally `units`  in</span>
<span class="sd">:py:class:`pyne.simplesim.cards.ICellSurfTally` (see examples below). The class</span>
<span class="sd">focuses on the ability to specify cells and surfaces that are nested within</span>
<span class="sd">universes or other cells in nearly arbitrarily complex ways. Apart from making</span>
<span class="sd">user input clearler, this class has methods that help with creating cell</span>
<span class="sd">comments and mcnp strings. </span>

<span class="sd">The names of classes here are fairly short, so the user may not want to import</span>
<span class="sd">the entire namespace. A suggested way to import the module is::</span>

<span class="sd">    import pyne.simplesim.nestedgeom as ng</span>


<span class="sd">An inheritance diagram of all the classes in this module can be found at</span>
<span class="sd">:ref:`pyne_simplesim_inheritance`.</span>


<span class="sd">Usage Examples</span>
<span class="sd">--------------</span>
<span class="sd">The subclasses of :py:class:`ICellSurfTally` can take as input any subclass of</span>
<span class="sd">:py:class:`IUnit`. The following shows different ways in which complex units</span>
<span class="sd">can be built. Here it is assumed that there is a cell named &#39;1&#39; in the system,</span>
<span class="sd">a surface named &#39;1&#39; in the system, a universe named &#39;1&#39; in the system, etc. The</span>
<span class="sd">unions represent averaging or totaling the units, depending on the type of</span>
<span class="sd">tally.</span>

<span class="sd">+-----------+-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|category   |description                                                  |nestedgeom                                                  |mcnp                   |</span>
<span class="sd">+===========+=============================================================+============================================================+=======================+</span>
<span class="sd">|basic      |surface 1 (s1)                                               |``s1 = Surf(&#39;1&#39;)``                                          |1                      |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |cell 1 (c1)                                                  |``c1 = Cell(&#39;1&#39;)``                                          |1                      |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |universe 1 (u1)                                              |``u1 = Univ(&#39;1&#39;)``                                          |U=1                    |</span>
<span class="sd">+-----------+-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|union      |union of s1 and s2                                           |``Union(s1, s2)``                                           |(1 2)                  |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``(s1 | s2)``                                               |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |union of c1, c2, and c3                                      |``Union(c1, c2, c3)``                                       |(1 2 3)                |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``(c1 | c2 | c3)``                                          |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |union of cells in u1                                         |``Union(u1)``                                               |(U=1)                  |</span>
<span class="sd">+-----------+-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|nesting    |s1 in filled cell 2 (fc2)                                    |``fc2 = FCell(&#39;2&#39;): s1 &lt; fc2``                              |(1 &lt; 1)                |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``s1.of(fc2)``                                              |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |c1 in fc3 in fc3                                             |``c1 &lt; fc2 &lt; fc3``                                          |(1 &lt; 2 &lt; 3)            |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``c1.of( fc2.of(fc3) )``                                    |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in union of fc2 and fc3                                   |``s1 &lt; Union(fc2, fc3)``                                    |(1 &lt; (2 3))            |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``s1.of( Union(fc2, fc3) )``                                |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in (union of fc2 and fc3) in fc4                          |``s1 &lt; Union(fc2, fc3) &lt; fc4``                              |(1 &lt; (2 3) &lt; 4)        |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``s1.of( Union(fc2, fc3).of(fc4) )``                        |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in u1 in fc4                                              |``s1 &lt; u1 &lt; fc4``                                           |(1 &lt; U=1 &lt; 4)          |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``s1.of( u1.of(fc4) )``                                     |                       |</span>
<span class="sd">+-----------+-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|vectorized |(over s1 and s2) in fc2                                      |``ng.Vec(s1, s2) &lt; fc2``                                    |(1 2 &lt; 2)              |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``ng.Vec(s1, s2).of(fc2)``                                  |                       |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``(s1 &amp; s2) &lt; fc2``                                         |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in (over fc2 and fc3)                                     |``s1 &lt; ng.Vec(fc2, fc3)``                                   |(1 &lt; 2 3)              |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``s1 &lt; (fc2 &amp; fc3)``                                        |                       |</span>
<span class="sd">+-----------+-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|lattice    |s1 in (union of fc2 and (fc3 in lattice elem 5)) in fc4      |``la = Lin(5): s1 &lt; (fc2 | FCell(&#39;3&#39;, la)) &lt; fc4``          |(1 &lt; (2 3[5]) &lt; 4      |</span>
<span class="sd">|           |                                                             +------------------------------------------------------------+                       |</span>
<span class="sd">|           |                                                             |``s1 &lt; (fc2 | fc3.lat(la)) &lt; fc4``                          |                       |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in (fc2 in lattice x range 0:1, y range 0:2, z range 0:3) |``s1 &lt; fc2.lat(Rng([0,1], [0,2], [0,3])``                   |(1 &lt; 2[0:1 0:2 0:3])   |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in (fc2 in lattice coord (0, 1, 2))                       |``s1 &lt; fc2.lat(Cor([0, 1, 2]))``                            |(1 &lt; 2[0 1 2])         |</span>
<span class="sd">|           +-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>
<span class="sd">|           |s1 in (fc2 in lattice coords (0, 1, 2), (3, 2, 1))           |``s1 &lt; fc2.lat( Cor([ [0, 1, 2], [3, 2, 1]]) )``            |(1 &lt; 2[0 1 2, 3 2 1])  |</span>
<span class="sd">+-----------+-------------------------------------------------------------+------------------------------------------------------------+-----------------------+</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<div class="viewcode-block" id="IUnit"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.IUnit">[docs]</a><span class="k">class</span> <span class="nc">IUnit</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for tally units. The user does not use this class</span>
<span class="sd">    directly.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO need to define a &#39;recursive&#39; __repr__.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">up</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">down</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Currently, the two keyword arguments are not actually used, but are</span>
<span class="sd">        sometimes set directly, after initialization.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="n">down</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">next_level_up</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The user can use the &lt; operator to perform the operation of</span>
<span class="sd">        :py:meth:`of`, e.g. (cells/surfs) &lt; (cells/univ)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">next_level_up</span><span class="p">)</span>

<div class="viewcode-block" id="IUnit.of"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.IUnit.of">[docs]</a>    <span class="k">def</span> <span class="nf">of</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">next_level_up</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a unit where ``self`` must be in ``next_level_up`` to be</span>
<span class="sd">        tallied. ``self`` must be a cell or surface, or `vector` or `union`</span>
<span class="sd">        thereof (cell/surf), and</span>
<span class="sd">        ``next_level_up`` can be a cell or universe, or union thereof</span>
<span class="sd">        (cells/univ).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="n">next_level_up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">down</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span>
        <span class="k">else</span><span class="p">:</span>         <span class="k">return</span> <span class="bp">self</span>
</div>
    <span class="k">def</span> <span class="nf">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A convenient way to call :py:meth:`union`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

<div class="viewcode-block" id="IUnit.union"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.IUnit.union">[docs]</a>    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a :py:class:`Union` of ``self`` with ``right``.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Union</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">brothers</span> <span class="o">+=</span> <span class="p">[</span><span class="n">right</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A convenient way to call :py:meth:`vector`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

<div class="viewcode-block" id="IUnit.vector"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.IUnit.vector">[docs]</a>    <span class="k">def</span> <span class="nf">vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a :py:class:`Vec` of ``self`` with ``right``.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Vec</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sisters</span> <span class="o">+=</span> <span class="p">[</span><span class="n">right</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0}{1}{2}{3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s">&quot; (&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="n">inner</span><span class="p">,</span>
                <span class="p">(</span><span class="s">&quot; in&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">comment</span><span class="p">())</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot;)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">inner</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;{0}{1}{2}{3}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s">&quot; (&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="n">inner</span><span class="p">,</span>
                <span class="p">(</span><span class="s">&quot; &lt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
                <span class="s">&quot;)&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">down</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ICellSurf"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.ICellSurf">[docs]</a><span class="k">class</span> <span class="nc">ICellSurf</span><span class="p">(</span><span class="n">IUnit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for surfaces and cells in the lowest level of the</span>
<span class="sd">    nested geometry. The user directly uses the subclasses of this class. For</span>
<span class="sd">    cells in higher levels of nesting (e.g. closer to the real world), see</span>
<span class="sd">    :py:class:`FCell`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the surface or cell. Depending on the subclass, the name is</span>
<span class="sd">            looked up appropriately in the system definition to obtain the</span>
<span class="sd">            surface or cell number.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ICellSurf</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

</div>
<div class="viewcode-block" id="Surf"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Surf">[docs]</a><span class="k">class</span> <span class="nc">Surf</span><span class="p">(</span><span class="n">ICellSurf</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The user uses this class directly to reference a surface in the system</span>
<span class="sd">    definition for tallying.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Surf</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Surf</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot; surf {0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Surf</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot; {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">surface_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="Cell"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Cell">[docs]</a><span class="k">class</span> <span class="nc">Cell</span><span class="p">(</span><span class="n">ICellSurf</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The user uses this class directly to reference a cell in the system</span>
<span class="sd">    definition for tallying.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Cell</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Cell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot; cell {0!r}{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">inner</span> <span class="k">if</span> <span class="n">inner</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Cell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot; {0}{1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">cell_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                    <span class="n">inner</span> <span class="k">if</span> <span class="n">inner</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="FCell"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.FCell">[docs]</a><span class="k">class</span> <span class="nc">FCell</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This is subclassed from :py:class:`Cell`. Its name stands for filled</span>
<span class="sd">    cell. It is to be used for higher-level cells (closer to the real world),</span>
<span class="sd">    and has an additional attribute to specify specific lattice elements from</span>
<span class="sd">    this cell if it is a lattice cell.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.FCell</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lat_spec</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            See :py:class:`ICellSurf`.</span>
<span class="sd">        lat_sec : subclass of :py:class:`LatticeSpec`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat_spec</span> <span class="o">=</span> <span class="n">lat_spec</span>

    <span class="k">def</span> <span class="nf">lat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat_spec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat_spec</span> <span class="o">=</span> <span class="n">lat_spec</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">FCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lat_spec</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_spec</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">FCell</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lat_spec</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat_spec</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Univ"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Univ">[docs]</a><span class="k">class</span> <span class="nc">Univ</span><span class="p">(</span><span class="n">IUnit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A universe. It is used in higher levels of nesting (closer to the real</span>
<span class="sd">    world). The class, given the name of a universe in the system, looks up the</span>
<span class="sd">    appropriate universe number.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Univ</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the universe in the system definition.  </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Univ</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Univ</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot; univ {0!r}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Univ</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot; U={0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">universe_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="Union"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Union">[docs]</a><span class="k">class</span> <span class="nc">Union</span><span class="p">(</span><span class="n">IUnit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A union of surfaces, cells, or of a single universe.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Union</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        *args : list of instances of :py:class:`IUnit` subclasses.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># all args must be a instance of Unit or its subclasses.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brothers</span> <span class="o">=</span> <span class="n">args</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Union</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">bro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brothers</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">bro</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brothers</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Union</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot; union of ({0})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">bro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brothers</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">bro</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Union</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> 
                <span class="s">&quot; ({0})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Vec"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Vec">[docs]</a><span class="k">class</span> <span class="nc">Vec</span><span class="p">(</span><span class="n">IUnit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A &quot;vector&quot; of surfaces or cells. This class named after the vectorized</span>
<span class="sd">    notation that can be used in MATLAB, as this class allows the specification</span>
<span class="sd">    of multiple units of input in a single unit. Typically, a :py:class:`Vec`</span>
<span class="sd">    is the first or last element in a nested unit. The following are two</span>
<span class="sd">    example usages of this class, and their equivalent in comment as two</span>
<span class="sd">    separate units::</span>

<span class="sd">        # Surf(&#39;A&#39;) &lt; FCell(&#39;C&#39;)     Surf(&#39;B&#39;) &lt; FCell(&#39;C&#39;)</span>
<span class="sd">        Vec(Surf(&#39;A&#39;), Surf(&#39;B&#39;)) &lt; FCell(&#39;C&#39;)</span>
<span class="sd">        # Surf(&#39;A&#39;) &lt; FCell(&#39;C&#39;)     Surf(&#39;A&#39;) &lt; FCell(&#39;D&#39;)</span>
<span class="sd">        Surf(&#39;A&#39;) &lt; Vec(FCell(&#39;C&#39;), FCell(&#39;D&#39;))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Named after matlab&#39;s vectorized notation</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="c"># all args must be a instance of Unit or its subclasses.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sisters</span> <span class="o">=</span> <span class="n">args</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Vec</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">sis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sisters</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">sis</span><span class="o">.</span><span class="n">comment</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sisters</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Vec</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot; over ({0})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">sis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sisters</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="n">sis</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Vec</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ILatticeSpec"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.ILatticeSpec">[docs]</a><span class="k">class</span> <span class="nc">ILatticeSpec</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for lattice element specifiers. The user does not</span>
<span class="sd">    use this class directly. There are 3 subclasses:</span>

<span class="sd">    - :py:class:`Lin` : a single linear index of a lattice element.</span>
<span class="sd">    - :py:class:`Rng` : x, y, and z index range of lattice elements.</span>
<span class="sd">    - :py:class:`Cor` : list coordinates of lattice elments.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;-lat {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inner</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">inner</span><span class="p">):</span>
        <span class="c"># Lattice specification goes in square brackets.</span>
        <span class="k">return</span> <span class="s">&quot;[{0}]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">inner</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Lin"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Lin">[docs]</a><span class="k">class</span> <span class="nc">Lin</span><span class="p">(</span><span class="n">ILatticeSpec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A single linear index of a lattice element.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Lin</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linear_index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        linear_index : int</span>
<span class="sd">            Linear (1-D) of a lattice element for the lattice cell that this</span>
<span class="sd">            specifier becomes a part of.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">linear_index</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Lin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="s">&quot;linear idx {0:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Lin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot;{0:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Rng"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Rng">[docs]</a><span class="k">class</span> <span class="nc">Rng</span><span class="p">(</span><span class="n">ILatticeSpec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A range of lattice elements.</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Rng</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">z_bounds</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x_bounds : 2-element list of int, optional</span>
<span class="sd">            Something like [0,5] for lattice elements i=0 through i=5. First</span>
<span class="sd">            element is less than the second element. Don&#39;t</span>
<span class="sd">            specify to leave as [0, 0].</span>
<span class="sd">        y_bounds : 2-element list of int, optional</span>
<span class="sd">            First element is less than the second element. Don&#39;t specify to</span>
<span class="sd">            leave as [0, 0].</span>
<span class="sd">        z_bounds : 2-element list of int, optional</span>
<span class="sd">            First element is less than the second element. Don&#39;t specify to</span>
<span class="sd">            leave as [0, 0].</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        In the following, there is no y dimension::</span>

<span class="sd">            myrange = Rng([0, 5], z_bounds=[0, 2])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Rng</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_bounds</span> <span class="o">=</span> <span class="n">x_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_bounds</span> <span class="o">=</span> <span class="n">y_bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_bounds</span> <span class="o">=</span> <span class="n">z_bounds</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Rng</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span>
                <span class="s">&quot;x range {0[0]:d}:{0[1]:d}, y range {1[0]:d}:{1[1]:d}, &quot;</span>
                <span class="s">&quot;z range {2[0]:d}:{2[1]:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_bounds</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Rng</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span>
                <span class="s">&quot;{0[0]:d}:{0[1]:d} {1[0]:d}:{1[1]:d} {2[0]:d}:{2[1]:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_bounds</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="Cor"><a class="viewcode-back" href="../../../libref/simplesim_nestedgeom.html#pyne.simplesim.nestedgeom.Cor">[docs]</a><span class="k">class</span> <span class="nc">Cor</span><span class="p">(</span><span class="n">ILatticeSpec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A list of lattice element coordinates (in indices).</span>

<span class="sd">    .. inheritance-diagram:: pyne.simplesim.nestedgeom.Cor</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points : 3-element list of int, list of lists, optional</span>
<span class="sd">            Coordinates of a lattice element, or a list of coordinates.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        The following work::</span>

<span class="sd">            latspec = Cor()</span>
<span class="sd">            latspec = Cor([1, 2, 3])</span>
<span class="sd">            latspec = Cor([ [1, 2, 3], [-1, 3, -2]])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="c"># We want a nested list, even if the user doesn&#39;t provide it. If the</span>
        <span class="c"># first element of the list is an int, then it&#39;s not a 3-element list</span>
        <span class="c"># or numpy array, so we need to nest it in a loop for the methods to</span>
        <span class="c"># work.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span> <span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">points</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">points</span>

    <span class="k">def</span> <span class="nf">comment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;coords&quot;</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; ({0[0]:d}, {0[1]:d}, {0[2]:d})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Cor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">comment</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mcnp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot; {0[0]:d} {0[1]:d} {0[2]:d}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">):</span> <span class="n">string</span> <span class="o">+=</span> <span class="s">&quot;,&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Cor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">mcnp</span><span class="p">(</span><span class="n">float_format</span><span class="p">,</span> <span class="n">sim</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>



<span class="c"># # &quot;raw&quot; docstring for table above.</span>
<span class="c"># ====</span>
<span class="c"># MCNP</span>
<span class="c"># ====</span>
<span class="c"># 1</span>
<span class="c"># 1</span>
<span class="c"># U=1</span>
<span class="c"># </span>
<span class="c"># (1 2)</span>
<span class="c"># (1 2 3)</span>
<span class="c"># (U=1)</span>
<span class="c"># </span>
<span class="c"># (1 &lt; 1)</span>
<span class="c"># (1 &lt; 2 &lt; 3)</span>
<span class="c"># (1 &lt; (2 3))</span>
<span class="c"># (1 &lt; (2 3) &lt; 4)</span>
<span class="c"># </span>
<span class="c"># (1 2 &lt; 2)</span>
<span class="c"># (1 &lt; 2 3)</span>
<span class="c"># </span>
<span class="c"># 1 &lt; (2 3[5]) &lt; 4</span>
<span class="c"># 1 &lt; 2[0:1 0:2 0:3]</span>
<span class="c"># 1 &lt; 2[0 1 2]</span>
<span class="c"># 1 &lt; 2[0 1 2, 3 2 1]</span>
<span class="c"># </span>
<span class="c"># ===========</span>
<span class="c"># description</span>
<span class="c"># ===========</span>
<span class="c"># surface 1 (s1)</span>
<span class="c"># cell 1 (c1)</span>
<span class="c"># universe 1 (u1)</span>
<span class="c"># </span>
<span class="c"># union of s1 and s2</span>
<span class="c"># union of c1, c2, and c3</span>
<span class="c"># union of cells in u1</span>
<span class="c"># </span>
<span class="c"># s1 in filled cell 2 (fc2)</span>
<span class="c"># c1 in fc3 in fc3</span>
<span class="c"># s1 in union of fc2 and fc3</span>
<span class="c"># s1 in (union of fc2 and fc3) in fc4</span>
<span class="c"># s1 in u1 in fc4</span>
<span class="c"># </span>
<span class="c"># (over s1 and s2) in fc2</span>
<span class="c"># s1 in (over fc2 and fc3)</span>
<span class="c"># </span>
<span class="c"># s1 in (union of fc2 and (fc3 in lattice elem 5)) in fc4</span>
<span class="c"># s1 in (fc2 in lattice x range 0:1, y range 0:2, z range 0:3)</span>
<span class="c"># s1 in (fc2 in lattice coord (0, 1, 2))</span>
<span class="c"># s1 in (fc2 in lattice coords (0, 1, 2), (3, 2, 1))</span>
<span class="c"># </span>
<span class="c"># ==========</span>
<span class="c"># nestedgeom</span>
<span class="c"># ==========</span>
<span class="c"># s1 = Surf(&#39;1&#39;)</span>
<span class="c"># c1 = Cell(&#39;1&#39;)</span>
<span class="c"># u1 = Univ(&#39;1&#39;)</span>
<span class="c"># </span>
<span class="c"># Union(s1, s2)  /  (s1 | s2)</span>
<span class="c"># Union(c1, c2, c3)  /  (c1 | c2 | c3)</span>
<span class="c"># Union(u1)</span>
<span class="c"># </span>
<span class="c"># fc2 = FCell(&#39;2&#39;): s1 &lt; fc2  /  s1.of(fc2)</span>
<span class="c"># c1 &lt; fc2 &lt; fc3  /  c1.of( fc2.of(fc3) )</span>
<span class="c"># s1 &lt; Union(fc2, fc3)  /  s1.of( Union(fc2, fc3) )</span>
<span class="c"># s1 &lt; Union(fc2, fc3) &lt; fc4  /  s1.of( Union(fc2, fc3).of(fc4) )</span>
<span class="c"># s1 &lt; u1 &lt; fc4  /  s1.of( u1.of(fc4) )</span>
<span class="c"># </span>
<span class="c"># ng.Vec(s1, s2) &lt; fc2  /  ng.Vec(s1, s2).of(fc2)  /  (s1 &amp; s2) &lt; fc2</span>
<span class="c"># s1 &lt; ng.Vec(fc2, fc3)  /  s1 &lt; (fc2 &amp; fc3)</span>
<span class="c"># </span>
<span class="c"># la = Lin(5): s1 &lt; (fc2 | FCell(&#39;3&#39;, la)) &lt; fc4  /  s1 &lt; (fc2 | fc3.lat(la)) &lt; fc4</span>
<span class="c"># s1 &lt; fc2.lat(Rng([0,1], [0,2], [0,3])</span>
<span class="c"># s1 &lt; fc2.lat(Cor([0, 1, 2]))</span>
<span class="c"># s1 &lt; fc2.lat( Cor([ [0, 1, 2], [3, 2, 1]]) )</span>
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../../index.html">
          <img class="logo" src="../../../_static/pyne_icon_small.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../../index.html">PyNE</a> &raquo;</li>

          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2011-2012, The PyNE Development Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
    <!-- cloud_sptheme 1.3 -->
  </body>
</html>