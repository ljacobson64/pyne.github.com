


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyne.ace &mdash; PyNE 0.1</title>
    <link rel="stylesheet" href="../../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/toggle_sections.js"></script>
    <script type="text/javascript" src="../../_static/toggle_sidebar.js"></script>
    <link rel="shortcut icon" href="../../_static/pyne_icon.ico"/>
    <link rel="top" title="PyNE 0.1" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">PyNE</a> &raquo;</li>

          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pyne.ace</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>

<span class="sd">&quot;&quot;&quot;This module is for reading ACE-format cross sections. ACE stands for &quot;A Compact</span>
<span class="sd">ENDF&quot; format and originated from work on MCNP_. It is used in a number of other</span>
<span class="sd">Monte Carlo particle transport codes.</span>

<span class="sd">ACE-format cross sections are typically generated from ENDF_ files through a</span>
<span class="sd">cross section processing program like NJOY_. The ENDF data consists of tabulated</span>
<span class="sd">thermal data, ENDF/B resonance parameters, distribution parameters in the</span>
<span class="sd">unresolved resonance region, and tabulated data in the fast region. After the</span>
<span class="sd">ENDF data has been reconstructed and Doppler-broadened, the ACER module</span>
<span class="sd">generates ACE-format cross sections.</span>

<span class="sd">.. _MCNP: http://mcnp-green.lanl.gov/</span>

<span class="sd">.. _NJOY: http://t2.lanl.gov/codes/codes.html</span>

<span class="sd">.. _ENDF: http://www.nndc.bnl.gov/endf</span>

<span class="sd">.. moduleauthor:: Paul Romano &lt;romano7@gmail.com&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">struct</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">copy</span><span class="p">,</span> <span class="n">meshgrid</span><span class="p">,</span> <span class="n">interp</span><span class="p">,</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">arccos</span><span class="p">,</span> <span class="n">concatenate</span>
<span class="kn">from</span> <span class="nn">bisect</span> <span class="kn">import</span> <span class="n">bisect_right</span>

<span class="kn">from</span> <span class="nn">pyne</span> <span class="kn">import</span> <span class="n">nucname</span>

<div class="viewcode-block" id="Library"><a class="viewcode-back" href="../../libref/ace.html#pyne.ace.Library">[docs]</a><span class="k">class</span> <span class="nc">Library</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Library objects represents an ACE-formatted file which may contain</span>
<span class="sd">    multiple tables with data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        Path of the ACE library file to load.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="c"># Determine whether file is ASCII or binary</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
            <span class="c"># Grab 10 lines of the library</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>

            <span class="c"># Try to decode it with ascii</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">)</span>

            <span class="c"># No exception so proceed with ASCII</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c"># Set verbosity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tables</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Library.read"><a class="viewcode-back" href="../../libref/ace.html#pyne.ace.Library.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read through and parse the ACE-format library.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_names : None, str, or iterable, optional</span>
<span class="sd">            Tables from the file to read in.  If None, reads in all of the </span>
<span class="sd">            tables. If str, reads in only the single table of a matching name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">table_names</span><span class="p">,</span> <span class="nb">basestring</span><span class="p">):</span>
            <span class="n">table_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">table_names</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">table_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">table_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">table_names</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_binary</span><span class="p">(</span><span class="n">table_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_ascii</span><span class="p">(</span><span class="n">table_names</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_read_binary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_names</span><span class="p">,</span> <span class="n">recl_length</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">entries</span><span class="o">=</span><span class="mi">512</span><span class="p">):</span>

        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">start_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>

            <span class="c"># Check for end-of-file</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">start_position</span><span class="p">)</span>

            <span class="c"># Read name, atomic weight ratio, temperature, date, comment, and</span>
            <span class="c"># material</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">mat</span> <span class="o">=</span> \
                <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;=10sdd10s70s10s&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">116</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="c"># Read ZAID/awr combinations</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;=&#39;</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">192</span><span class="p">))</span>

            <span class="c"># Read NXS</span>
            <span class="n">NXS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;=16i&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">64</span><span class="p">)))</span>

            <span class="c"># Determine length of XSS and number of records</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">NXS</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">n_records</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span> <span class="o">+</span> <span class="n">entries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">entries</span>

            <span class="c"># verify that we are suppossed to read this table in</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">table_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_names</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">start_position</span> <span class="o">+</span> <span class="n">recl_length</span><span class="o">*</span><span class="p">(</span><span class="n">n_records</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="c"># ensure we have a valid table type</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_types</span><span class="p">:</span>
                <span class="c"># TODO: Make this a proper exception.</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Unsupported table: &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">start_position</span> <span class="o">+</span> <span class="n">recl_length</span><span class="o">*</span><span class="p">(</span><span class="n">n_records</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="c"># get the table</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">table_types</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]](</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

            <span class="n">temp_in_K</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="o">/</span> <span class="mf">8.617342e-5</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Loading nuclide {0} at {1} K ({2})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">nucname</span><span class="o">.</span><span class="n">serpent</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">temp_in_K</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span>

            <span class="c"># Set NXS and read JXS</span>
            <span class="n">table</span><span class="o">.</span><span class="n">NXS</span> <span class="o">=</span> <span class="n">NXS</span>
            <span class="n">table</span><span class="o">.</span><span class="n">JXS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;=32i&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">128</span><span class="p">)))</span>

            <span class="c"># Read XSS</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">start_position</span> <span class="o">+</span> <span class="n">recl_length</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">XSS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;={0}d&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">length</span><span class="p">),</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="mi">8</span><span class="p">)))</span>

            <span class="c"># Insert empty object at beginning of NXS, JXS, and XSS</span>
            <span class="c"># arrays so that the indexing will be the same as</span>
            <span class="c"># Fortran. This makes it easier to follow the ACE format</span>
            <span class="c"># specification.</span>
            <span class="n">table</span><span class="o">.</span><span class="n">NXS</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">JXS</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">XSS</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="c"># Read all data blocks</span>
            <span class="n">table</span><span class="o">.</span><span class="n">_read_all</span><span class="p">()</span>

            <span class="c"># Advance to next record</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">start_position</span> <span class="o">+</span> <span class="n">recl_length</span><span class="o">*</span><span class="p">(</span><span class="n">n_records</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_read_ascii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_names</span><span class="p">):</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># Check end condition</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="k">break</span>

            <span class="c"># Read name of table, atomic weight ratio, and temperature. If first</span>
            <span class="c"># line is empty, we are at end of file</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">awr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">nxs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
            <span class="n">n_lines</span> <span class="o">=</span> <span class="p">(</span><span class="n">nxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>

            <span class="c"># verify that we are suppossed to read this table in</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">table_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_names</span><span class="p">):</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">12</span><span class="o">+</span><span class="n">n_lines</span><span class="p">:]</span>
                <span class="k">continue</span>

            <span class="c"># ensure we have a valid table type</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_types</span><span class="p">:</span>
                <span class="c"># TODO: Make this a proper exception.</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Unsupported table: &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">12</span><span class="o">+</span><span class="n">n_lines</span><span class="p">:]</span>
                <span class="k">continue</span>

            <span class="c"># get the table</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">table_types</span><span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]](</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

            <span class="n">temp_in_K</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="o">/</span> <span class="mf">8.617342e-5</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Loading nuclide {0} at {1} K ({2})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">nucname</span><span class="o">.</span><span class="n">serpent</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">temp_in_K</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span>

            <span class="c"># Read comment</span>
            <span class="n">table</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="c"># Read NXS and JXS arrays</span>
            <span class="n">table</span><span class="o">.</span><span class="n">NXS</span> <span class="o">=</span> <span class="n">nxs</span>
            <span class="n">table</span><span class="o">.</span><span class="n">JXS</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">12</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>

            <span class="c"># Read XSS array</span>
            <span class="c">#table.XSS = [float(i) for i in &#39;&#39;.join(lines[12:12+n_lines]).split()]</span>
            <span class="n">datastr</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">12</span><span class="o">+</span><span class="n">n_lines</span><span class="p">])</span>
            <span class="n">xss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">datastr</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">XSS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xss</span><span class="p">)</span>

            <span class="c"># Insert empty object at beginning of NXS, JXS, and XSS</span>
            <span class="c"># arrays so that the indexing will be the same as</span>
            <span class="c"># Fortran. This makes it easier to follow the ACE format</span>
            <span class="c"># specification.</span>
            <span class="n">table</span><span class="o">.</span><span class="n">NXS</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">JXS</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="n">table</span><span class="o">.</span><span class="n">XSS</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

            <span class="c"># Read all data blocks</span>
            <span class="n">table</span><span class="o">.</span><span class="n">_read_all</span><span class="p">()</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">12</span><span class="o">+</span><span class="n">n_lines</span><span class="p">:]</span>

<div class="viewcode-block" id="Library.find_table"><a class="viewcode-back" href="../../libref/ace.html#pyne.ace.Library.find_table">[docs]</a>    <span class="k">def</span> <span class="nf">find_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a cross-section table with a given name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the cross-section table, e.g. 92235.70c</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<span class="k">class</span> <span class="nc">AceTable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract superclass of all other classes for cross section tables.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">awr</span> <span class="o">=</span> <span class="n">awr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="k">def</span> <span class="nf">_read_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
        
<span class="k">class</span> <span class="nc">NeutronTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A NeutronTable object contains continuous-energy neutron interaction data</span>
<span class="sd">    read from an ACE-formatted Type I table. These objects are not normally</span>
<span class="sd">    instantiated by the user but rather created when reading data using a</span>
<span class="sd">    Library object and stored within the ``tables`` attribute of a Library object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        ZAID identifier of the table, e.g. 92235.70c.</span>
<span class="sd">    awr : float</span>
<span class="sd">        Atomic weight ratio of the target nuclide.</span>
<span class="sd">    temp : float</span>
<span class="sd">        Temperature of the target nuclide in eV.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NeutronTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Continuous-E Neutron Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Continuous-E Neutron Table&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">_read_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_esz</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_nu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_mtr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_lqr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_tyr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_lsig</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_sig</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_land</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_and</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_ldlw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_dlw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_gpd</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_mtrp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_lsigp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_sigp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_landp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_andp</span><span class="p">()</span>
        <span class="c"># Read LDLWP block</span>
        <span class="c"># Read DLWP block</span>
        <span class="c"># Read YP block</span>
        <span class="c"># self._read_yp()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_fis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_unr</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_read_esz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read ESZ block -- this block contains the energy grid, total</span>
<span class="sd">        xs, absorption xs, elastic scattering xs, and heating numbers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">energy</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_t</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_a</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="n">sigma_el</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heating</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

        <span class="c"># Create elastic scattering reaction</span>
        <span class="n">MT</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">rxn</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">MT</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">rxn</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">rxn</span><span class="o">.</span><span class="n">IE</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">rxn</span><span class="o">.</span><span class="n">TY</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">rxn</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma_el</span>

        <span class="c"># Add elastic scattering to list of reactions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>

        <span class="c"># Create photon-producting reaction list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photonReactions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_read_nu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the NU block -- this contains information on the prompt</span>
<span class="sd">        and delayed neutron precursor yields, decay constants, etc</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c"># No NU block</span>
        <span class="k">if</span> <span class="n">JXS2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c"># Either prompt nu or total nu is given</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">KNU</span> <span class="o">=</span> <span class="n">JXS2</span>
            <span class="n">LNU</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="p">])</span>

            <span class="c"># Polynomial function form of nu</span>
            <span class="k">if</span> <span class="n">LNU</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_type</span> <span class="o">=</span> <span class="s">&quot;polynomial&quot;</span>
                <span class="n">NC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">coeffs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NC</span><span class="p">]</span>
                
            <span class="c"># Tabular data form of nu</span>
            <span class="k">elif</span> <span class="n">LNU</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_type</span> <span class="o">=</span> <span class="s">&quot;tabular&quot;</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">interp_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span>  <span class="p">]</span>
                    <span class="n">interp_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">]</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span>  <span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_value</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NE</span><span class="p">]</span>

        <span class="c"># Both prompt nu and total nu</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">KNU</span> <span class="o">=</span> <span class="n">JXS2</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">LNU</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="p">])</span>

            <span class="c"># Polynomial function form of nu</span>
            <span class="k">if</span> <span class="n">LNU</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_p_type</span> <span class="o">=</span> <span class="s">&quot;polynomial&quot;</span>
                <span class="n">NC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">coeffs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NC</span><span class="p">]</span>
                
            <span class="c"># Tabular data form of nu</span>
            <span class="k">elif</span> <span class="n">LNU</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_p_type</span> <span class="o">=</span> <span class="s">&quot;tabular&quot;</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">interp_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span>  <span class="p">]</span>
                    <span class="n">interp_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">]</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_p_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span>  <span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_p_value</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NE</span><span class="p">]</span>
                
            <span class="n">KNU</span> <span class="o">=</span> <span class="n">JXS2</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS2</span><span class="p">]))</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">LNU</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="p">])</span>

            <span class="c"># Polynomial function form of nu</span>
            <span class="k">if</span> <span class="n">LNU</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_type</span> <span class="o">=</span> <span class="s">&quot;polynomial&quot;</span>
                <span class="n">NC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">coeffs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NC</span><span class="p">]</span>
                
            <span class="c"># Tabular data form of nu</span>
            <span class="k">elif</span> <span class="n">LNU</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_type</span> <span class="o">=</span> <span class="s">&quot;tabular&quot;</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">interp_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span>  <span class="p">]</span>
                    <span class="n">interp_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">]</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span>  <span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_t_value</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NE</span><span class="p">]</span>
    
        <span class="c"># Check for delayed nu data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">KNU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
            <span class="n">NR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">interp_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span>  <span class="p">]</span>
                <span class="n">interp_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">]</span>
            <span class="n">NE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span>    <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span>  <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_value</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span> <span class="p">:</span> <span class="n">KNU</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NE</span><span class="p">]</span>

            <span class="c"># Delayed neutron precursor distribution</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_precursor_const</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_precursor_energy</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_precursor_prob</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span>
            <span class="n">n_group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_group</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_precursor_const</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">interp_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span>    <span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span><span class="p">]</span>
                    <span class="n">interp_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">NR</span> <span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">]</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_precursor_energy</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span>    <span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span>  <span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nu_d_precursor_prob</span><span class="p">[</span><span class="n">group</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="n">NE</span> <span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NE</span><span class="p">]</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NR</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">NE</span>

            <span class="c"># Energy distribution for delayed fission neutrons</span>
            <span class="n">LED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span>
            <span class="n">LOCC</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_group</span><span class="p">):</span>
                <span class="n">LOCC</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">LED</span> <span class="o">+</span> <span class="n">group</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_read_mtr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the list of reaction MTs for this cross-section table. The</span>
<span class="sd">        MT values are somewhat arbitrary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">NMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NMT</span><span class="p">):</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">LMT</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Reaction</span><span class="p">(</span><span class="n">MT</span><span class="p">,</span><span class="bp">self</span><span class="p">))</span>
            
    <span class="k">def</span> <span class="nf">_read_lqr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find Q-values for each reaction MT</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS4</span><span class="o">+</span><span class="n">i</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_read_tyr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the neutron release for each reaction MT. A neutron</span>
<span class="sd">        release of 19 indicates fission. A neutron release greater</span>
<span class="sd">        than 100 signifies reactions other than fission taht have</span>
<span class="sd">        energy-dependent neutron multiplicities</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">TY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS5</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_read_lsig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine location of cross sections for each reaction MT</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LXS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">LXS</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_read_sig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read cross-sections for each reaction MT</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">IE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS7</span><span class="o">+</span><span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">NE</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS7</span><span class="o">+</span><span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span><span class="p">])</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS7</span><span class="o">+</span><span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span><span class="o">+</span><span class="mi">1</span> <span class="p">:</span> <span class="n">JXS7</span><span class="o">+</span><span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">NE</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_read_land</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find locations for angular distributions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>

        <span class="c"># Number of reactions is less than total since we only need</span>
        <span class="c"># angular distribution for reactions with secondary</span>
        <span class="c"># neutrons. Thus, MT &gt; 100 are not included.</span>
        <span class="n">NMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

        <span class="c"># Need NMT + 1 since elastic scattering is included</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[:</span><span class="n">NMT</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS8</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_read_and</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the angular distribution for each reaction MT</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS9</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        <span class="n">NMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

        <span class="c"># Angular distribution for all MT with secondary neutrons</span>
        <span class="c"># including elastic scattering</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[:</span><span class="n">NMT</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>

            <span class="c"># Check if angular distribution data exist </span>
            <span class="k">if</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c"># Angular distribution data are specified through LAWi</span>
                <span class="c"># = 44 in the DLW block</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># No angular distribution data are given for this</span>
                <span class="c"># reaction, isotropic scattering is asssumed (in CM if</span>
                <span class="c"># TY &lt; 0 and in LAB if TY &gt; 0)</span>
                <span class="k">continue</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">JXS9</span> <span class="o">+</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">ang_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
            <span class="n">LC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">ang_location</span> <span class="o">=</span> <span class="n">LC</span>

            <span class="n">rxn</span><span class="o">.</span><span class="n">ang_cos</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">ang_pdf</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">ang_cdf</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">location</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">LC</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c"># Isotropic angular distribution</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">location</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c"># Equiprobable 32 bin distribution</span>
                    <span class="c"># print([rxn,&#39;equiprobable&#39;])</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">ang_cos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">location</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c"># Tabular angular distribution</span>
                    <span class="n">JJ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">NP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">ang_cos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">ang_pdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">ang_cdf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_read_ldlw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find locations for energy distribution data for each reaction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>

        <span class="c"># Number of reactions is less than total since we only need</span>
        <span class="c"># energy distribution for reactions with secondary</span>
        <span class="c"># neutrons. Thus, MT &gt; 100 are not included. Elastic</span>
        <span class="c"># scattering is also not included.</span>
        <span class="n">NMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">NMT</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">LOCC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">LED</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_read_dlw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine the energy distribution for secondary neutrons for</span>
<span class="sd">        each reaction MT</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LDIS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">NMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">LOCC</span> <span class="o">=</span> <span class="p">[</span><span class="n">rxn</span><span class="o">.</span><span class="n">LOCC</span> <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">NMT</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>

        <span class="k">for</span> <span class="n">irxn</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">NMT</span><span class="o">+</span><span class="mi">1</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">LDIS</span> <span class="o">+</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCC</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">LNW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="n">LAW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="c"># print([rxn,LAW])</span>
            <span class="n">IDAT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">interp_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                <span class="n">interp_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

            <span class="c"># Determine tabular energy points and probability of law</span>
            <span class="c"># validity</span>
            <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pvalid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

            <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_law</span> <span class="o">=</span> <span class="n">LAW</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">LDIS</span> <span class="o">+</span> <span class="n">IDAT</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="c"># Tabular equiprobable energy bins (ENDF Law 1)</span>
            <span class="k">if</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of outgoing energies in each E_out table</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="c"># Read E_out tables</span>
                <span class="n">NET</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e_dist_energy_out1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NET</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e_dist_energy_out2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NET</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e_dist_energy_outNE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NET</span><span class="p">)</span>

            <span class="c"># Discrete photon energy</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e_dist_LP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e_dist_EG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">()</span>

            <span class="c"># Level scattering (ENDF Law 3)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

            <span class="c"># Continuous tabular distribution (ENDF Law 1)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of outgoing energies in each E_out table</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_intt</span> <span class="o">=</span> <span class="p">[]</span>        <span class="c"># Interpolation scheme (1=hist, 2=lin-lin)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_out</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># Outgoing E grid for each incoming E</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pdf</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Probability dist for &quot; &quot; &quot;</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_cdf</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Cumulative dist for &quot; &quot; &quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE</span><span class="p">):</span>
                    <span class="n">INTTp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">INTTp</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="n">INTT</span> <span class="o">=</span> <span class="n">INTTp</span> <span class="o">%</span> <span class="mi">10</span>
                        <span class="n">ND</span> <span class="o">=</span> <span class="p">(</span><span class="n">INTTp</span> <span class="o">-</span> <span class="n">INTT</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">INTT</span> <span class="o">=</span> <span class="n">INTTp</span>
                        <span class="n">ND</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_intt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INTT</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ND</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">print</span> <span class="p">[</span><span class="n">rxn</span><span class="p">,</span> <span class="n">ND</span><span class="p">,</span> <span class="n">INTT</span><span class="p">]</span>
                    

                    <span class="n">NP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_cdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                 
            <span class="c"># General evaporation spectrum (ENDF-5 File 5 LF=5)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">NET</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NET</span><span class="p">)</span>

            <span class="c"># Simple Maxwell fission spectrum (ENDF-6 File 5 LF=7) </span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">()</span>
                
            <span class="c"># Evaporation spectrum (ENDF-6 File 5 LF=9)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">()</span>

            <span class="c"># Energy dependent Watt spectrum (ENDF-6 File 5 LF=11)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
                <span class="c"># Interpolation scheme between a&#39;s    </span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBTa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INTa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Incident energy table and tabulated a&#39;s</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energya_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="c"># Interpolation scheme between b&#39;s</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBTb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INTb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Incident energy table and tabulated b&#39;s</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energyb_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">()</span>

            <span class="c"># Tabular linear functions (UK Law 2)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">22</span><span class="p">:</span>
                <span class="c"># Interpolation scheme (not used in MCNP)</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of incident energies</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">LOCE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="c"># Read linear functions</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_P</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_C</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE</span><span class="p">):</span>
                    <span class="n">NF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NF</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NF</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NF</span><span class="p">))</span>

            <span class="c"># From UK Law 6</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">24</span><span class="p">:</span>
                <span class="c"># Interpolation scheme (not used in MCNP)</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of incident energies</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                
                <span class="c"># Outgoing energy tables</span>
                <span class="n">NET</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE</span><span class="p">):</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NET</span><span class="p">))</span>

            <span class="c"># Kalbach-87 Formalism (ENDF File 6 Law 1, LANG=2)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">44</span><span class="p">:</span>
                <span class="c"># Interpolation scheme</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of outgoing energies in each E_out table</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_intt</span> <span class="o">=</span> <span class="p">[]</span>        <span class="c"># Interpolation scheme (1=hist, 2=lin-lin)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_out</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># Outgoing E grid for each incoming E</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pdf</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Probability dist for &quot; &quot; &quot;</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_cdf</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Cumulative dist for &quot; &quot; &quot;</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_frac</span> <span class="o">=</span> <span class="p">[]</span>        <span class="c"># Precompound fraction for &quot; &quot; &quot;</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_ang</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Angular distribution slope for &quot; &quot; &quot;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE</span><span class="p">):</span>
                    <span class="n">INTTp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">INTTp</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="n">INTT</span> <span class="o">=</span> <span class="n">INTTp</span> <span class="o">%</span> <span class="mi">10</span>
                        <span class="n">ND</span> <span class="o">=</span> <span class="p">(</span><span class="n">INTTp</span> <span class="o">-</span> <span class="n">INTT</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">INTT</span> <span class="o">=</span> <span class="n">INTTp</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_intt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INTT</span><span class="p">)</span>

                    <span class="n">NP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_cdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_frac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_ang</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>

            <span class="c"># Like 44, but tabular distribution instead of Kalbach-87</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">61</span><span class="p">:</span>
                <span class="c"># Interpolation scheme</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of outgoing energies in each E_out table</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_intt</span> <span class="o">=</span> <span class="p">[]</span>        <span class="c"># Interpolation scheme (1=hist, 2=lin-lin)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_out</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># Outgoing E grid for each incoming E</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pdf</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Probability dist for &quot; &quot; &quot;</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_cdf</span> <span class="o">=</span> <span class="p">[]</span>         <span class="c"># Cumulative dist for &quot; &quot; &quot;</span>

                <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_intt</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_mu_out</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># Cosine scattering angular grid</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_pdf</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c"># Probability dist function</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_cdf</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE</span><span class="p">):</span>
                    <span class="n">INTTp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">INTTp</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="n">INTT</span> <span class="o">=</span> <span class="n">INTTp</span> <span class="o">%</span> <span class="mi">10</span>
                        <span class="n">ND</span> <span class="o">=</span> <span class="p">(</span><span class="n">INTTp</span> <span class="o">-</span> <span class="n">INTT</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">INTT</span> <span class="o">=</span> <span class="n">INTTp</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_intt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INTT</span><span class="p">)</span>

                    <span class="c"># Secondary energy distribution</span>
                    <span class="n">NP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_pdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_cdf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>

                    <span class="c"># Secondary angular distribution</span>
                    <span class="n">LC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NP</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_intt</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_mu_out</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_pdf</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_cdf</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NP</span><span class="p">):</span>
                        <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_intt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">())</span>
                        <span class="n">NP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                        <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_mu_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                        <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_pdf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>
                        <span class="n">rxn</span><span class="o">.</span><span class="n">a_dist_cdf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NP</span><span class="p">))</span>

            <span class="c"># N-body phase space distribution (ENDF File 6 Law 6)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">66</span><span class="p">:</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_nbodies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_massratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">()</span>

            <span class="c"># Laboratory angle-energy law (ENDF File 6 Law 7)</span>
            <span class="k">elif</span> <span class="n">LAW</span> <span class="o">==</span> <span class="mi">67</span><span class="p">:</span>
                <span class="c"># Interpolation scheme</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">NR</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                    <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Number of outgoing energies in each E_out table</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">irxn</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">LOCC</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">LDIS</span> <span class="o">+</span> <span class="n">LOCC</span><span class="p">[</span><span class="n">irxn</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">LNW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="n">LAW</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                    <span class="c"># print([rxn,rxn.e_dist_law,LAW])</span>
                    
            <span class="c"># TODO: Read rest of data</span>

    <span class="k">def</span> <span class="nf">_read_gpd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read total photon production cross section and secondary photon</span>
<span class="sd">        energies based on older 30x20 matrix formulation.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">JXS12</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Determine number of energies</span>
            <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

            <span class="c"># Read total photon production cross section</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">JXS12</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigma_photon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

            <span class="c"># The following energies are the discrete incident neutron energies</span>
            <span class="c"># for which the equiprobable secondary photon outgoing energies are</span>
            <span class="c"># given</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_in_photon_equi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.39e-10</span><span class="p">,</span> <span class="mf">1.52e-7</span><span class="p">,</span> <span class="mf">4.14e-7</span><span class="p">,</span> <span class="mf">1.13e-6</span><span class="p">,</span> <span class="mf">3.06e-6</span><span class="p">,</span>
                                     <span class="mf">8.32e-6</span><span class="p">,</span>  <span class="mf">2.26e-5</span><span class="p">,</span> <span class="mf">6.14e-5</span><span class="p">,</span> <span class="mf">1.67e-4</span><span class="p">,</span> <span class="mf">4.54e-4</span><span class="p">,</span>
                                     <span class="mf">1.235e-3</span><span class="p">,</span> <span class="mf">3.35e-3</span><span class="p">,</span> <span class="mf">9.23e-3</span><span class="p">,</span> <span class="mf">2.48e-2</span><span class="p">,</span> <span class="mf">6.76e-2</span><span class="p">,</span>
                                     <span class="mf">0.184</span><span class="p">,</span>    <span class="mf">0.303</span><span class="p">,</span>   <span class="mf">0.500</span><span class="p">,</span>   <span class="mf">0.823</span><span class="p">,</span>   <span class="mf">1.353</span><span class="p">,</span>
                                     <span class="mf">1.738</span><span class="p">,</span>    <span class="mf">2.232</span><span class="p">,</span>   <span class="mf">2.865</span><span class="p">,</span>   <span class="mf">3.68</span><span class="p">,</span>    <span class="mf">6.07</span><span class="p">,</span>
                                     <span class="mf">7.79</span><span class="p">,</span>     <span class="mf">10.</span><span class="p">,</span>     <span class="mf">12.</span><span class="p">,</span>     <span class="mf">13.5</span><span class="p">,</span>    <span class="mf">15.</span><span class="p">]</span>

            <span class="c"># Read equiprobable outgoing photon energies</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e_out_photon_equi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
                <span class="c"># Equiprobable outgoing photon energies for incident neutron</span>
                <span class="c"># energy i</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e_out_photon_equi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_read_mtrp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the list of reaction MTs for photon-producing reactions for this</span>
<span class="sd">        cross-section table. The MT values are somewhat arbitrary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span>
        <span class="n">NMT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NMT</span><span class="p">):</span>
            <span class="n">MT</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">LMT</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">photonReactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Reaction</span><span class="p">(</span><span class="n">MT</span><span class="p">,</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_read_lsigp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine location of cross sections for each photon-producing reaction</span>
<span class="sd">        MT.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">LXS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">photonReactions</span><span class="p">):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">LXS</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_read_sigp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read cross-sections for each photon-producing reaction MT.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS15</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">photonReactions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">JXS15</span> <span class="o">+</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCA</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">MFTYPE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>

            <span class="c"># Yield data taken from ENDF File 12 or 6</span>
            <span class="k">if</span> <span class="n">MFTYPE</span> <span class="o">==</span> <span class="mi">12</span> <span class="ow">or</span> <span class="n">MFTYPE</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
                <span class="n">MTMULT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>

                <span class="c"># ENDF interpolation parameters</span>
                <span class="n">NR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">NBT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>
                <span class="n">INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NR</span><span class="p">)</span>

                <span class="c"># Energy-dependent yield</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">e_yield</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">photon_yield</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

            <span class="c"># Cross-section data from ENDF File 13</span>
            <span class="k">elif</span> <span class="n">MFTYPE</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
                <span class="c"># Energy grid index at which data starts</span>
                <span class="n">rxn</span><span class="o">.</span><span class="n">IE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>

                <span class="c"># Cross sections</span>
                <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">_read_landp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine location of angular distribution for each photon-producing</span>
<span class="sd">        reaction MT.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">JXS16</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">photonReactions</span><span class="p">):</span>
            <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">JXS16</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_read_andp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the angular distribution for each photon-producing reaction</span>
<span class="sd">        MT.&quot;&quot;&quot;</span>

        <span class="n">JXS17</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">photonReactions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># No angular distribution data are given for this reaction,</span>
                <span class="c"># isotropic scattering is asssumed in LAB</span>
                <span class="k">continue</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">JXS17</span> <span class="o">+</span> <span class="n">rxn</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="c"># Number of energies and incoming energy grid</span>
            <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_dist_energy_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

            <span class="c"># Location of tables associated with each outgoing angle</span>
            <span class="c"># distribution</span>
            <span class="n">LC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

            <span class="c"># 32 equiprobable cosine bins for each incoming energy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_dist_mu_out</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">location</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">LC</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">JXS17</span> <span class="o">+</span> <span class="n">location</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a_dist_mu_out</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_yp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read list of reactions required as photon production yield</span>
<span class="sd">        multipliers.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
            <span class="n">NYP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MT_for_photon_yield</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">(</span><span class="n">NYP</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_fis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read total fission cross-section data if present. Generally,</span>
<span class="sd">        this table is not provided since it is redundant.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Check if fission block is present</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c"># Read fission cross sections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IE_fission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>  <span class="c"># Energy grid index</span>
        <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_unr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the unresolved resonance range probability tables if present</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Check if URR probability tables are present</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>   <span class="c"># Number of incident energies</span>
        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>   <span class="c"># Length of probability table</span>
        <span class="n">INT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span> <span class="c"># Interpolation parameter (2=lin-lin, 5=log-log)</span>
        <span class="n">ILF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span> <span class="c"># Inelastic competition flag</span>
        <span class="n">IOA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span> <span class="c"># Other absorption flag</span>
        <span class="n">IFF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span> <span class="c"># Factors flag</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">urr_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="c"># Incident energies</span>

        <span class="c"># Set up URR probability table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">urr_table</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">urr_table</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">urr_table</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="bp">None</span> <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)])</span>
        
        <span class="c"># Read values for URR probability tables</span>
        <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">urr_table</span><span class="p">[</span><span class="n">I</span><span class="p">][</span><span class="n">J</span><span class="p">][</span><span class="n">K</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_get_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n_values</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span><span class="o">+</span><span class="n">n_values</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="n">n_values</span>
            <span class="k">return</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">value</span>
            
    <span class="k">def</span> <span class="nf">_get_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n_values</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="n">ind</span><span class="p">:</span><span class="n">ind</span><span class="o">+</span><span class="n">n_values</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="n">n_values</span>
            <span class="k">return</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">find_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MT</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">MT</span> <span class="o">==</span> <span class="n">MT</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">r</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">r</span>


<span class="k">class</span> <span class="nc">SabTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SabTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_itie</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_itce</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_itxe</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_itca</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Thermal S(a,b) Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Thermal S(a,b) Table&gt;&quot;</span>

    <span class="k">def</span> <span class="nf">plot_inelastic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">E_out</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e6</span> <span class="o">*</span> <span class="n">E</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_e_out</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
        <span class="n">mu_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_mu_out</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">E_out</span>
        <span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_z_function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">E_out</span><span class="p">,</span><span class="n">mu_out</span><span class="p">)</span>
        <span class="n">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>

        <span class="c"># Plot options</span>
        <span class="n">colorbar</span><span class="p">()</span>
        <span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
        <span class="n">ylim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">E_out</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">E_out</span><span class="p">)])</span>
        <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Equally likely cosine bin&#39;</span><span class="p">)</span>
        <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Outgoing Energy (eV)&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_z_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">E_out</span><span class="p">,</span> <span class="n">mu_out</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">y_</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">mu_out</span><span class="p">[</span><span class="n">E_out</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span><span class="n">y_</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">z</span>

    <span class="k">def</span> <span class="nf">_read_itie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read energy-dependent inelastic scattering cross sections</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_e_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_itce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read energy-dependent elastic scattering cross sections</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Determine if ITCE block exists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c"># Read values</span>
        <span class="n">NE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elastic_e_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elastic_P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NE</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elastic_type</span> <span class="o">=</span> <span class="s">&#39;sigma=P&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elastic_type</span> <span class="o">=</span> <span class="s">&#39;sigma=P/E&#39;</span>

    <span class="k">def</span> <span class="nf">_read_itxe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read coupled energy/angle distributions for inelastic scattering</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c"># Determine number of energies and angles</span>
        <span class="n">NE_in</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inelastic_e_in</span><span class="p">)</span>
        <span class="n">NE_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">NMU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="c"># Set index for reading values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_e_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_mu_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># Loop over incoming energies </span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE_in</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_e_out</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_mu_out</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

            <span class="c"># Loop over outgoing energies </span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE_out</span><span class="p">):</span>
                <span class="c"># Read outgoing energy</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_e_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">())</span>

                <span class="c"># Read discrete cosines for scattering from E_in to E_out</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inelastic_mu_out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NMU</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_read_itca</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read angular distributions for elastic scattering.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">NMU</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NXS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">NMU</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JXS</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>

        <span class="n">NE</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elastic_e_in</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elastic_mu_out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NE</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elastic_mu_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_float</span><span class="p">(</span><span class="n">NMU</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n_values</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="n">n_values</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="n">n_values</span>
            <span class="k">return</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">value</span>
            
    <span class="k">def</span> <span class="nf">_get_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n_values</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> 
                      <span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="n">n_values</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="n">n_values</span>
            <span class="k">return</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">XSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">value</span>

            
<span class="k">class</span> <span class="nc">Reaction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MT</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span> <span class="c"># Reference to containing table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MT</span> <span class="o">=</span> <span class="n">MT</span>       <span class="c"># MT value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="bp">None</span>      <span class="c"># Q-value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TY</span> <span class="o">=</span> <span class="bp">None</span>     <span class="c"># Neutron release</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LOCA</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LOCB</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LOCC</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IE</span> <span class="o">=</span> <span class="bp">None</span>     <span class="c"># Energy grid index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c"># Cross section values</span>

    <span class="k">def</span> <span class="nf">broaden</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T_high</span><span class="p">):</span>
        <span class="k">pass</span>        

    <span class="k">def</span> <span class="nf">threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return energy threshold for this reaction&quot;&quot;&quot;</span>

        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span>
        <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">energy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">IE</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Reaction: MT={0} {1}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MT</span><span class="p">,</span> <span class="n">reaction_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">MT</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Reaction: Unknown MT={0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MT</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">DosimetryTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DosimetryTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Dosimetry Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Dosimetry Table&gt;&quot;</span>
        

<span class="k">class</span> <span class="nc">NeutronDiscreteTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NeutronDiscreteTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Discrete-E Neutron Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Discrete-E Neutron Table&gt;&quot;</span>
        

<span class="k">class</span> <span class="nc">NeutronMGTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NeutronMGTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Multigroup Neutron Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Multigroup Neutron Table&gt;&quot;</span>
        

<span class="k">class</span> <span class="nc">PhotoatomicTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PhotoatomicTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Continuous-E Photoatomic Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Continuous-E Photoatomic Table&gt;&quot;</span>
        

<span class="k">class</span> <span class="nc">PhotoatomicMGTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PhotoatomicMGTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Multigroup Photoatomic Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Multigroup Photoatomic Table&gt;&quot;</span>
        

<span class="k">class</span> <span class="nc">ElectronTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ElectronTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Electron Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Electron Table&gt;&quot;</span>
        

<span class="k">class</span> <span class="nc">PhotonuclearTable</span><span class="p">(</span><span class="n">AceTable</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PhotonuclearTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">awr</span><span class="p">,</span> <span class="n">temp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Photonuclear Table: {0}&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;&lt;ACE Photonuclear Table&gt;&quot;</span>

<span class="n">table_types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;c&quot;</span><span class="p">:</span> <span class="n">NeutronTable</span><span class="p">,</span>
    <span class="s">&quot;t&quot;</span><span class="p">:</span> <span class="n">SabTable</span><span class="p">,</span>
    <span class="s">&quot;y&quot;</span><span class="p">:</span> <span class="n">DosimetryTable</span><span class="p">,</span>
    <span class="s">&quot;d&quot;</span><span class="p">:</span> <span class="n">NeutronDiscreteTable</span><span class="p">,</span>
    <span class="s">&quot;p&quot;</span><span class="p">:</span> <span class="n">PhotoatomicTable</span><span class="p">,</span>
    <span class="s">&quot;m&quot;</span><span class="p">:</span> <span class="n">NeutronMGTable</span><span class="p">,</span>
    <span class="s">&quot;g&quot;</span><span class="p">:</span> <span class="n">PhotoatomicMGTable</span><span class="p">,</span>
    <span class="s">&quot;e&quot;</span><span class="p">:</span> <span class="n">ElectronTable</span><span class="p">,</span>
    <span class="s">&quot;u&quot;</span><span class="p">:</span> <span class="n">PhotonuclearTable</span><span class="p">}</span>

<span class="n">reaction_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c"># TODO: This should be provided as part of the ENDF module functionality</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s">&#39;(n,total)&#39;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s">&#39;(n,elastic)&#39;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s">&#39;(n,nonelastic)&#39;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s">&#39;(n,inelastic)&#39;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span> <span class="s">&#39;(misc)&#39;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span> <span class="s">&#39;(n,continuum)&#39;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span> <span class="s">&#39;(n,2n d)&#39;</span><span class="p">,</span>
    <span class="mi">16</span><span class="p">:</span> <span class="s">&#39;(n,2n)&#39;</span><span class="p">,</span>
    <span class="mi">17</span><span class="p">:</span> <span class="s">&#39;(n,3n)&#39;</span><span class="p">,</span>
    <span class="mi">18</span><span class="p">:</span> <span class="s">&#39;(n,fission)&#39;</span><span class="p">,</span>
    <span class="mi">19</span><span class="p">:</span> <span class="s">&#39;(n,f)&#39;</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">:</span> <span class="s">&#39;(n,nf)&#39;</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">:</span> <span class="s">&#39;(n,2nf)&#39;</span><span class="p">,</span>
    <span class="mi">22</span><span class="p">:</span> <span class="s">&#39;(n,na)&#39;</span><span class="p">,</span>
    <span class="mi">23</span><span class="p">:</span> <span class="s">&#39;(n,n3a)&#39;</span><span class="p">,</span>
    <span class="mi">24</span><span class="p">:</span> <span class="s">&#39;(n,2na)&#39;</span><span class="p">,</span>
    <span class="mi">25</span><span class="p">:</span> <span class="s">&#39;(n,3na)&#39;</span><span class="p">,</span>
    <span class="mi">28</span><span class="p">:</span> <span class="s">&#39;(n,np)&#39;</span><span class="p">,</span>
    <span class="mi">29</span><span class="p">:</span> <span class="s">&#39;(n,n2a)&#39;</span><span class="p">,</span>
    <span class="mi">30</span><span class="p">:</span> <span class="s">&#39;(n,2n2a)&#39;</span><span class="p">,</span>
    <span class="mi">32</span><span class="p">:</span> <span class="s">&#39;(n,nd)&#39;</span><span class="p">,</span>
    <span class="mi">33</span><span class="p">:</span> <span class="s">&#39;(n,nt)&#39;</span><span class="p">,</span>
    <span class="mi">34</span><span class="p">:</span> <span class="s">&#39;(n,n He-3)&#39;</span><span class="p">,</span>
    <span class="mi">35</span><span class="p">:</span> <span class="s">&#39;(n,nd3a)&#39;</span><span class="p">,</span>
    <span class="mi">36</span><span class="p">:</span> <span class="s">&#39;(n,nt2a)&#39;</span><span class="p">,</span>
    <span class="mi">37</span><span class="p">:</span> <span class="s">&#39;(n,4n)&#39;</span><span class="p">,</span>
    <span class="mi">38</span><span class="p">:</span> <span class="s">&#39;(n,3nf)&#39;</span><span class="p">,</span>
    <span class="mi">41</span><span class="p">:</span> <span class="s">&#39;(n,2np)&#39;</span><span class="p">,</span>
    <span class="mi">42</span><span class="p">:</span> <span class="s">&#39;(n,3np)&#39;</span><span class="p">,</span>
    <span class="mi">44</span><span class="p">:</span> <span class="s">&#39;(n,2np)&#39;</span><span class="p">,</span>
    <span class="mi">45</span><span class="p">:</span> <span class="s">&#39;(n,npa)&#39;</span><span class="p">,</span>
    <span class="mi">91</span><span class="p">:</span> <span class="s">&#39;(n,nc)&#39;</span><span class="p">,</span>
    <span class="mi">102</span><span class="p">:</span> <span class="s">&#39;(n,gamma)&#39;</span><span class="p">,</span>
    <span class="mi">103</span><span class="p">:</span> <span class="s">&#39;(n,p)&#39;</span><span class="p">,</span>
    <span class="mi">104</span><span class="p">:</span> <span class="s">&#39;(n,d)&#39;</span><span class="p">,</span>
    <span class="mi">105</span><span class="p">:</span> <span class="s">&#39;(n,t)&#39;</span><span class="p">,</span>
    <span class="mi">106</span><span class="p">:</span> <span class="s">&#39;(n,3He)&#39;</span><span class="p">,</span>
    <span class="mi">107</span><span class="p">:</span> <span class="s">&#39;(n,a)&#39;</span><span class="p">,</span>
    <span class="mi">108</span><span class="p">:</span> <span class="s">&#39;(n,2a)&#39;</span><span class="p">,</span>
    <span class="mi">109</span><span class="p">:</span> <span class="s">&#39;(n,3a)&#39;</span><span class="p">,</span>
    <span class="mi">111</span><span class="p">:</span> <span class="s">&#39;(n,2p)&#39;</span><span class="p">,</span>
    <span class="mi">112</span><span class="p">:</span> <span class="s">&#39;(n,pa)&#39;</span><span class="p">,</span>
    <span class="mi">113</span><span class="p">:</span> <span class="s">&#39;(n,t2a)&#39;</span><span class="p">,</span>
    <span class="mi">114</span><span class="p">:</span> <span class="s">&#39;(n,d2a)&#39;</span><span class="p">,</span>
    <span class="mi">115</span><span class="p">:</span> <span class="s">&#39;(n,pd)&#39;</span><span class="p">,</span>
    <span class="mi">116</span><span class="p">:</span> <span class="s">&#39;(n,pt)&#39;</span><span class="p">,</span>
    <span class="mi">117</span><span class="p">:</span> <span class="s">&#39;(n,da)&#39;</span><span class="p">,</span>
    <span class="mi">201</span><span class="p">:</span> <span class="s">&#39;(n,Xn)&#39;</span><span class="p">,</span>
    <span class="mi">202</span><span class="p">:</span> <span class="s">&#39;(n,Xgamma)&#39;</span><span class="p">,</span>
    <span class="mi">203</span><span class="p">:</span> <span class="s">&#39;(n,Xp)&#39;</span><span class="p">,</span>
    <span class="mi">204</span><span class="p">:</span> <span class="s">&#39;(n,Xd)&#39;</span><span class="p">,</span>
    <span class="mi">205</span><span class="p">:</span> <span class="s">&#39;(n,Xt)&#39;</span><span class="p">,</span>
    <span class="mi">206</span><span class="p">:</span> <span class="s">&#39;(n,X3He)&#39;</span><span class="p">,</span>
    <span class="mi">207</span><span class="p">:</span> <span class="s">&#39;(n,Xa)&#39;</span><span class="p">,</span>
    <span class="mi">444</span><span class="p">:</span> <span class="s">&#39;(damage)&#39;</span><span class="p">,</span>
    <span class="mi">649</span><span class="p">:</span> <span class="s">&#39;(n,pc)&#39;</span><span class="p">,</span>
    <span class="mi">699</span><span class="p">:</span> <span class="s">&#39;(n,dc)&#39;</span><span class="p">,</span>
    <span class="mi">749</span><span class="p">:</span> <span class="s">&#39;(n,tc)&#39;</span><span class="p">,</span>
    <span class="mi">799</span><span class="p">:</span> <span class="s">&#39;(n,3Hec)&#39;</span><span class="p">,</span>
    <span class="mi">849</span><span class="p">:</span> <span class="s">&#39;(n,ac)&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="sd">&quot;&quot;&quot;Dictionary of MT reaction labels&quot;&quot;&quot;</span>
<span class="n">reaction_names</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">mt</span><span class="p">:</span> <span class="s">&#39;(n,n{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mt</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">91</span><span class="p">)})</span>
<span class="n">reaction_names</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">mt</span><span class="p">:</span> <span class="s">&#39;(n,p{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mt</span> <span class="o">-</span> <span class="mi">600</span><span class="p">)</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">649</span><span class="p">)})</span>
<span class="n">reaction_names</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">mt</span><span class="p">:</span> <span class="s">&#39;(n,d{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mt</span> <span class="o">-</span> <span class="mi">650</span><span class="p">)</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">650</span><span class="p">,</span> <span class="mi">699</span><span class="p">)})</span>
<span class="n">reaction_names</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">mt</span><span class="p">:</span> <span class="s">&#39;(n,t{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mt</span> <span class="o">-</span> <span class="mi">700</span><span class="p">)</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">649</span><span class="p">)})</span>
<span class="n">reaction_names</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">mt</span><span class="p">:</span> <span class="s">&#39;(n,3He{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mt</span> <span class="o">-</span> <span class="mi">750</span><span class="p">)</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">750</span><span class="p">,</span> <span class="mi">799</span><span class="p">)})</span>
<span class="n">reaction_names</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">mt</span><span class="p">:</span> <span class="s">&#39;(n,a{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mt</span> <span class="o">-</span> <span class="mi">800</span><span class="p">)</span> <span class="k">for</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="mi">649</span><span class="p">)})</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c"># Might be nice to check environment variable DATAPATH to search for xsdir</span>
    <span class="c"># and list files that could be read?</span>
    <span class="k">pass</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../index.html">
          <img class="logo" src="../../_static/pyne_icon_small.png" alt="Logo"/>
        </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../np-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
    <li><a href="../../index.html">PyNE</a> &raquo;</li>

          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2011-2012, The PyNE Development Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
    <!-- cloud_sptheme 1.3 -->
  </body>
</html>